import{aZ as xe,a$ as F,aY as ln,b0 as Gn,b1 as Pi,b2 as Ri,b3 as Yn,b4 as Ci,b5 as Vr,d as st,b6 as pt,ae as kt,af as Nt,s as Ke,o as Ie,P as Oe,r as Gr,e as Q,aV as bt,b7 as Yr,b8 as Dn,b9 as dt,ba as Ue,bb as tt,p as je,bc as Xr,aw as Xn,a9 as Kn,Q as en,m as Oi,bd as Zn,be as Wt,bf as ve,bg as Li,bh as it,bi as Di,bj as Kr,K as Zr,c as ki,aA as Mt,bk as Ge,ax as Ni,aN as ji,k as mt,Z as Vt,bl as Ui,bm as Fi,bn as Ot,bo as Qn,bp as Lt,bq as Bi,aJ as rt,br as Qr,bs as De,bt as Je,bu as fn,bv as K,bw as ie,bx as at,by as Gt,bz as zi,bA as Hi,bB as gt,bC as me,bD as Ye,bE as ut,bF as or,bG as ar,bH as mn,aU as Vi,bI as Gi,bJ as lr,bK as qn,a2 as Yi,bL as Xi,bM as Ki,aE as Zi,bN as Qi,bO as $t,bP as gn,bQ as tn,bR as qi,aX as Xe,bS as qr,bT as kn,bU as Wi,aR as $i,aS as Ji,bV as es,bW as ts,bX as Wr,bY as $r,bZ as Jr,b_ as Wn,b$ as ei,c0 as $n,c1 as ti,c2 as nn,c3 as ni,c4 as ri,c5 as Ct,c6 as rn,c7 as Ze,c8 as ns,c9 as rs,ca as is,aD as Dt,cb as Fe,cc as ss,cd as os,aW as as,ce as ls,cf as cs,cg as us,ch as hs,ci as ds,a_ as ps,cj as yn,ck as fs,cl as ms,cm as gs,cn as cr,co as ys,cp as Nn,cq as ii,cr as vs,cs as ur,ct as hr,cu as dr,cv as ws}from"./index-D_ytHs-s.js";var bs=Object.defineProperty,xs=(o,e,t)=>e in o?bs(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,ye=(o,e,t)=>xs(o,typeof e!="symbol"?e+"":e,t);const Jn=parseInt(Fi.replace(/\D+/g,""));var Ms=Object.defineProperty,Es=(o,e,t)=>e in o?Ms(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,_s=(o,e,t)=>(Es(o,e+"",t),t);async function pr(o){const e=await o.arrayBuffer(),t=btoa(String.fromCharCode(...new Uint8Array(e)));return`data:${o.type||""};base64,${t}`}let Yt,vn,yt,Xt;function wn(o,e=1/0,t=null){vn||(vn=new Ge(2,2,1,1)),yt||(yt=new ln({uniforms:{blitTexture:new es(o)},vertexShader:`
        varying vec2 vUv;
        void main(){
            vUv = uv;
            gl_Position = vec4(position.xy * 1.0,0.,.999999);
        }
      `,fragmentShader:`
          uniform sampler2D blitTexture; 
          varying vec2 vUv;

          void main(){ 
              gl_FragColor = vec4(vUv.xy, 0, 1);
              
              #ifdef IS_SRGB
              gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );
              #else
              gl_FragColor = texture2D( blitTexture, vUv);
              #endif
          }
      `})),yt.uniforms.blitTexture.value=o,yt.defines.IS_SRGB="colorSpace"in o?o.colorSpace==="srgb":o.encoding===3001,yt.needsUpdate=!0,Xt||(Xt=new K(vn,yt),Xt.frustrumCulled=!1);const n=new Ye,r=new kn;r.add(Xt),t||(t=Yt=new ts({antialias:!1})),t.setSize(Math.min(o.image.width,e),Math.min(o.image.height,e)),t.clear(),t.render(r,n);const i=new tn(t.domElement);return i.minFilter=o.minFilter,i.magFilter=o.magFilter,i.wrapS=o.wrapS,i.wrapT=o.wrapT,i.name=o.name,Yt&&(Yt.dispose(),Yt=null),i}const fr={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class si{constructor(){this.pluginCallbacks=[],this.register(function(e){return new Ds(e)}),this.register(function(e){return new ks(e)}),this.register(function(e){return new Us(e)}),this.register(function(e){return new Fs(e)}),this.register(function(e){return new Bs(e)}),this.register(function(e){return new zs(e)}),this.register(function(e){return new Ns(e)}),this.register(function(e){return new js(e)}),this.register(function(e){return new Hs(e)}),this.register(function(e){return new Vs(e)}),this.register(function(e){return new Gs(e)})}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){const i=new Ls,s=[];for(let a=0,l=this.pluginCallbacks.length;a<l;a++)s.push(this.pluginCallbacks[a](i));i.setPlugins(s),i.write(e,t,r).catch(n)}parseAsync(e,t){const n=this;return new Promise(function(r,i){n.parse(e,r,i,t)})}}_s(si,"Utils",{insertKeyframe:function(o,e){const t=o.getValueSize(),n=new o.TimeBufferType(o.times.length+1),r=new o.ValueBufferType(o.values.length+t),i=o.createInterpolant(new o.ValueBufferType(t));let s;if(o.times.length===0){n[0]=e;for(let a=0;a<t;a++)r[a]=0;s=0}else if(e<o.times[0]){if(Math.abs(o.times[0]-e)<.001)return 0;n[0]=e,n.set(o.times,1),r.set(i.evaluate(e),0),r.set(o.values,t),s=0}else if(e>o.times[o.times.length-1]){if(Math.abs(o.times[o.times.length-1]-e)<.001)return o.times.length-1;n[n.length-1]=e,n.set(o.times,0),r.set(o.values,0),r.set(i.evaluate(e),o.values.length),s=n.length-1}else for(let a=0;a<o.times.length;a++){if(Math.abs(o.times[a]-e)<.001)return a;if(o.times[a]<e&&o.times[a+1]>e){n.set(o.times.slice(0,a+1),0),n[a+1]=e,n.set(o.times.slice(a+1),a+2),r.set(o.values.slice(0,(a+1)*t),0),r.set(i.evaluate(e),(a+1)*t),r.set(o.values.slice((a+1)*t),(a+2)*t),s=a+1;break}}return o.times=n,o.values=r,s},mergeMorphTargetTracks:function(o,e){const t=[],n={},r=o.tracks;for(let i=0;i<r.length;++i){let s=r[i];const a=Ot.parseTrackName(s.name),l=Ot.findNode(e,a.nodeName);if(a.propertyName!=="morphTargetInfluences"||a.propertyIndex===void 0){t.push(s);continue}if(s.createInterpolant!==s.InterpolantFactoryMethodDiscrete&&s.createInterpolant!==s.InterpolantFactoryMethodLinear){if(s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),s=s.clone(),s.setInterpolation(Qn)}const c=l.morphTargetInfluences.length,u=l.morphTargetDictionary[a.propertyIndex];if(u===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+a.propertyIndex);let h;if(n[l.uuid]===void 0){h=s.clone();const w=new h.ValueBufferType(c*h.times.length);for(let y=0;y<h.times.length;y++)w[y*c+u]=h.values[y];h.name=(a.nodeName||"")+".morphTargetInfluences",h.values=w,n[l.uuid]=h,t.push(h);continue}const v=s.createInterpolant(new s.ValueBufferType(1));h=n[l.uuid];for(let w=0;w<h.times.length;w++)h.values[w*c+u]=v.evaluate(h.times[w]);for(let w=0;w<s.times.length;w++){const y=this.insertKeyframe(h,s.times[w]);h.values[y*c+u]=s.values[w]}}return o.tracks=t,o}});const re={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},bn="KHR_mesh_quantization",Pe={};Pe[Wr]=re.NEAREST;Pe[$r]=re.NEAREST_MIPMAP_NEAREST;Pe[Jr]=re.NEAREST_MIPMAP_LINEAR;Pe[Wn]=re.LINEAR;Pe[ei]=re.LINEAR_MIPMAP_NEAREST;Pe[$n]=re.LINEAR_MIPMAP_LINEAR;Pe[ti]=re.CLAMP_TO_EDGE;Pe[nn]=re.REPEAT;Pe[ni]=re.MIRRORED_REPEAT;const mr={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Ts=new xe,gr=12,As=1179937895,Ss=2,yr=8,Is=1313821514,Ps=5130562;function Rt(o,e){return o.length===e.length&&o.every(function(t,n){return t===e[n]})}function Rs(o){return new TextEncoder().encode(o).buffer}function Cs(o){return Rt(o.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function Os(o,e,t){const n={min:new Array(o.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(o.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let r=e;r<e+t;r++)for(let i=0;i<o.itemSize;i++){let s;o.itemSize>4?s=o.array[r*o.itemSize+i]:(i===0?s=o.getX(r):i===1?s=o.getY(r):i===2?s=o.getZ(r):i===3&&(s=o.getW(r)),o.normalized===!0&&(s=dt.normalize(s,o.array))),n.min[i]=Math.min(n.min[i],s),n.max[i]=Math.max(n.max[i],s)}return n}function oi(o){return Math.ceil(o/4)*4}function xn(o,e=0){const t=oi(o.byteLength);if(t!==o.byteLength){const n=new Uint8Array(t);if(n.set(new Uint8Array(o)),e!==0)for(let r=o.byteLength;r<t;r++)n[r]=e;return n.buffer}return o}function vr(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function wr(o,e){if(o.toBlob!==void 0)return new Promise(n=>o.toBlob(n,e));let t;return e==="image/jpeg"?t=.92:e==="image/webp"&&(t=.8),o.convertToBlob({type:e,quality:t})}class Ls{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,t,n={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},n),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const r=this,i=r.buffers,s=r.json;n=r.options;const a=r.extensionsUsed,l=r.extensionsRequired,c=new Blob(i,{type:"application/octet-stream"}),u=Object.keys(a),h=Object.keys(l);u.length>0&&(s.extensionsUsed=u),h.length>0&&(s.extensionsRequired=h),s.buffers&&s.buffers.length>0&&(s.buffers[0].byteLength=c.size),n.binary===!0?c.arrayBuffer().then(v=>{const w=xn(v),y=new DataView(new ArrayBuffer(yr));y.setUint32(0,w.byteLength,!0),y.setUint32(4,Ps,!0);const _=xn(Rs(JSON.stringify(s)),32),m=new DataView(new ArrayBuffer(yr));m.setUint32(0,_.byteLength,!0),m.setUint32(4,Is,!0);const M=new ArrayBuffer(gr),R=new DataView(M);R.setUint32(0,As,!0),R.setUint32(4,Ss,!0);const E=gr+m.byteLength+_.byteLength+y.byteLength+w.byteLength;R.setUint32(8,E,!0),new Blob([M,m,_,y,w],{type:"application/octet-stream"}).arrayBuffer().then(t)}):s.buffers&&s.buffers.length>0?pr(c).then(v=>{s.buffers[0].uri=v,t(s)}):t(s)}serializeUserData(e,t){if(Object.keys(e.userData).length===0)return;const n=this.options,r=this.extensionsUsed;try{const i=JSON.parse(JSON.stringify(e.userData));if(n.includeCustomExtensions&&i.gltfExtensions){t.extensions===void 0&&(t.extensions={});for(const s in i.gltfExtensions)t.extensions[s]=i.gltfExtensions[s],r[s]=!0;delete i.gltfExtensions}Object.keys(i).length>0&&(t.extras=i)}catch(i){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+i.message)}}getUID(e,t=!1){if(this.uids.has(e)===!1){const n=new Map;n.set(!0,this.uid++),n.set(!1,this.uid++),this.uids.set(e,n)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const t=new F;for(let n=0,r=e.count;n<r;n++)if(Math.abs(t.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const n=e.clone(),r=new F;for(let i=0,s=n.count;i<s;i++)r.fromBufferAttribute(n,i),r.x===0&&r.y===0&&r.z===0?r.setX(1):r.normalize(),n.setXYZ(i,r.x,r.y,r.z);return t.attributesNormalized.set(e,n),n}applyTextureTransform(e,t){let n=!1;const r={};(t.offset.x!==0||t.offset.y!==0)&&(r.offset=t.offset.toArray(),n=!0),t.rotation!==0&&(r.rotation=t.rotation,n=!0),(t.repeat.x!==1||t.repeat.y!==1)&&(r.scale=t.repeat.toArray(),n=!0),n&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function n(v){return("colorSpace"in v?v.colorSpace==="srgb":v.encoding===3001)?function(w){return w<.04045?w*.0773993808:Math.pow(w*.9478672986+.0521327014,2.4)}:function(w){return w}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof gn&&(e=wn(e)),t instanceof gn&&(t=wn(t));const r=e?e.image:null,i=t?t.image:null,s=Math.max(r?r.width:0,i?i.width:0),a=Math.max(r?r.height:0,i?i.height:0),l=vr();l.width=s,l.height=a;const c=l.getContext("2d");c.fillStyle="#00ffff",c.fillRect(0,0,s,a);const u=c.getImageData(0,0,s,a);if(r){c.drawImage(r,0,0,s,a);const v=n(e),w=c.getImageData(0,0,s,a).data;for(let y=2;y<w.length;y+=4)u.data[y]=v(w[y]/256)*256}if(i){c.drawImage(i,0,0,s,a);const v=n(t),w=c.getImageData(0,0,s,a).data;for(let y=1;y<w.length;y+=4)u.data[y]=v(w[y]/256)*256}c.putImageData(u,0,0);const h=(e||t).clone();return h.source=new tn(l).source,"colorSpace"in h?h.colorSpace="":h.encoding=3e3,h.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),h}processBuffer(e){const t=this.json,n=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),n.push(e),0}processBufferView(e,t,n,r,i){const s=this.json;s.bufferViews||(s.bufferViews=[]);let a;switch(t){case re.BYTE:case re.UNSIGNED_BYTE:a=1;break;case re.SHORT:case re.UNSIGNED_SHORT:a=2;break;default:a=4}const l=oi(r*e.itemSize*a),c=new DataView(new ArrayBuffer(l));let u=0;for(let v=n;v<n+r;v++)for(let w=0;w<e.itemSize;w++){let y;e.itemSize>4?y=e.array[v*e.itemSize+w]:(w===0?y=e.getX(v):w===1?y=e.getY(v):w===2?y=e.getZ(v):w===3&&(y=e.getW(v)),e.normalized===!0&&(y=dt.normalize(y,e.array))),t===re.FLOAT?c.setFloat32(u,y,!0):t===re.INT?c.setInt32(u,y,!0):t===re.UNSIGNED_INT?c.setUint32(u,y,!0):t===re.SHORT?c.setInt16(u,y,!0):t===re.UNSIGNED_SHORT?c.setUint16(u,y,!0):t===re.BYTE?c.setInt8(u,y):t===re.UNSIGNED_BYTE&&c.setUint8(u,y),u+=a}const h={buffer:this.processBuffer(c.buffer),byteOffset:this.byteOffset,byteLength:l};return i!==void 0&&(h.target=i),i===re.ARRAY_BUFFER&&(h.byteStride=e.itemSize*a),this.byteOffset+=l,s.bufferViews.push(h),{id:s.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,n=t.json;return n.bufferViews||(n.bufferViews=[]),e.arrayBuffer().then(r=>{const i=xn(r),s={buffer:t.processBuffer(i),byteOffset:t.byteOffset,byteLength:i.byteLength};return t.byteOffset+=i.byteLength,n.bufferViews.push(s)-1})}processAccessor(e,t,n,r){const i=this.json,s={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let a;if(e.array.constructor===Float32Array)a=re.FLOAT;else if(e.array.constructor===Int32Array)a=re.INT;else if(e.array.constructor===Uint32Array)a=re.UNSIGNED_INT;else if(e.array.constructor===Int16Array)a=re.SHORT;else if(e.array.constructor===Uint16Array)a=re.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)a=re.BYTE;else if(e.array.constructor===Uint8Array)a=re.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(n===void 0&&(n=0),r===void 0&&(r=e.count),r===0)return null;const l=Os(e,n,r);let c;t!==void 0&&(c=e===t.index?re.ELEMENT_ARRAY_BUFFER:re.ARRAY_BUFFER);const u=this.processBufferView(e,a,n,r,c),h={bufferView:u.id,byteOffset:u.byteOffset,componentType:a,count:r,max:l.max,min:l.min,type:s[e.itemSize]};return e.normalized===!0&&(h.normalized=!0),i.accessors||(i.accessors=[]),i.accessors.push(h)-1}processImage(e,t,n,r="image/png"){if(e!==null){const i=this,s=i.cache,a=i.json,l=i.options,c=i.pending;s.images.has(e)||s.images.set(e,{});const u=s.images.get(e),h=r+":flipY/"+n.toString();if(u[h]!==void 0)return u[h];a.images||(a.images=[]);const v={mimeType:r},w=vr();w.width=Math.min(e.width,l.maxTextureSize),w.height=Math.min(e.height,l.maxTextureSize);const y=w.getContext("2d");if(n===!0&&(y.translate(0,w.height),y.scale(1,-1)),e.data!==void 0){t!==qi&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>l.maxTextureSize||e.height>l.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const m=new Uint8ClampedArray(e.height*e.width*4);for(let M=0;M<m.length;M+=4)m[M+0]=e.data[M+0],m[M+1]=e.data[M+1],m[M+2]=e.data[M+2],m[M+3]=e.data[M+3];y.putImageData(new ImageData(m,e.width,e.height),0,0)}else y.drawImage(e,0,0,w.width,w.height);l.binary===!0?c.push(wr(w,r).then(m=>i.processBufferViewImage(m)).then(m=>{v.bufferView=m})):w.toDataURL!==void 0?v.uri=w.toDataURL(r):c.push(wr(w,r).then(pr).then(m=>{v.uri=m}));const _=a.images.push(v)-1;return u[h]=_,_}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const n={magFilter:Pe[e.magFilter],minFilter:Pe[e.minFilter],wrapS:Pe[e.wrapS],wrapT:Pe[e.wrapT]};return t.samplers.push(n)-1}processTexture(e){const t=this.options,n=this.cache,r=this.json;if(n.textures.has(e))return n.textures.get(e);r.textures||(r.textures=[]),e instanceof gn&&(e=wn(e,t.maxTextureSize));let i=e.userData.mimeType;i==="image/webp"&&(i="image/png");const s={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,i)};e.name&&(s.name=e.name),this._invokeAll(function(l){l.writeTexture&&l.writeTexture(e,s)});const a=r.textures.push(s)-1;return n.textures.set(e,a),a}processMaterial(e){const t=this.cache,n=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;n.materials||(n.materials=[]);const r={pbrMetallicRoughness:{}};e.isMeshStandardMaterial!==!0&&e.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const i=e.color.toArray().concat([e.opacity]);if(Rt(i,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=i),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=.5,r.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const a=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),l={index:this.processTexture(a),channel:a.channel};this.applyTextureTransform(l,a),r.pbrMetallicRoughness.metallicRoughnessTexture=l}if(e.map){const a={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(a,e.map),r.pbrMetallicRoughness.baseColorTexture=a}if(e.emissive){const a=e.emissive;if(Math.max(a.r,a.g,a.b)>0&&(r.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const l={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(l,e.emissiveMap),r.emissiveTexture=l}}if(e.normalMap){const a={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&e.normalScale.x!==1&&(a.scale=e.normalScale.x),this.applyTextureTransform(a,e.normalMap),r.normalTexture=a}if(e.aoMap){const a={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};e.aoMapIntensity!==1&&(a.strength=e.aoMapIntensity),this.applyTextureTransform(a,e.aoMap),r.occlusionTexture=a}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),e.side===Mt&&(r.doubleSided=!0),e.name!==""&&(r.name=e.name),this.serializeUserData(e,r),this._invokeAll(function(a){a.writeMaterial&&a.writeMaterial(e,r)});const s=n.materials.push(r)-1;return t.materials.set(e,s),s}processMesh(e){const t=this.cache,n=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(let E=0,P=e.material.length;E<P;E++)r.push(e.material[E].uuid);else r.push(e.material.uuid);const i=r.join(":");if(t.meshes.has(i))return t.meshes.get(i);const s=e.geometry;let a;e.isLineSegments?a=re.LINES:e.isLineLoop?a=re.LINE_LOOP:e.isLine?a=re.LINE_STRIP:e.isPoints?a=re.POINTS:a=e.material.wireframe?re.LINES:re.TRIANGLES;const l={},c={},u=[],h=[],v={...Jn>=152?{uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3"}:{uv:"TEXCOORD_0",uv2:"TEXCOORD_1"},color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},w=s.getAttribute("normal");w!==void 0&&!this.isNormalizedNormalAttribute(w)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),s.setAttribute("normal",this.createNormalizedNormalAttribute(w)));let y=null;for(let E in s.attributes){if(E.slice(0,5)==="morph")continue;const P=s.attributes[E];if(E=v[E]||E.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(E)||(E="_"+E),t.attributes.has(this.getUID(P))){c[E]=t.attributes.get(this.getUID(P));continue}y=null;const D=P.array;E==="JOINTS_0"&&!(D instanceof Uint16Array)&&!(D instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),y=new Xe(new Uint16Array(D),P.itemSize,P.normalized));const b=this.processAccessor(y||P,s);b!==null&&(E.startsWith("_")||this.detectMeshQuantization(E,P),c[E]=b,t.attributes.set(this.getUID(P),b))}if(w!==void 0&&s.setAttribute("normal",w),Object.keys(c).length===0)return null;if(e.morphTargetInfluences!==void 0&&e.morphTargetInfluences.length>0){const E=[],P=[],D={};if(e.morphTargetDictionary!==void 0)for(const b in e.morphTargetDictionary)D[e.morphTargetDictionary[b]]=b;for(let b=0;b<e.morphTargetInfluences.length;++b){const A={};let f=!1;for(const g in s.morphAttributes){if(g!=="position"&&g!=="normal"){f||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),f=!0);continue}const d=s.morphAttributes[g][b],T=g.toUpperCase(),I=s.attributes[g];if(t.attributes.has(this.getUID(d,!0))){A[T]=t.attributes.get(this.getUID(d,!0));continue}const G=d.clone();if(!s.morphTargetsRelative)for(let V=0,U=d.count;V<U;V++)for(let j=0;j<d.itemSize;j++)j===0&&G.setX(V,d.getX(V)-I.getX(V)),j===1&&G.setY(V,d.getY(V)-I.getY(V)),j===2&&G.setZ(V,d.getZ(V)-I.getZ(V)),j===3&&G.setW(V,d.getW(V)-I.getW(V));A[T]=this.processAccessor(G,s),t.attributes.set(this.getUID(I,!0),A[T])}h.push(A),E.push(e.morphTargetInfluences[b]),e.morphTargetDictionary!==void 0&&P.push(D[b])}l.weights=E,P.length>0&&(l.extras={},l.extras.targetNames=P)}const _=Array.isArray(e.material);if(_&&s.groups.length===0)return null;const m=_?e.material:[e.material],M=_?s.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let E=0,P=M.length;E<P;E++){const D={mode:a,attributes:c};if(this.serializeUserData(s,D),h.length>0&&(D.targets=h),s.index!==null){let A=this.getUID(s.index);(M[E].start!==void 0||M[E].count!==void 0)&&(A+=":"+M[E].start+":"+M[E].count),t.attributes.has(A)?D.indices=t.attributes.get(A):(D.indices=this.processAccessor(s.index,s,M[E].start,M[E].count),t.attributes.set(A,D.indices)),D.indices===null&&delete D.indices}const b=this.processMaterial(m[M[E].materialIndex]);b!==null&&(D.material=b),u.push(D)}l.primitives=u,n.meshes||(n.meshes=[]),this._invokeAll(function(E){E.writeMesh&&E.writeMesh(e,l)});const R=n.meshes.push(l)-1;return t.meshes.set(i,R),R}detectMeshQuantization(e,t){if(this.extensionsUsed[bn])return;let n;switch(t.array.constructor){case Int8Array:n="byte";break;case Uint8Array:n="unsigned byte";break;case Int16Array:n="short";break;case Uint16Array:n="unsigned short";break;default:return}t.normalized&&(n+=" normalized");const r=e.split("_",1)[0];fr[r]&&fr[r].includes(n)&&(this.extensionsUsed[bn]=!0,this.extensionsRequired[bn]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const n=e.isOrthographicCamera,r={type:n?"orthographic":"perspective"};return n?r.orthographic={xmag:e.right*2,ymag:e.top*2,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:dt.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},e.name!==""&&(r.name=e.type),t.cameras.push(r)-1}processAnimation(e,t){const n=this.json,r=this.nodeMap;n.animations||(n.animations=[]),e=si.Utils.mergeMorphTargetTracks(e.clone(),t);const i=e.tracks,s=[],a=[];for(let l=0;l<i.length;++l){const c=i[l],u=Ot.parseTrackName(c.name);let h=Ot.findNode(t,u.nodeName);const v=mr[u.propertyName];if(u.objectName==="bones"&&(h.isSkinnedMesh===!0?h=h.skeleton.getBoneByName(u.objectIndex):h=void 0),!h||!v)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',c.name),null;const w=1;let y=c.values.length/c.times.length;v===mr.morphTargetInfluences&&(y/=h.morphTargetInfluences.length);let _;c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(_="CUBICSPLINE",y/=3):c.getInterpolation()===qr?_="STEP":_="LINEAR",a.push({input:this.processAccessor(new Xe(c.times,w)),output:this.processAccessor(new Xe(c.values,y)),interpolation:_}),s.push({sampler:a.length-1,target:{node:r.get(h),path:v}})}return n.animations.push({name:e.name||"clip_"+n.animations.length,samplers:a,channels:s}),n.animations.length-1}processSkin(e){const t=this.json,n=this.nodeMap,r=t.nodes[n.get(e)],i=e.skeleton;if(i===void 0)return null;const s=e.skeleton.bones[0];if(s===void 0)return null;const a=[],l=new Float32Array(i.bones.length*16),c=new Ue;for(let u=0;u<i.bones.length;++u)a.push(n.get(i.bones[u])),c.copy(i.boneInverses[u]),c.multiply(e.bindMatrix).toArray(l,u*16);return t.skins===void 0&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new Xe(l,16)),joints:a,skeleton:n.get(s)}),r.skin=t.skins.length-1}processNode(e){const t=this.json,n=this.options,r=this.nodeMap;t.nodes||(t.nodes=[]);const i={};if(n.trs){const a=e.quaternion.toArray(),l=e.position.toArray(),c=e.scale.toArray();Rt(a,[0,0,0,1])||(i.rotation=a),Rt(l,[0,0,0])||(i.translation=l),Rt(c,[1,1,1])||(i.scale=c)}else e.matrixAutoUpdate&&e.updateMatrix(),Cs(e.matrix)===!1&&(i.matrix=e.matrix.elements);if(e.name!==""&&(i.name=String(e.name)),this.serializeUserData(e,i),e.isMesh||e.isLine||e.isPoints){const a=this.processMesh(e);a!==null&&(i.mesh=a)}else e.isCamera&&(i.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const a=[];for(let l=0,c=e.children.length;l<c;l++){const u=e.children[l];if(u.visible||n.onlyVisible===!1){const h=this.processNode(u);h!==null&&a.push(h)}}a.length>0&&(i.children=a)}this._invokeAll(function(a){a.writeNode&&a.writeNode(e,i)});const s=t.nodes.push(i)-1;return r.set(e,s),s}processScene(e){const t=this.json,n=this.options;t.scenes||(t.scenes=[],t.scene=0);const r={};e.name!==""&&(r.name=e.name),t.scenes.push(r);const i=[];for(let s=0,a=e.children.length;s<a;s++){const l=e.children[s];if(l.visible||n.onlyVisible===!1){const c=this.processNode(l);c!==null&&i.push(c)}}i.length>0&&(r.nodes=i),this.serializeUserData(e,r)}processObjects(e){const t=new kn;t.name="AuxScene";for(let n=0;n<e.length;n++)t.children.push(e[n]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(r){r.beforeParse&&r.beforeParse(e)});const n=[];for(let r=0;r<e.length;r++)e[r]instanceof kn?this.processScene(e[r]):n.push(e[r]);n.length>0&&this.processObjects(n);for(let r=0;r<this.skins.length;++r)this.processSkin(this.skins[r]);for(let r=0;r<t.animations.length;++r)this.processAnimation(t.animations[r],e[0]);this._invokeAll(function(r){r.afterParse&&r.afterParse(e)})}_invokeAll(e){for(let t=0,n=this.plugins.length;t<n;t++)e(this.plugins[t])}}class Ds{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}const n=this.writer,r=n.json,i=n.extensionsUsed,s={};e.name&&(s.name=e.name),s.color=e.color.toArray(),s.intensity=e.intensity,e.isDirectionalLight?s.type="directional":e.isPointLight?(s.type="point",e.distance>0&&(s.range=e.distance)):e.isSpotLight&&(s.type="spot",e.distance>0&&(s.range=e.distance),s.spot={},s.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,s.spot.outerConeAngle=e.angle),e.decay!==void 0&&e.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||e.target.position.x!==0||e.target.position.y!==0||e.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),i[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},i[this.name]=!0);const a=r.extensions[this.name].lights;a.push(s),t.extensions=t.extensions||{},t.extensions[this.name]={light:a.length-1}}}let ks=class{constructor(o){this.writer=o,this.name="KHR_materials_unlit"}writeMaterial(o,e){if(!o.isMeshBasicMaterial)return;const t=this.writer.extensionsUsed;e.extensions=e.extensions||{},e.extensions[this.name]={},t[this.name]=!0,e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9}},Ns=class{constructor(o){this.writer=o,this.name="KHR_materials_clearcoat"}writeMaterial(o,e){if(!o.isMeshPhysicalMaterial||o.clearcoat===0)return;const t=this.writer,n=t.extensionsUsed,r={};if(r.clearcoatFactor=o.clearcoat,o.clearcoatMap){const i={index:t.processTexture(o.clearcoatMap),texCoord:o.clearcoatMap.channel};t.applyTextureTransform(i,o.clearcoatMap),r.clearcoatTexture=i}if(r.clearcoatRoughnessFactor=o.clearcoatRoughness,o.clearcoatRoughnessMap){const i={index:t.processTexture(o.clearcoatRoughnessMap),texCoord:o.clearcoatRoughnessMap.channel};t.applyTextureTransform(i,o.clearcoatRoughnessMap),r.clearcoatRoughnessTexture=i}if(o.clearcoatNormalMap){const i={index:t.processTexture(o.clearcoatNormalMap),texCoord:o.clearcoatNormalMap.channel};t.applyTextureTransform(i,o.clearcoatNormalMap),r.clearcoatNormalTexture=i}e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},js=class{constructor(o){this.writer=o,this.name="KHR_materials_iridescence"}writeMaterial(o,e){if(!o.isMeshPhysicalMaterial||o.iridescence===0)return;const t=this.writer,n=t.extensionsUsed,r={};if(r.iridescenceFactor=o.iridescence,o.iridescenceMap){const i={index:t.processTexture(o.iridescenceMap),texCoord:o.iridescenceMap.channel};t.applyTextureTransform(i,o.iridescenceMap),r.iridescenceTexture=i}if(r.iridescenceIor=o.iridescenceIOR,r.iridescenceThicknessMinimum=o.iridescenceThicknessRange[0],r.iridescenceThicknessMaximum=o.iridescenceThicknessRange[1],o.iridescenceThicknessMap){const i={index:t.processTexture(o.iridescenceThicknessMap),texCoord:o.iridescenceThicknessMap.channel};t.applyTextureTransform(i,o.iridescenceThicknessMap),r.iridescenceThicknessTexture=i}e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},Us=class{constructor(o){this.writer=o,this.name="KHR_materials_transmission"}writeMaterial(o,e){if(!o.isMeshPhysicalMaterial||o.transmission===0)return;const t=this.writer,n=t.extensionsUsed,r={};if(r.transmissionFactor=o.transmission,o.transmissionMap){const i={index:t.processTexture(o.transmissionMap),texCoord:o.transmissionMap.channel};t.applyTextureTransform(i,o.transmissionMap),r.transmissionTexture=i}e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},Fs=class{constructor(o){this.writer=o,this.name="KHR_materials_volume"}writeMaterial(o,e){if(!o.isMeshPhysicalMaterial||o.transmission===0)return;const t=this.writer,n=t.extensionsUsed,r={};if(r.thicknessFactor=o.thickness,o.thicknessMap){const i={index:t.processTexture(o.thicknessMap),texCoord:o.thicknessMap.channel};t.applyTextureTransform(i,o.thicknessMap),r.thicknessTexture=i}r.attenuationDistance=o.attenuationDistance,r.attenuationColor=o.attenuationColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},Bs=class{constructor(o){this.writer=o,this.name="KHR_materials_ior"}writeMaterial(o,e){if(!o.isMeshPhysicalMaterial||o.ior===1.5)return;const t=this.writer.extensionsUsed,n={};n.ior=o.ior,e.extensions=e.extensions||{},e.extensions[this.name]=n,t[this.name]=!0}},zs=class{constructor(o){this.writer=o,this.name="KHR_materials_specular"}writeMaterial(o,e){if(!o.isMeshPhysicalMaterial||o.specularIntensity===1&&o.specularColor.equals(Ts)&&!o.specularIntensityMap&&!o.specularColorTexture)return;const t=this.writer,n=t.extensionsUsed,r={};if(o.specularIntensityMap){const i={index:t.processTexture(o.specularIntensityMap),texCoord:o.specularIntensityMap.channel};t.applyTextureTransform(i,o.specularIntensityMap),r.specularTexture=i}if(o.specularColorMap){const i={index:t.processTexture(o.specularColorMap),texCoord:o.specularColorMap.channel};t.applyTextureTransform(i,o.specularColorMap),r.specularColorTexture=i}r.specularFactor=o.specularIntensity,r.specularColorFactor=o.specularColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},Hs=class{constructor(o){this.writer=o,this.name="KHR_materials_sheen"}writeMaterial(o,e){if(!o.isMeshPhysicalMaterial||o.sheen==0)return;const t=this.writer,n=t.extensionsUsed,r={};if(o.sheenRoughnessMap){const i={index:t.processTexture(o.sheenRoughnessMap),texCoord:o.sheenRoughnessMap.channel};t.applyTextureTransform(i,o.sheenRoughnessMap),r.sheenRoughnessTexture=i}if(o.sheenColorMap){const i={index:t.processTexture(o.sheenColorMap),texCoord:o.sheenColorMap.channel};t.applyTextureTransform(i,o.sheenColorMap),r.sheenColorTexture=i}r.sheenRoughnessFactor=o.sheenRoughness,r.sheenColorFactor=o.sheenColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},Vs=class{constructor(o){this.writer=o,this.name="KHR_materials_anisotropy"}writeMaterial(o,e){if(!o.isMeshPhysicalMaterial||o.anisotropy==0)return;const t=this.writer,n=t.extensionsUsed,r={};if(o.anisotropyMap){const i={index:t.processTexture(o.anisotropyMap)};t.applyTextureTransform(i,o.anisotropyMap),r.anisotropyTexture=i}r.anisotropyStrength=o.anisotropy,r.anisotropyRotation=o.anisotropyRotation,e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},Gs=class{constructor(o){this.writer=o,this.name="KHR_materials_emissive_strength"}writeMaterial(o,e){if(!o.isMeshStandardMaterial||o.emissiveIntensity===1)return;const t=this.writer.extensionsUsed,n={};n.emissiveStrength=o.emissiveIntensity,e.extensions=e.extensions||{},e.extensions[this.name]=n,t[this.name]=!0}};var jt=Uint8Array,ai=Uint16Array,Ys=Uint32Array,Xs=new jt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ks=new jt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),li=function(o,e){for(var t=new ai(31),n=0;n<31;++n)t[n]=e+=1<<o[n-1];for(var r=new Ys(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)r[i]=i-t[n]<<5|n;return[t,r]},ci=li(Xs,2),Zs=ci[0],Qs=ci[1];Zs[28]=258,Qs[258]=28;li(Ks,0);var qs=new ai(32768);for(var de=0;de<32768;++de){var Qe=(de&43690)>>>1|(de&21845)<<1;Qe=(Qe&52428)>>>2|(Qe&13107)<<2,Qe=(Qe&61680)>>>4|(Qe&3855)<<4,qs[de]=((Qe&65280)>>>8|(Qe&255)<<8)>>>1}var cn=new jt(288);for(var de=0;de<144;++de)cn[de]=8;for(var de=144;de<256;++de)cn[de]=9;for(var de=256;de<280;++de)cn[de]=7;for(var de=280;de<288;++de)cn[de]=8;var Ws=new jt(32);for(var de=0;de<32;++de)Ws[de]=5;var $s=new jt(0),Js=typeof TextDecoder<"u"&&new TextDecoder,eo=0;try{Js.decode($s,{stream:!0}),eo=1}catch{}var to=Object.defineProperty,no=(o,e,t)=>e in o?to(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,ro=(o,e,t)=>(no(o,e+"",t),t);const ui=class extends K{constructor(o,e={}){super(o),this.isReflector=!0,this.type="Reflector",this.camera=new Ye;const t=this,n=e.color!==void 0?new xe(e.color):new xe(8355711),r=e.textureWidth||512,i=e.textureHeight||512,s=e.clipBias||0,a=e.shader||ui.ReflectorShader,l=e.multisample!==void 0?e.multisample:4,c=new Vr,u=new F,h=new F,v=new F,w=new Ue,y=new F(0,0,-1),_=new it,m=new F,M=new F,R=new it,E=new Ue,P=this.camera,D=new Xi(r,i,{samples:l,type:Ki}),b=new ln({uniforms:Gn.clone(a.uniforms),fragmentShader:a.fragmentShader,vertexShader:a.vertexShader});b.uniforms.tDiffuse.value=D.texture,b.uniforms.color.value=n,b.uniforms.textureMatrix.value=E,this.material=b,this.onBeforeRender=function(A,f,g){if(h.setFromMatrixPosition(t.matrixWorld),v.setFromMatrixPosition(g.matrixWorld),w.extractRotation(t.matrixWorld),u.set(0,0,1),u.applyMatrix4(w),m.subVectors(h,v),m.dot(u)>0)return;m.reflect(u).negate(),m.add(h),w.extractRotation(g.matrixWorld),y.set(0,0,-1),y.applyMatrix4(w),y.add(v),M.subVectors(h,y),M.reflect(u).negate(),M.add(h),P.position.copy(m),P.up.set(0,1,0),P.up.applyMatrix4(w),P.up.reflect(u),P.lookAt(M),P.far=g.far,P.updateMatrixWorld(),P.projectionMatrix.copy(g.projectionMatrix),E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),E.multiply(P.projectionMatrix),E.multiply(P.matrixWorldInverse),E.multiply(t.matrixWorld),c.setFromNormalAndCoplanarPoint(u,h),c.applyMatrix4(P.matrixWorldInverse),_.set(c.normal.x,c.normal.y,c.normal.z,c.constant);const d=P.projectionMatrix;R.x=(Math.sign(_.x)+d.elements[8])/d.elements[0],R.y=(Math.sign(_.y)+d.elements[9])/d.elements[5],R.z=-1,R.w=(1+d.elements[10])/d.elements[14],_.multiplyScalar(2/_.dot(R)),d.elements[2]=_.x,d.elements[6]=_.y,d.elements[10]=_.z+1-s,d.elements[14]=_.w,t.visible=!1;const T=A.getRenderTarget(),I=A.xr.enabled,G=A.shadowMap.autoUpdate,V=A.toneMapping;let U=!1;"outputColorSpace"in A?U=A.outputColorSpace==="srgb":U=A.outputEncoding===3001,A.xr.enabled=!1,A.shadowMap.autoUpdate=!1,"outputColorSpace"in A?A.outputColorSpace="srgb-linear":A.outputEncoding=3e3,A.toneMapping=Zi,A.setRenderTarget(D),A.state.buffers.depth.setMask(!0),A.autoClear===!1&&A.clear(),A.render(f,P),A.xr.enabled=I,A.shadowMap.autoUpdate=G,A.toneMapping=V,"outputColorSpace"in A?A.outputColorSpace=U?"srgb":"srgb-linear":A.outputEncoding=U?3001:3e3,A.setRenderTarget(T);const j=g.viewport;j!==void 0&&A.state.viewport(j),t.visible=!0},this.getRenderTarget=function(){return D},this.dispose=function(){D.dispose(),t.material.dispose()}}};let jn=ui;ro(jn,"ReflectorShader",{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		#include <common>
		#include <logdepthbuf_pars_vertex>

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

			#include <logdepthbuf_vertex>

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		varying vec4 vUv;

		#include <logdepthbuf_pars_fragment>

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			#include <logdepthbuf_fragment>

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <${Jn>=154?"colorspace_fragment":"encodings_fragment"}>

		}`});var io=Object.defineProperty,so=(o,e,t)=>e in o?io(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,hi=(o,e,t)=>(so(o,typeof e!="symbol"?e+"":e,t),t);const Jt={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new F},up:{value:new F(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${Jn>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},di=new ln({name:"SkyShader",fragmentShader:Jt.fragmentShader,vertexShader:Jt.vertexShader,uniforms:Gn.clone(Jt.uniforms),side:Pi,depthWrite:!1});class pi extends K{constructor(){super(new Je(1,1,1),di)}}hi(pi,"SkyShader",Jt);hi(pi,"material",di);new Ri;new F;var oo=Object.defineProperty,ao=(o,e,t)=>e in o?oo(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,L=(o,e,t)=>(ao(o,typeof e!="symbol"?e+"":e,t),t);class lo extends Lt{constructor(e,t){super(),L(this,"isTransformControls",!0),L(this,"visible",!1),L(this,"domElement"),L(this,"raycaster",new Bi),L(this,"gizmo"),L(this,"plane"),L(this,"tempVector",new F),L(this,"tempVector2",new F),L(this,"tempQuaternion",new me),L(this,"unit",{X:new F(1,0,0),Y:new F(0,1,0),Z:new F(0,0,1)}),L(this,"pointStart",new F),L(this,"pointEnd",new F),L(this,"offset",new F),L(this,"rotationAxis",new F),L(this,"startNorm",new F),L(this,"endNorm",new F),L(this,"rotationAngle",0),L(this,"cameraPosition",new F),L(this,"cameraQuaternion",new me),L(this,"cameraScale",new F),L(this,"parentPosition",new F),L(this,"parentQuaternion",new me),L(this,"parentQuaternionInv",new me),L(this,"parentScale",new F),L(this,"worldPositionStart",new F),L(this,"worldQuaternionStart",new me),L(this,"worldScaleStart",new F),L(this,"worldPosition",new F),L(this,"worldQuaternion",new me),L(this,"worldQuaternionInv",new me),L(this,"worldScale",new F),L(this,"eye",new F),L(this,"positionStart",new F),L(this,"quaternionStart",new me),L(this,"scaleStart",new F),L(this,"camera"),L(this,"object"),L(this,"enabled",!0),L(this,"axis",null),L(this,"mode","translate"),L(this,"translationSnap",null),L(this,"rotationSnap",null),L(this,"scaleSnap",null),L(this,"space","world"),L(this,"size",1),L(this,"dragging",!1),L(this,"showX",!0),L(this,"showY",!0),L(this,"showZ",!0),L(this,"changeEvent",{type:"change"}),L(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),L(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),L(this,"objectChangeEvent",{type:"objectChange"}),L(this,"intersectObjectWithRay",(r,i,s)=>{const a=i.intersectObject(r,!0);for(let l=0;l<a.length;l++)if(a[l].object.visible||s)return a[l];return!1}),L(this,"attach",r=>(this.object=r,this.visible=!0,this)),L(this,"detach",()=>(this.object=void 0,this.visible=!1,this.axis=null,this)),L(this,"reset",()=>this.enabled?(this.dragging&&this.object!==void 0&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this):this),L(this,"updateMatrixWorld",()=>{this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()}),L(this,"pointerHover",r=>{if(this.object===void 0||this.dragging===!0)return;this.raycaster.setFromCamera(r,this.camera);const i=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);i?this.axis=i.object.name:this.axis=null}),L(this,"pointerDown",r=>{if(!(this.object===void 0||this.dragging===!0||r.button!==0)&&this.axis!==null){this.raycaster.setFromCamera(r,this.camera);const i=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(i){let s=this.space;if(this.mode==="scale"?s="local":(this.axis==="E"||this.axis==="XYZE"||this.axis==="XYZ")&&(s="world"),s==="local"&&this.mode==="rotate"){const a=this.rotationSnap;this.axis==="X"&&a&&(this.object.rotation.x=Math.round(this.object.rotation.x/a)*a),this.axis==="Y"&&a&&(this.object.rotation.y=Math.round(this.object.rotation.y/a)*a),this.axis==="Z"&&a&&(this.object.rotation.z=Math.round(this.object.rotation.z/a)*a)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(i.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}}),L(this,"pointerMove",r=>{const i=this.axis,s=this.mode,a=this.object;let l=this.space;if(s==="scale"?l="local":(i==="E"||i==="XYZE"||i==="XYZ")&&(l="world"),a===void 0||i===null||this.dragging===!1||r.button!==-1)return;this.raycaster.setFromCamera(r,this.camera);const c=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(c){if(this.pointEnd.copy(c.point).sub(this.worldPositionStart),s==="translate")this.offset.copy(this.pointEnd).sub(this.pointStart),l==="local"&&i!=="XYZ"&&this.offset.applyQuaternion(this.worldQuaternionInv),i.indexOf("X")===-1&&(this.offset.x=0),i.indexOf("Y")===-1&&(this.offset.y=0),i.indexOf("Z")===-1&&(this.offset.z=0),l==="local"&&i!=="XYZ"?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),a.position.copy(this.offset).add(this.positionStart),this.translationSnap&&(l==="local"&&(a.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),i.search("X")!==-1&&(a.position.x=Math.round(a.position.x/this.translationSnap)*this.translationSnap),i.search("Y")!==-1&&(a.position.y=Math.round(a.position.y/this.translationSnap)*this.translationSnap),i.search("Z")!==-1&&(a.position.z=Math.round(a.position.z/this.translationSnap)*this.translationSnap),a.position.applyQuaternion(this.quaternionStart)),l==="world"&&(a.parent&&a.position.add(this.tempVector.setFromMatrixPosition(a.parent.matrixWorld)),i.search("X")!==-1&&(a.position.x=Math.round(a.position.x/this.translationSnap)*this.translationSnap),i.search("Y")!==-1&&(a.position.y=Math.round(a.position.y/this.translationSnap)*this.translationSnap),i.search("Z")!==-1&&(a.position.z=Math.round(a.position.z/this.translationSnap)*this.translationSnap),a.parent&&a.position.sub(this.tempVector.setFromMatrixPosition(a.parent.matrixWorld))));else if(s==="scale"){if(i.search("XYZ")!==-1){let u=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(u*=-1),this.tempVector2.set(u,u,u)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),i.search("X")===-1&&(this.tempVector2.x=1),i.search("Y")===-1&&(this.tempVector2.y=1),i.search("Z")===-1&&(this.tempVector2.z=1);a.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(i.search("X")!==-1&&(this.object.scale.x=Math.round(a.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),i.search("Y")!==-1&&(a.scale.y=Math.round(a.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),i.search("Z")!==-1&&(a.scale.z=Math.round(a.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(s==="rotate"){this.offset.copy(this.pointEnd).sub(this.pointStart);const u=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));i==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this.endNorm.cross(this.startNorm).dot(this.eye)<0?1:-1):i==="XYZE"?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*u):(i==="X"||i==="Y"||i==="Z")&&(this.rotationAxis.copy(this.unit[i]),this.tempVector.copy(this.unit[i]),l==="local"&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*u),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),l==="local"&&i!=="E"&&i!=="XYZE"?(a.quaternion.copy(this.quaternionStart),a.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),a.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),a.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}}),L(this,"pointerUp",r=>{r.button===0&&(this.dragging&&this.axis!==null&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)}),L(this,"getPointer",r=>{var i;if(this.domElement&&(i=this.domElement.ownerDocument)!=null&&i.pointerLockElement)return{x:0,y:0,button:r.button};{const s=r.changedTouches?r.changedTouches[0]:r,a=this.domElement.getBoundingClientRect();return{x:(s.clientX-a.left)/a.width*2-1,y:-(s.clientY-a.top)/a.height*2+1,button:r.button}}}),L(this,"onPointerHover",r=>{if(this.enabled)switch(r.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(r));break}}),L(this,"onPointerDown",r=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(r)),this.pointerDown(this.getPointer(r)))}),L(this,"onPointerMove",r=>{this.enabled&&this.pointerMove(this.getPointer(r))}),L(this,"onPointerUp",r=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(r)))}),L(this,"getMode",()=>this.mode),L(this,"setMode",r=>{this.mode=r}),L(this,"setTranslationSnap",r=>{this.translationSnap=r}),L(this,"setRotationSnap",r=>{this.rotationSnap=r}),L(this,"setScaleSnap",r=>{this.scaleSnap=r}),L(this,"setSize",r=>{this.size=r}),L(this,"setSpace",r=>{this.space=r}),L(this,"update",()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}),L(this,"connect",r=>{r===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=r,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)}),L(this,"dispose",()=>{var r,i,s,a,l,c;(r=this.domElement)==null||r.removeEventListener("pointerdown",this.onPointerDown),(i=this.domElement)==null||i.removeEventListener("pointermove",this.onPointerHover),(a=(s=this.domElement)==null?void 0:s.ownerDocument)==null||a.removeEventListener("pointermove",this.onPointerMove),(c=(l=this.domElement)==null?void 0:l.ownerDocument)==null||c.removeEventListener("pointerup",this.onPointerUp),this.traverse(u=>{const h=u;h.geometry&&h.geometry.dispose(),h.material&&h.material.dispose()})}),this.domElement=t,this.camera=e,this.gizmo=new co,this.add(this.gizmo),this.plane=new uo,this.add(this.plane);const n=(r,i)=>{let s=i;Object.defineProperty(this,r,{get:function(){return s!==void 0?s:i},set:function(a){s!==a&&(s=a,this.plane[r]=a,this.gizmo[r]=a,this.dispatchEvent({type:r+"-changed",value:a}),this.dispatchEvent(this.changeEvent))}}),this[r]=i,this.plane[r]=i,this.gizmo[r]=i};n("camera",this.camera),n("object",this.object),n("enabled",this.enabled),n("axis",this.axis),n("mode",this.mode),n("translationSnap",this.translationSnap),n("rotationSnap",this.rotationSnap),n("scaleSnap",this.scaleSnap),n("space",this.space),n("size",this.size),n("dragging",this.dragging),n("showX",this.showX),n("showY",this.showY),n("showZ",this.showZ),n("worldPosition",this.worldPosition),n("worldPositionStart",this.worldPositionStart),n("worldQuaternion",this.worldQuaternion),n("worldQuaternionStart",this.worldQuaternionStart),n("cameraPosition",this.cameraPosition),n("cameraQuaternion",this.cameraQuaternion),n("pointStart",this.pointStart),n("pointEnd",this.pointEnd),n("rotationAxis",this.rotationAxis),n("rotationAngle",this.rotationAngle),n("eye",this.eye),t!==void 0&&this.connect(t)}}class co extends Lt{constructor(){super(),L(this,"isTransformControlsGizmo",!0),L(this,"type","TransformControlsGizmo"),L(this,"tempVector",new F(0,0,0)),L(this,"tempEuler",new Yn),L(this,"alignVector",new F(0,1,0)),L(this,"zeroVector",new F(0,0,0)),L(this,"lookAtMatrix",new Ue),L(this,"tempQuaternion",new me),L(this,"tempQuaternion2",new me),L(this,"identityQuaternion",new me),L(this,"unitX",new F(1,0,0)),L(this,"unitY",new F(0,1,0)),L(this,"unitZ",new F(0,0,1)),L(this,"gizmo"),L(this,"picker"),L(this,"helper"),L(this,"rotationAxis",new F),L(this,"cameraPosition",new F),L(this,"worldPositionStart",new F),L(this,"worldQuaternionStart",new me),L(this,"worldPosition",new F),L(this,"worldQuaternion",new me),L(this,"eye",new F),L(this,"camera",null),L(this,"enabled",!0),L(this,"axis",null),L(this,"mode","translate"),L(this,"space","world"),L(this,"size",1),L(this,"dragging",!1),L(this,"showX",!0),L(this,"showY",!0),L(this,"showZ",!0),L(this,"updateMatrixWorld",()=>{let q=this.space;this.mode==="scale"&&(q="local");const Y=q==="local"?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let te=[];te=te.concat(this.picker[this.mode].children),te=te.concat(this.gizmo[this.mode].children),te=te.concat(this.helper[this.mode].children);for(let pe=0;pe<te.length;pe++){const O=te[pe];O.visible=!0,O.rotation.set(0,0,0),O.position.copy(this.worldPosition);let we;if(this.camera.isOrthographicCamera?we=(this.camera.top-this.camera.bottom)/this.camera.zoom:we=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),O.scale.set(1,1,1).multiplyScalar(we*this.size/7),O.tag==="helper"){O.visible=!1,O.name==="AXIS"?(O.position.copy(this.worldPositionStart),O.visible=!!this.axis,this.axis==="X"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),O.quaternion.copy(Y).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(Y).dot(this.eye))>.9&&(O.visible=!1)),this.axis==="Y"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),O.quaternion.copy(Y).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(Y).dot(this.eye))>.9&&(O.visible=!1)),this.axis==="Z"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),O.quaternion.copy(Y).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(Y).dot(this.eye))>.9&&(O.visible=!1)),this.axis==="XYZE"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),O.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),O.quaternion.multiply(this.tempQuaternion),O.visible=this.dragging),this.axis==="E"&&(O.visible=!1)):O.name==="START"?(O.position.copy(this.worldPositionStart),O.visible=this.dragging):O.name==="END"?(O.position.copy(this.worldPosition),O.visible=this.dragging):O.name==="DELTA"?(O.position.copy(this.worldPositionStart),O.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),O.scale.copy(this.tempVector),O.visible=this.dragging):(O.quaternion.copy(Y),this.dragging?O.position.copy(this.worldPositionStart):O.position.copy(this.worldPosition),this.axis&&(O.visible=this.axis.search(O.name)!==-1));continue}O.quaternion.copy(Y),this.mode==="translate"||this.mode==="scale"?((O.name==="X"||O.name==="XYZX")&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(Y).dot(this.eye))>.99&&(O.scale.set(1e-10,1e-10,1e-10),O.visible=!1),(O.name==="Y"||O.name==="XYZY")&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(Y).dot(this.eye))>.99&&(O.scale.set(1e-10,1e-10,1e-10),O.visible=!1),(O.name==="Z"||O.name==="XYZZ")&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(Y).dot(this.eye))>.99&&(O.scale.set(1e-10,1e-10,1e-10),O.visible=!1),O.name==="XY"&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(Y).dot(this.eye))<.2&&(O.scale.set(1e-10,1e-10,1e-10),O.visible=!1),O.name==="YZ"&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(Y).dot(this.eye))<.2&&(O.scale.set(1e-10,1e-10,1e-10),O.visible=!1),O.name==="XZ"&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(Y).dot(this.eye))<.2&&(O.scale.set(1e-10,1e-10,1e-10),O.visible=!1),O.name.search("X")!==-1&&(this.alignVector.copy(this.unitX).applyQuaternion(Y).dot(this.eye)<0?O.tag==="fwd"?O.visible=!1:O.scale.x*=-1:O.tag==="bwd"&&(O.visible=!1)),O.name.search("Y")!==-1&&(this.alignVector.copy(this.unitY).applyQuaternion(Y).dot(this.eye)<0?O.tag==="fwd"?O.visible=!1:O.scale.y*=-1:O.tag==="bwd"&&(O.visible=!1)),O.name.search("Z")!==-1&&(this.alignVector.copy(this.unitZ).applyQuaternion(Y).dot(this.eye)<0?O.tag==="fwd"?O.visible=!1:O.scale.z*=-1:O.tag==="bwd"&&(O.visible=!1))):this.mode==="rotate"&&(this.tempQuaternion2.copy(Y),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(Y).invert()),O.name.search("E")!==-1&&O.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),O.name==="X"&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),O.quaternion.copy(this.tempQuaternion)),O.name==="Y"&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),O.quaternion.copy(this.tempQuaternion)),O.name==="Z"&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),O.quaternion.copy(this.tempQuaternion))),O.visible=O.visible&&(O.name.indexOf("X")===-1||this.showX),O.visible=O.visible&&(O.name.indexOf("Y")===-1||this.showY),O.visible=O.visible&&(O.name.indexOf("Z")===-1||this.showZ),O.visible=O.visible&&(O.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),O.material.tempOpacity=O.material.tempOpacity||O.material.opacity,O.material.tempColor=O.material.tempColor||O.material.color.clone(),O.material.color.copy(O.material.tempColor),O.material.opacity=O.material.tempOpacity,this.enabled?this.axis&&(O.name===this.axis?(O.material.opacity=1,O.material.color.lerp(new xe(1,1,1),.5)):this.axis.split("").some(function(le){return O.name===le})?(O.material.opacity=1,O.material.color.lerp(new xe(1,1,1),.5)):(O.material.opacity*=.25,O.material.color.lerp(new xe(1,1,1),.5))):(O.material.opacity*=.5,O.material.color.lerp(new xe(1,1,1),.5))}super.updateMatrixWorld()});const e=new rt({depthTest:!1,depthWrite:!1,transparent:!0,side:Mt,fog:!1,toneMapped:!1}),t=new Qr({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),n=e.clone();n.opacity=.15;const r=e.clone();r.opacity=.33;const i=e.clone();i.color.set(16711680);const s=e.clone();s.color.set(65280);const a=e.clone();a.color.set(255);const l=e.clone();l.opacity=.25;const c=l.clone();c.color.set(16776960);const u=l.clone();u.color.set(65535);const h=l.clone();h.color.set(16711935),e.clone().color.set(16776960);const v=t.clone();v.color.set(16711680);const w=t.clone();w.color.set(65280);const y=t.clone();y.color.set(255);const _=t.clone();_.color.set(65535);const m=t.clone();m.color.set(16711935);const M=t.clone();M.color.set(16776960);const R=t.clone();R.color.set(7895160);const E=M.clone();E.opacity=.25;const P=new De(0,.05,.2,12,1,!1),D=new Je(.125,.125,.125),b=new bt;b.setAttribute("position",new fn([0,0,0,1,0,0],3));const A=(q,Y)=>{const te=new bt,pe=[];for(let O=0;O<=64*Y;++O)pe.push(0,Math.cos(O/32*Math.PI)*q,Math.sin(O/32*Math.PI)*q);return te.setAttribute("position",new fn(pe,3)),te},f=()=>{const q=new bt;return q.setAttribute("position",new fn([0,0,0,1,1,1],3)),q},g={X:[[new K(P,i),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new K(P,i),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new ie(b,v)]],Y:[[new K(P,s),[0,1,0],null,null,"fwd"],[new K(P,s),[0,1,0],[Math.PI,0,0],null,"bwd"],[new ie(b,w),null,[0,0,Math.PI/2]]],Z:[[new K(P,a),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new K(P,a),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new ie(b,y),null,[0,-Math.PI/2,0]]],XYZ:[[new K(new at(.1,0),l.clone()),[0,0,0],[0,0,0]]],XY:[[new K(new Ge(.295,.295),c.clone()),[.15,.15,0]],[new ie(b,M),[.18,.3,0],null,[.125,1,1]],[new ie(b,M),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new K(new Ge(.295,.295),u.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new ie(b,_),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new ie(b,_),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new K(new Ge(.295,.295),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new ie(b,m),[.18,0,.3],null,[.125,1,1]],[new ie(b,m),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},d={X:[[new K(new De(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new K(new De(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new K(new De(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new K(new at(.2,0),n)]],XY:[[new K(new Ge(.4,.4),n),[.2,.2,0]]],YZ:[[new K(new Ge(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new K(new Ge(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]},T={START:[[new K(new at(.01,2),r),null,null,null,"helper"]],END:[[new K(new at(.01,2),r),null,null,null,"helper"]],DELTA:[[new ie(f(),r),null,null,null,"helper"]],X:[[new ie(b,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new ie(b,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new ie(b,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},I={X:[[new ie(A(1,.5),v)],[new K(new at(.04,0),i),[0,0,.99],null,[1,3,1]]],Y:[[new ie(A(1,.5),w),null,[0,0,-Math.PI/2]],[new K(new at(.04,0),s),[0,0,.99],null,[3,1,1]]],Z:[[new ie(A(1,.5),y),null,[0,Math.PI/2,0]],[new K(new at(.04,0),a),[.99,0,0],null,[1,3,1]]],E:[[new ie(A(1.25,1),E),null,[0,Math.PI/2,0]],[new K(new De(.03,0,.15,4,1,!1),E),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new K(new De(.03,0,.15,4,1,!1),E),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new K(new De(.03,0,.15,4,1,!1),E),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new K(new De(.03,0,.15,4,1,!1),E),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new ie(A(1,1),R),null,[0,Math.PI/2,0]]]},G={AXIS:[[new ie(b,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},V={X:[[new K(new Gt(1,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new K(new Gt(1,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new K(new Gt(1,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new K(new Gt(1.25,.1,2,24),n)]],XYZE:[[new K(new zi(.7,10,8),n)]]},U={X:[[new K(D,i),[.8,0,0],[0,0,-Math.PI/2]],[new ie(b,v),null,null,[.8,1,1]]],Y:[[new K(D,s),[0,.8,0]],[new ie(b,w),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new K(D,a),[0,0,.8],[Math.PI/2,0,0]],[new ie(b,y),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new K(D,c),[.85,.85,0],null,[2,2,.2]],[new ie(b,M),[.855,.98,0],null,[.125,1,1]],[new ie(b,M),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new K(D,u),[0,.85,.85],null,[.2,2,2]],[new ie(b,_),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new ie(b,_),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new K(D,h),[.85,0,.85],null,[2,.2,2]],[new ie(b,m),[.855,0,.98],null,[.125,1,1]],[new ie(b,m),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new K(new Je(.125,.125,.125),l.clone()),[1.1,0,0]]],XYZY:[[new K(new Je(.125,.125,.125),l.clone()),[0,1.1,0]]],XYZZ:[[new K(new Je(.125,.125,.125),l.clone()),[0,0,1.1]]]},j={X:[[new K(new De(.2,0,.8,4,1,!1),n),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new K(new De(.2,0,.8,4,1,!1),n),[0,.5,0]]],Z:[[new K(new De(.2,0,.8,4,1,!1),n),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new K(D,n),[.85,.85,0],null,[3,3,.2]]],YZ:[[new K(D,n),[0,.85,.85],null,[.2,3,3]]],XZ:[[new K(D,n),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new K(new Je(.2,.2,.2),n),[1.1,0,0]]],XYZY:[[new K(new Je(.2,.2,.2),n),[0,1.1,0]]],XYZZ:[[new K(new Je(.2,.2,.2),n),[0,0,1.1]]]},X={X:[[new ie(b,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new ie(b,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new ie(b,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Z=q=>{const Y=new Lt;for(let te in q)for(let pe=q[te].length;pe--;){const O=q[te][pe][0].clone(),we=q[te][pe][1],le=q[te][pe][2],be=q[te][pe][3],Re=q[te][pe][4];O.name=te,O.tag=Re,we&&O.position.set(we[0],we[1],we[2]),le&&O.rotation.set(le[0],le[1],le[2]),be&&O.scale.set(be[0],be[1],be[2]),O.updateMatrix();const B=O.geometry.clone();B.applyMatrix4(O.matrix),O.geometry=B,O.renderOrder=1/0,O.position.set(0,0,0),O.rotation.set(0,0,0),O.scale.set(1,1,1),Y.add(O)}return Y};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=Z(g)),this.add(this.gizmo.rotate=Z(I)),this.add(this.gizmo.scale=Z(U)),this.add(this.picker.translate=Z(d)),this.add(this.picker.rotate=Z(V)),this.add(this.picker.scale=Z(j)),this.add(this.helper.translate=Z(T)),this.add(this.helper.rotate=Z(G)),this.add(this.helper.scale=Z(X)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class uo extends K{constructor(){super(new Ge(1e5,1e5,2,2),new rt({visible:!1,wireframe:!0,side:Mt,transparent:!0,opacity:.1,toneMapped:!1})),L(this,"isTransformControlsPlane",!0),L(this,"type","TransformControlsPlane"),L(this,"unitX",new F(1,0,0)),L(this,"unitY",new F(0,1,0)),L(this,"unitZ",new F(0,0,1)),L(this,"tempVector",new F),L(this,"dirVector",new F),L(this,"alignVector",new F),L(this,"tempMatrix",new Ue),L(this,"identityQuaternion",new me),L(this,"cameraQuaternion",new me),L(this,"worldPosition",new F),L(this,"worldQuaternion",new me),L(this,"eye",new F),L(this,"axis",null),L(this,"mode","translate"),L(this,"space","world"),L(this,"updateMatrixWorld",()=>{let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),this.unitX.set(1,0,0).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0);break}break;case"rotate":default:this.dirVector.set(0,0,0)}this.dirVector.length()===0?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()})}}new Yn(0,0,0,"YXZ");new F;var ho=Object.defineProperty,po=(o,e,t)=>e in o?ho(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,J=(o,e,t)=>(po(o,typeof e!="symbol"?e+"":e,t),t);const Kt=new Ci,br=new Vr,fo=Math.cos(70*(Math.PI/180)),xr=(o,e)=>(o%e+e)%e;class mo extends Hi{constructor(e,t){super(),J(this,"object"),J(this,"domElement"),J(this,"enabled",!0),J(this,"target",new F),J(this,"minDistance",0),J(this,"maxDistance",1/0),J(this,"minZoom",0),J(this,"maxZoom",1/0),J(this,"minPolarAngle",0),J(this,"maxPolarAngle",Math.PI),J(this,"minAzimuthAngle",-1/0),J(this,"maxAzimuthAngle",1/0),J(this,"enableDamping",!1),J(this,"dampingFactor",.05),J(this,"enableZoom",!0),J(this,"zoomSpeed",1),J(this,"enableRotate",!0),J(this,"rotateSpeed",1),J(this,"enablePan",!0),J(this,"panSpeed",1),J(this,"screenSpacePanning",!0),J(this,"keyPanSpeed",7),J(this,"zoomToCursor",!1),J(this,"autoRotate",!1),J(this,"autoRotateSpeed",2),J(this,"reverseOrbit",!1),J(this,"reverseHorizontalOrbit",!1),J(this,"reverseVerticalOrbit",!1),J(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),J(this,"mouseButtons",{LEFT:gt.ROTATE,MIDDLE:gt.DOLLY,RIGHT:gt.PAN}),J(this,"touches",{ONE:tt.ROTATE,TWO:tt.DOLLY_PAN}),J(this,"target0"),J(this,"position0"),J(this,"zoom0"),J(this,"_domElementKeyEvents",null),J(this,"getPolarAngle"),J(this,"getAzimuthalAngle"),J(this,"setPolarAngle"),J(this,"setAzimuthalAngle"),J(this,"getDistance"),J(this,"listenToKeyEvents"),J(this,"stopListenToKeyEvents"),J(this,"saveState"),J(this,"reset"),J(this,"update"),J(this,"connect"),J(this,"dispose"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=C=>{let H=xr(C,2*Math.PI),$=u.phi;$<0&&($+=2*Math.PI),H<0&&(H+=2*Math.PI);let se=Math.abs(H-$);2*Math.PI-se<se&&(H<$?H+=2*Math.PI:$+=2*Math.PI),h.phi=H-$,n.update()},this.setAzimuthalAngle=C=>{let H=xr(C,2*Math.PI),$=u.theta;$<0&&($+=2*Math.PI),H<0&&(H+=2*Math.PI);let se=Math.abs(H-$);2*Math.PI-se<se&&(H<$?H+=2*Math.PI:$+=2*Math.PI),h.theta=H-$,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=C=>{C.addEventListener("keydown",Et),this._domElementKeyEvents=C},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Et),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),l=a.NONE},this.update=(()=>{const C=new F,H=new F(0,1,0),$=new me().setFromUnitVectors(e.up,H),se=$.clone().invert(),Se=new F,Le=new me,zt=2*Math.PI;return function(){const sr=n.object.position;$.setFromUnitVectors(e.up,H),se.copy($).invert(),C.copy(sr).sub(n.target),C.applyQuaternion($),u.setFromVector3(C),n.autoRotate&&l===a.NONE&&V(I()),n.enableDamping?(u.theta+=h.theta*n.dampingFactor,u.phi+=h.phi*n.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);let ze=n.minAzimuthAngle,He=n.maxAzimuthAngle;isFinite(ze)&&isFinite(He)&&(ze<-Math.PI?ze+=zt:ze>Math.PI&&(ze-=zt),He<-Math.PI?He+=zt:He>Math.PI&&(He-=zt),ze<=He?u.theta=Math.max(ze,Math.min(He,u.theta)):u.theta=u.theta>(ze+He)/2?Math.max(ze,u.theta):Math.min(He,u.theta)),u.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,u.phi)),u.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(w,n.dampingFactor):n.target.add(w),n.zoomToCursor&&g||n.object.isOrthographicCamera?u.radius=pe(u.radius):u.radius=pe(u.radius*v),C.setFromSpherical(u),C.applyQuaternion(se),sr.copy(n.target).add(C),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(h.theta*=1-n.dampingFactor,h.phi*=1-n.dampingFactor,w.multiplyScalar(1-n.dampingFactor)):(h.set(0,0,0),w.set(0,0,0));let _t=!1;if(n.zoomToCursor&&g){let Tt=null;if(n.object instanceof Ye&&n.object.isPerspectiveCamera){const At=C.length();Tt=pe(At*v);const Ht=At-Tt;n.object.position.addScaledVector(A,Ht),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const At=new F(f.x,f.y,0);At.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/v)),n.object.updateProjectionMatrix(),_t=!0;const Ht=new F(f.x,f.y,0);Ht.unproject(n.object),n.object.position.sub(Ht).add(At),n.object.updateMatrixWorld(),Tt=C.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;Tt!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(Tt).add(n.object.position):(Kt.origin.copy(n.object.position),Kt.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Kt.direction))<fo?e.lookAt(n.target):(br.setFromNormalAndCoplanarPoint(n.object.up,n.target),Kt.intersectPlane(br,n.target))))}else n.object instanceof ut&&n.object.isOrthographicCamera&&(_t=v!==1,_t&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/v)),n.object.updateProjectionMatrix()));return v=1,g=!1,_t||Se.distanceToSquared(n.object.position)>c||8*(1-Le.dot(n.object.quaternion))>c?(n.dispatchEvent(r),Se.copy(n.object.position),Le.copy(n.object.quaternion),_t=!1,!0):!1}})(),this.connect=C=>{n.domElement=C,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",ot),n.domElement.addEventListener("pointerdown",he),n.domElement.addEventListener("pointercancel",_e),n.domElement.addEventListener("wheel",Bt)},this.dispose=()=>{var C,H,$,se,Se,Le;n.domElement&&(n.domElement.style.touchAction="auto"),(C=n.domElement)==null||C.removeEventListener("contextmenu",ot),(H=n.domElement)==null||H.removeEventListener("pointerdown",he),($=n.domElement)==null||$.removeEventListener("pointercancel",_e),(se=n.domElement)==null||se.removeEventListener("wheel",Bt),(Se=n.domElement)==null||Se.ownerDocument.removeEventListener("pointermove",ce),(Le=n.domElement)==null||Le.ownerDocument.removeEventListener("pointerup",_e),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Et)};const n=this,r={type:"change"},i={type:"start"},s={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new or,h=new or;let v=1;const w=new F,y=new ve,_=new ve,m=new ve,M=new ve,R=new ve,E=new ve,P=new ve,D=new ve,b=new ve,A=new F,f=new ve;let g=!1;const d=[],T={};function I(){return 2*Math.PI/60/60*n.autoRotateSpeed}function G(){return Math.pow(.95,n.zoomSpeed)}function V(C){n.reverseOrbit||n.reverseHorizontalOrbit?h.theta+=C:h.theta-=C}function U(C){n.reverseOrbit||n.reverseVerticalOrbit?h.phi+=C:h.phi-=C}const j=(()=>{const C=new F;return function(H,$){C.setFromMatrixColumn($,0),C.multiplyScalar(-H),w.add(C)}})(),X=(()=>{const C=new F;return function(H,$){n.screenSpacePanning===!0?C.setFromMatrixColumn($,1):(C.setFromMatrixColumn($,0),C.crossVectors(n.object.up,C)),C.multiplyScalar(H),w.add(C)}})(),Z=(()=>{const C=new F;return function(H,$){const se=n.domElement;if(se&&n.object instanceof Ye&&n.object.isPerspectiveCamera){const Se=n.object.position;C.copy(Se).sub(n.target);let Le=C.length();Le*=Math.tan(n.object.fov/2*Math.PI/180),j(2*H*Le/se.clientHeight,n.object.matrix),X(2*$*Le/se.clientHeight,n.object.matrix)}else se&&n.object instanceof ut&&n.object.isOrthographicCamera?(j(H*(n.object.right-n.object.left)/n.object.zoom/se.clientWidth,n.object.matrix),X($*(n.object.top-n.object.bottom)/n.object.zoom/se.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function q(C){n.object instanceof Ye&&n.object.isPerspectiveCamera||n.object instanceof ut&&n.object.isOrthographicCamera?v/=C:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Y(C){n.object instanceof Ye&&n.object.isPerspectiveCamera||n.object instanceof ut&&n.object.isOrthographicCamera?v*=C:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function te(C){if(!n.zoomToCursor||!n.domElement)return;g=!0;const H=n.domElement.getBoundingClientRect(),$=C.clientX-H.left,se=C.clientY-H.top,Se=H.width,Le=H.height;f.x=$/Se*2-1,f.y=-(se/Le)*2+1,A.set(f.x,f.y,1).unproject(n.object).sub(n.object.position).normalize()}function pe(C){return Math.max(n.minDistance,Math.min(n.maxDistance,C))}function O(C){y.set(C.clientX,C.clientY)}function we(C){te(C),P.set(C.clientX,C.clientY)}function le(C){M.set(C.clientX,C.clientY)}function be(C){_.set(C.clientX,C.clientY),m.subVectors(_,y).multiplyScalar(n.rotateSpeed);const H=n.domElement;H&&(V(2*Math.PI*m.x/H.clientHeight),U(2*Math.PI*m.y/H.clientHeight)),y.copy(_),n.update()}function Re(C){D.set(C.clientX,C.clientY),b.subVectors(D,P),b.y>0?q(G()):b.y<0&&Y(G()),P.copy(D),n.update()}function B(C){R.set(C.clientX,C.clientY),E.subVectors(R,M).multiplyScalar(n.panSpeed),Z(E.x,E.y),M.copy(R),n.update()}function p(C){te(C),C.deltaY<0?Y(G()):C.deltaY>0&&q(G()),n.update()}function x(C){let H=!1;switch(C.code){case n.keys.UP:Z(0,n.keyPanSpeed),H=!0;break;case n.keys.BOTTOM:Z(0,-n.keyPanSpeed),H=!0;break;case n.keys.LEFT:Z(n.keyPanSpeed,0),H=!0;break;case n.keys.RIGHT:Z(-n.keyPanSpeed,0),H=!0;break}H&&(C.preventDefault(),n.update())}function S(){if(d.length==1)y.set(d[0].pageX,d[0].pageY);else{const C=.5*(d[0].pageX+d[1].pageX),H=.5*(d[0].pageY+d[1].pageY);y.set(C,H)}}function N(){if(d.length==1)M.set(d[0].pageX,d[0].pageY);else{const C=.5*(d[0].pageX+d[1].pageX),H=.5*(d[0].pageY+d[1].pageY);M.set(C,H)}}function k(){const C=d[0].pageX-d[1].pageX,H=d[0].pageY-d[1].pageY,$=Math.sqrt(C*C+H*H);P.set(0,$)}function z(){n.enableZoom&&k(),n.enablePan&&N()}function W(){n.enableZoom&&k(),n.enableRotate&&S()}function oe(C){if(d.length==1)_.set(C.pageX,C.pageY);else{const $=pn(C),se=.5*(C.pageX+$.x),Se=.5*(C.pageY+$.y);_.set(se,Se)}m.subVectors(_,y).multiplyScalar(n.rotateSpeed);const H=n.domElement;H&&(V(2*Math.PI*m.x/H.clientHeight),U(2*Math.PI*m.y/H.clientHeight)),y.copy(_)}function ue(C){if(d.length==1)R.set(C.pageX,C.pageY);else{const H=pn(C),$=.5*(C.pageX+H.x),se=.5*(C.pageY+H.y);R.set($,se)}E.subVectors(R,M).multiplyScalar(n.panSpeed),Z(E.x,E.y),M.copy(R)}function Me(C){const H=pn(C),$=C.pageX-H.x,se=C.pageY-H.y,Se=Math.sqrt($*$+se*se);D.set(0,Se),b.set(0,Math.pow(D.y/P.y,n.zoomSpeed)),q(b.y),P.copy(D)}function fe(C){n.enableZoom&&Me(C),n.enablePan&&ue(C)}function ge(C){n.enableZoom&&Me(C),n.enableRotate&&oe(C)}function he(C){var H,$;n.enabled!==!1&&(d.length===0&&((H=n.domElement)==null||H.ownerDocument.addEventListener("pointermove",ce),($=n.domElement)==null||$.ownerDocument.addEventListener("pointerup",_e)),Si(C),C.pointerType==="touch"?dn(C):ft(C))}function ce(C){n.enabled!==!1&&(C.pointerType==="touch"?Be(C):hn(C))}function _e(C){var H,$,se;Ii(C),d.length===0&&((H=n.domElement)==null||H.releasePointerCapture(C.pointerId),($=n.domElement)==null||$.ownerDocument.removeEventListener("pointermove",ce),(se=n.domElement)==null||se.ownerDocument.removeEventListener("pointerup",_e)),n.dispatchEvent(s),l=a.NONE}function ft(C){let H;switch(C.button){case 0:H=n.mouseButtons.LEFT;break;case 1:H=n.mouseButtons.MIDDLE;break;case 2:H=n.mouseButtons.RIGHT;break;default:H=-1}switch(H){case gt.DOLLY:if(n.enableZoom===!1)return;we(C),l=a.DOLLY;break;case gt.ROTATE:if(C.ctrlKey||C.metaKey||C.shiftKey){if(n.enablePan===!1)return;le(C),l=a.PAN}else{if(n.enableRotate===!1)return;O(C),l=a.ROTATE}break;case gt.PAN:if(C.ctrlKey||C.metaKey||C.shiftKey){if(n.enableRotate===!1)return;O(C),l=a.ROTATE}else{if(n.enablePan===!1)return;le(C),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(i)}function hn(C){if(n.enabled!==!1)switch(l){case a.ROTATE:if(n.enableRotate===!1)return;be(C);break;case a.DOLLY:if(n.enableZoom===!1)return;Re(C);break;case a.PAN:if(n.enablePan===!1)return;B(C);break}}function Bt(C){n.enabled===!1||n.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(C.preventDefault(),n.dispatchEvent(i),p(C),n.dispatchEvent(s))}function Et(C){n.enabled===!1||n.enablePan===!1||x(C)}function dn(C){switch(ir(C),d.length){case 1:switch(n.touches.ONE){case tt.ROTATE:if(n.enableRotate===!1)return;S(),l=a.TOUCH_ROTATE;break;case tt.PAN:if(n.enablePan===!1)return;N(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(n.touches.TWO){case tt.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;z(),l=a.TOUCH_DOLLY_PAN;break;case tt.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;W(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(i)}function Be(C){switch(ir(C),l){case a.TOUCH_ROTATE:if(n.enableRotate===!1)return;oe(C),n.update();break;case a.TOUCH_PAN:if(n.enablePan===!1)return;ue(C),n.update();break;case a.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;fe(C),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ge(C),n.update();break;default:l=a.NONE}}function ot(C){n.enabled!==!1&&C.preventDefault()}function Si(C){d.push(C)}function Ii(C){delete T[C.pointerId];for(let H=0;H<d.length;H++)if(d[H].pointerId==C.pointerId){d.splice(H,1);return}}function ir(C){let H=T[C.pointerId];H===void 0&&(H=new ve,T[C.pointerId]=H),H.set(C.pageX,C.pageY)}function pn(C){const H=C.pointerId===d[0].pointerId?d[1]:d[0];return T[H.pointerId]}t!==void 0&&this.connect(t),this.update()}}new F;new Yn;new F;var go=Object.defineProperty,yo=(o,e,t)=>e in o?go(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,er=(o,e,t)=>(yo(o,typeof e!="symbol"?e+"":e,t),t);class fi{constructor(e){er(this,"data"),this.data=e}generateShapes(e,t=100,n){const r=[],i={letterSpacing:0,lineHeight:1,...n},s=vo(e,t,this.data,i);for(let a=0,l=s.length;a<l;a++)Array.prototype.push.apply(r,s[a].toShapes(!1));return r}}er(fi,"isFont");er(fi,"type");function vo(o,e,t,n){const r=Array.from(o),i=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*i,a=[];let l=0,c=0;for(let u=0;u<r.length;u++){const h=r[u];if(h===`
`)l=0,c-=s*n.lineHeight;else{const v=wo(h,i,l,c,t);v&&(l+=v.offsetX+n.letterSpacing,a.push(v.path))}}return a}function wo(o,e,t,n,r){const i=r.glyphs[o]||r.glyphs["?"];if(!i){console.error('THREE.Font: character "'+o+'" does not exists in font family '+r.familyName+".");return}const s=new Wi;let a,l,c,u,h,v,w,y;if(i.o){const _=i._cachedOutline||(i._cachedOutline=i.o.split(" "));for(let m=0,M=_.length;m<M;)switch(_[m++]){case"m":a=parseInt(_[m++])*e+t,l=parseInt(_[m++])*e+n,s.moveTo(a,l);break;case"l":a=parseInt(_[m++])*e+t,l=parseInt(_[m++])*e+n,s.lineTo(a,l);break;case"q":c=parseInt(_[m++])*e+t,u=parseInt(_[m++])*e+n,h=parseInt(_[m++])*e+t,v=parseInt(_[m++])*e+n,s.quadraticCurveTo(h,v,c,u);break;case"b":c=parseInt(_[m++])*e+t,u=parseInt(_[m++])*e+n,h=parseInt(_[m++])*e+t,v=parseInt(_[m++])*e+n,w=parseInt(_[m++])*e+t,y=parseInt(_[m++])*e+n,s.bezierCurveTo(h,v,w,y,c,u);break}}return{offsetX:i.ha*e,path:s}}const Mn=new WeakMap;class bo extends ri{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const i=new rn(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,s=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(s,a).then(t).catch(r)},n,r)}decodeDracoFile(e,t,n,r){const i={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,i).then(t)}decodeGeometry(e,t){for(const l in t.attributeTypes){const c=t.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[l]=c.name)}const n=JSON.stringify(t);if(Mn.has(e)){const l=Mn.get(e);if(l.key===n)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const i=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(i,s).then(l=>(r=l,new Promise((c,u)=>{r._callbacks[i]={resolve:c,reject:u},r.postMessage({type:"decode",id:i,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&i&&this._releaseTask(r,i)}),Mn.set(e,{key:n,promise:a}),a}_createGeometry(e){const t=new bt;e.index&&t.setIndex(new Xe(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],i=r.name,s=r.array,a=r.itemSize;t.setAttribute(i,new Xe(s,a))}return t}_loadLibrary(e,t){const n=new rn(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((r,i)=>{n.load(e,r,void 0,i)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const i=xo.toString(),s=["/* draco decoder */",r,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(i){const s=i.data;switch(s.type){case"decode":r._callbacks[s.id].resolve(s);break;case"error":r._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,i){return r._taskLoad>i._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function xo(){let o,e;onmessage=function(s){const a=s.data;switch(a.type){case"init":o=a.decoderConfig,e=new Promise(function(u){o.onModuleLoaded=function(h){u({draco:h})},DracoDecoderModule(o)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(u=>{const h=u.draco,v=new h.Decoder,w=new h.DecoderBuffer;w.Init(new Int8Array(l),l.byteLength);try{const y=t(h,v,w,c),_=y.attributes.map(m=>m.array.buffer);y.index&&_.push(y.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:y},_)}catch(y){console.error(y),self.postMessage({type:"error",id:a.id,error:y.message})}finally{h.destroy(w),h.destroy(v)}});break}};function t(s,a,l,c){const u=c.attributeIDs,h=c.attributeTypes;let v,w;const y=a.GetEncodedGeometryType(l);if(y===s.TRIANGULAR_MESH)v=new s.Mesh,w=a.DecodeBufferToMesh(l,v);else if(y===s.POINT_CLOUD)v=new s.PointCloud,w=a.DecodeBufferToPointCloud(l,v);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!w.ok()||v.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+w.error_msg());const _={index:null,attributes:[]};for(const m in u){const M=self[h[m]];let R,E;if(c.useUniqueIDs)E=u[m],R=a.GetAttributeByUniqueId(v,E);else{if(E=a.GetAttributeId(v,s[u[m]]),E===-1)continue;R=a.GetAttribute(v,E)}_.attributes.push(r(s,a,v,m,M,R))}return y===s.TRIANGULAR_MESH&&(_.index=n(s,a,v)),s.destroy(v),_}function n(s,a,l){const c=l.num_faces()*3,u=c*4,h=s._malloc(u);a.GetTrianglesUInt32Array(l,u,h);const v=new Uint32Array(s.HEAPF32.buffer,h,c).slice();return s._free(h),{array:v,itemSize:1}}function r(s,a,l,c,u,h){const v=h.num_components(),w=l.num_points()*v,y=w*u.BYTES_PER_ELEMENT,_=i(s,u),m=s._malloc(y);a.GetAttributeDataArrayForAllPoints(l,h,_,y,m);const M=new u(s.HEAPF32.buffer,m,w).slice();return s._free(m),{name:c,array:M,itemSize:v}}function i(s,a){switch(a){case Float32Array:return s.DT_FLOAT32;case Int8Array:return s.DT_INT8;case Int16Array:return s.DT_INT16;case Int32Array:return s.DT_INT32;case Uint8Array:return s.DT_UINT8;case Uint16Array:return s.DT_UINT16;case Uint32Array:return s.DT_UINT32}}}const Mo=["args","material-uniforms-color-value"],Eo=en("TresPlaneGeometry",{args:[5,5]},null,-1),Fl=st({__name:"Reflector",props:{color:{default:"#333"},textureWidth:{default:512},textureHeight:{default:512},clipBias:{default:0},multisample:{default:4},shader:{default:jn.ReflectorShader}},setup(o,{expose:e}){const t=o,{extend:n,invalidate:r}=pt(),i=kt();n({Reflector:jn});const{color:s,textureWidth:a,textureHeight:l,clipBias:c,multisample:u,shader:h}=Nt(t);return Ke(t,()=>r()),e({instance:i}),(v,w)=>(Ie(),Oe("TresReflector",{ref_key:"reflectorRef",ref:i,args:[void 0,{textureWidth:Q(a),textureHeight:Q(l),clipBias:Q(c),multisample:Q(u),shader:Q(h)}],"material-uniforms-color-value":Q(s)},[Gr(v.$slots,"default",{},()=>[Eo])],8,Mo))}});function _o(o){return $i()?(Ji(o),!0):!1}function mi(o){return typeof o=="function"?o():Q(o)}const To=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ao=Object.prototype.toString,So=o=>Ao.call(o)==="[object Object]",Io=()=>{};function Po(o){var e;const t=mi(o);return(e=t==null?void 0:t.$el)!=null?e:t}const Ro=To?window:void 0;function nt(...o){let e,t,n,r;if(typeof o[0]=="string"||Array.isArray(o[0])?([t,n,r]=o,e=Ro):[e,t,n,r]=o,!e)return Io;Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);const i=[],s=()=>{i.forEach(u=>u()),i.length=0},a=(u,h,v,w)=>(u.addEventListener(h,v,w),()=>u.removeEventListener(h,v,w)),l=Ke(()=>[Po(e),mi(r)],([u,h])=>{if(s(),!u)return;const v=So(h)?{...h}:h;i.push(...t.flatMap(w=>n.map(y=>a(u,w,y,v))))},{immediate:!0,flush:"post"}),c=()=>{l(),s()};return _o(c),c}class sn extends K{constructor(){super(sn.Geometry,new rt({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const e=new F,t=new F,n=new ar(16,16),r=new ar(16,16);let i=lr;const s=sn.Geometry,a=new mn({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;

				void main() {

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				void main() {

					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );

				}`,depthTest:!0,depthWrite:!1,transparent:!1}),l=new mn({uniforms:{map:{value:n},scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;
				attribute vec2 uv;

				varying vec2 vUV;

				void main() {

					vUV = uv;

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				uniform sampler2D map;

				varying vec2 vUV;

				void main() {

					gl_FragColor = texture2D( map, vUV );

				}`,depthTest:!1,depthWrite:!1,transparent:!1}),c=new K(s,a),u=[],h=gi.Shader,v=new mn({name:h.name,uniforms:{map:{value:null},occlusionMap:{value:r},color:{value:new xe(16777215)},scale:{value:new ve},screenPosition:{value:new F}},vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:Vi,transparent:!0,depthWrite:!1}),w=new K(s,v);this.addElement=function(R){u.push(R)};const y=new ve,_=new ve,m=new Gi,M=new it;this.onBeforeRender=function(R,E,P){R.getCurrentViewport(M);const D=R.getRenderTarget(),b=D!==null?D.texture.type:lr;i!==b&&(n.dispose(),r.dispose(),n.type=r.type=b,i=b);const A=M.w/M.z,f=M.z/2,g=M.w/2;let d=16/M.w;if(y.set(d*A,d),m.min.set(M.x,M.y),m.max.set(M.x+(M.z-16),M.y+(M.w-16)),t.setFromMatrixPosition(this.matrixWorld),t.applyMatrix4(P.matrixWorldInverse),!(t.z>0)&&(e.copy(t).applyMatrix4(P.projectionMatrix),_.x=M.x+e.x*f+f-8,_.y=M.y+e.y*g+g-8,m.containsPoint(_))){R.copyFramebufferToTexture(n,_);let T=a.uniforms;T.scale.value=y,T.screenPosition.value=e,R.renderBufferDirect(P,null,s,a,c,null),R.copyFramebufferToTexture(r,_),T=l.uniforms,T.scale.value=y,T.screenPosition.value=e,R.renderBufferDirect(P,null,s,l,c,null);const I=-e.x*2,G=-e.y*2;for(let V=0,U=u.length;V<U;V++){const j=u[V],X=v.uniforms;X.color.value.copy(j.color),X.map.value=j.texture,X.screenPosition.value.x=e.x+I*j.distance,X.screenPosition.value.y=e.y+G*j.distance,d=j.size/M.w;const Z=M.w/M.z;X.scale.value.set(d*Z,d),v.uniformsNeedUpdate=!0,R.renderBufferDirect(P,null,s,v,w,null)}}},this.dispose=function(){a.dispose(),l.dispose(),v.dispose(),n.dispose(),r.dispose();for(let R=0,E=u.length;R<E;R++)u[R].texture.dispose()}}}class gi{constructor(e,t=1,n=0,r=new xe(16777215)){this.texture=e,this.size=t,this.distance=n,this.color=r}}gi.Shader={name:"LensflareElementShader",uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:`

		precision highp float;

		uniform vec3 screenPosition;
		uniform vec2 scale;

		uniform sampler2D occlusionMap;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vUV = uv;

			vec2 pos = position.xy;

			vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );

			vVisibility =        visibility.r / 9.0;
			vVisibility *= 1.0 - visibility.g / 9.0;
			vVisibility *=       visibility.b / 9.0;

			gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );

		}`,fragmentShader:`

		precision highp float;

		uniform sampler2D map;
		uniform vec3 color;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vec4 texture = texture2D( map, vUV );
			texture.a *= vVisibility;
			gl_FragColor = texture;
			gl_FragColor.rgb *= color;

		}`};sn.Geometry=function(){const o=new bt,e=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),t=new Yr(e,5);return o.setIndex([0,1,2,0,2,3]),o.setAttribute("position",new Dn(t,3,0,!1)),o.setAttribute("uv",new Dn(t,2,3,!1)),o}();dt.clamp;dt.lerp;function Mr(o,e){if(e===ys)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),o;if(e===Nn||e===ii){let t=o.getIndex();if(t===null){const s=[],a=o.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)s.push(l);o.setIndex(s),t=o.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o}const n=t.count-2,r=[];if(e===Nn)for(let s=1;s<=n;s++)r.push(t.getX(0)),r.push(t.getX(s)),r.push(t.getX(s+1));else for(let s=0;s<n;s++)s%2===0?(r.push(t.getX(s)),r.push(t.getX(s+1)),r.push(t.getX(s+2))):(r.push(t.getX(s+2)),r.push(t.getX(s+1)),r.push(t.getX(s)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const i=o.clone();return i.setIndex(r),i.clearGroups(),i}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),o}class Co extends ri{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new No(t)}),this.register(function(t){return new jo(t)}),this.register(function(t){return new Xo(t)}),this.register(function(t){return new Ko(t)}),this.register(function(t){return new Zo(t)}),this.register(function(t){return new Fo(t)}),this.register(function(t){return new Bo(t)}),this.register(function(t){return new zo(t)}),this.register(function(t){return new Ho(t)}),this.register(function(t){return new ko(t)}),this.register(function(t){return new Vo(t)}),this.register(function(t){return new Uo(t)}),this.register(function(t){return new Yo(t)}),this.register(function(t){return new Go(t)}),this.register(function(t){return new Lo(t)}),this.register(function(t){return new Qo(t)}),this.register(function(t){return new qo(t)})}load(e,t,n,r){const i=this;let s;if(this.resourcePath!=="")s=this.resourcePath;else if(this.path!==""){const c=Ct.extractUrlBase(e);s=Ct.resolveURL(c,this.path)}else s=Ct.extractUrlBase(e);this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),i.manager.itemError(e),i.manager.itemEnd(e)},l=new rn(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{i.parse(c,s,function(u){t(u),i.manager.itemEnd(e)},a)}catch(u){a(u)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let i;const s={},a={},l=new TextDecoder;if(typeof e=="string")i=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===yi){try{s[ne.KHR_BINARY_GLTF]=new Wo(e)}catch(u){r&&r(u);return}i=JSON.parse(s[ne.KHR_BINARY_GLTF].content)}else i=JSON.parse(l.decode(e));else i=e;if(i.asset===void 0||i.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new ua(i,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const h=this.pluginCallbacks[u](c);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[h.name]=h,s[h.name]=!0}if(i.extensionsUsed)for(let u=0;u<i.extensionsUsed.length;++u){const h=i.extensionsUsed[u],v=i.extensionsRequired||[];switch(h){case ne.KHR_MATERIALS_UNLIT:s[h]=new Do;break;case ne.KHR_DRACO_MESH_COMPRESSION:s[h]=new $o(i,this.dracoLoader);break;case ne.KHR_TEXTURE_TRANSFORM:s[h]=new Jo;break;case ne.KHR_MESH_QUANTIZATION:s[h]=new ea;break;default:v.indexOf(h)>=0&&a[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(s),c.setPlugins(a),c.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,i){n.parse(e,t,r,i)})}}function Oo(){let o={};return{get:function(e){return o[e]},add:function(e,t){o[e]=t},remove:function(e){delete o[e]},removeAll:function(){o={}}}}const ne={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Lo{constructor(e){this.parser=e,this.name=ne.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const i=t[n];i.extensions&&i.extensions[this.name]&&i.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const i=t.json,s=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e];let a;const l=new xe(16777215);s.color!==void 0&&l.setRGB(s.color[0],s.color[1],s.color[2],Ze);const c=s.range!==void 0?s.range:0;switch(s.type){case"directional":a=new is(l),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new rs(l),a.distance=c;break;case"spot":a=new ns(l),a.distance=c,s.spot=s.spot||{},s.spot.innerConeAngle=s.spot.innerConeAngle!==void 0?s.spot.innerConeAngle:0,s.spot.outerConeAngle=s.spot.outerConeAngle!==void 0?s.spot.outerConeAngle:Math.PI/4,a.angle=s.spot.outerConeAngle,a.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return a.position.set(0,0,0),a.decay=2,Ve(a,s),s.intensity!==void 0&&(a.intensity=s.intensity),a.name=t.createUniqueName(s.name||"light_"+e),r=Promise.resolve(a),t.cache.add(n,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],i=(r.extensions&&r.extensions[this.name]||{}).light;return i===void 0?null:this._loadLight(i).then(function(s){return n._getNodeRef(t.cache,i,s)})}}class Do{constructor(){this.name=ne.KHR_MATERIALS_UNLIT}getMaterialType(){return rt}extendParams(e,t,n){const r=[];e.color=new xe(1,1,1),e.opacity=1;const i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const s=i.baseColorFactor;e.color.setRGB(s[0],s[1],s[2],Ze),e.opacity=s[3]}i.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",i.baseColorTexture,Dt))}return Promise.all(r)}}class ko{constructor(e){this.parser=e,this.name=ne.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class No{constructor(e){this.parser=e,this.name=ne.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:Fe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];if(s.clearcoatFactor!==void 0&&(t.clearcoat=s.clearcoatFactor),s.clearcoatTexture!==void 0&&i.push(n.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),s.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),s.clearcoatRoughnessTexture!==void 0&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),s.clearcoatNormalTexture!==void 0&&(i.push(n.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),s.clearcoatNormalTexture.scale!==void 0)){const a=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ve(a,a)}return Promise.all(i)}}class jo{constructor(e){this.parser=e,this.name=ne.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:Fe}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class Uo{constructor(e){this.parser=e,this.name=ne.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:Fe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];return s.iridescenceFactor!==void 0&&(t.iridescence=s.iridescenceFactor),s.iridescenceTexture!==void 0&&i.push(n.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),s.iridescenceIor!==void 0&&(t.iridescenceIOR=s.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),s.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),s.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),s.iridescenceThicknessTexture!==void 0&&i.push(n.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(i)}}class Fo{constructor(e){this.parser=e,this.name=ne.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:Fe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[];t.sheenColor=new xe(0,0,0),t.sheenRoughness=0,t.sheen=1;const s=r.extensions[this.name];if(s.sheenColorFactor!==void 0){const a=s.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Ze)}return s.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=s.sheenRoughnessFactor),s.sheenColorTexture!==void 0&&i.push(n.assignTexture(t,"sheenColorMap",s.sheenColorTexture,Dt)),s.sheenRoughnessTexture!==void 0&&i.push(n.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(i)}}class Bo{constructor(e){this.parser=e,this.name=ne.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:Fe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];return s.transmissionFactor!==void 0&&(t.transmission=s.transmissionFactor),s.transmissionTexture!==void 0&&i.push(n.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(i)}}class zo{constructor(e){this.parser=e,this.name=ne.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:Fe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];t.thickness=s.thicknessFactor!==void 0?s.thicknessFactor:0,s.thicknessTexture!==void 0&&i.push(n.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||1/0;const a=s.attenuationColor||[1,1,1];return t.attenuationColor=new xe().setRGB(a[0],a[1],a[2],Ze),Promise.all(i)}}class Ho{constructor(e){this.parser=e,this.name=ne.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:Fe}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class Vo{constructor(e){this.parser=e,this.name=ne.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:Fe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];t.specularIntensity=s.specularFactor!==void 0?s.specularFactor:1,s.specularTexture!==void 0&&i.push(n.assignTexture(t,"specularIntensityMap",s.specularTexture));const a=s.specularColorFactor||[1,1,1];return t.specularColor=new xe().setRGB(a[0],a[1],a[2],Ze),s.specularColorTexture!==void 0&&i.push(n.assignTexture(t,"specularColorMap",s.specularColorTexture,Dt)),Promise.all(i)}}class Go{constructor(e){this.parser=e,this.name=ne.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:Fe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];return t.bumpScale=s.bumpFactor!==void 0?s.bumpFactor:1,s.bumpTexture!==void 0&&i.push(n.assignTexture(t,"bumpMap",s.bumpTexture)),Promise.all(i)}}class Yo{constructor(e){this.parser=e,this.name=ne.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:Fe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];return s.anisotropyStrength!==void 0&&(t.anisotropy=s.anisotropyStrength),s.anisotropyRotation!==void 0&&(t.anisotropyRotation=s.anisotropyRotation),s.anisotropyTexture!==void 0&&i.push(n.assignTexture(t,"anisotropyMap",s.anisotropyTexture)),Promise.all(i)}}class Xo{constructor(e){this.parser=e,this.name=ne.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const i=r.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,i.source,s)}}class Ko{constructor(e){this.parser=e,this.name=ne.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;const s=i.extensions[t],a=r.images[s.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,s.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Zo{constructor(e){this.parser=e,this.name=ne.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;const s=i.extensions[t],a=r.images[s.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,s.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Qo{constructor(e){this.name=ne.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],i=this.parser.getDependency("buffer",r.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,u=r.count,h=r.byteStride,v=new Uint8Array(a,l,c);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(u,h,v,r.mode,r.filter).then(function(w){return w.buffer}):s.ready.then(function(){const w=new ArrayBuffer(u*h);return s.decodeGltfBuffer(new Uint8Array(w),u,h,v,r.mode,r.filter),w})})}else return null}}class qo{constructor(e){this.name=ne.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const r=t.meshes[n.mesh];for(const l of r.primitives)if(l.mode!==Ce.TRIANGLES&&l.mode!==Ce.TRIANGLE_STRIP&&l.mode!==Ce.TRIANGLE_FAN&&l.mode!==void 0)return null;const i=n.extensions[this.name].attributes,s=[],a={};for(const l in i)s.push(this.parser.getDependency("accessor",i[l]).then(c=>(a[l]=c,a[l])));return s.length<1?null:(s.push(this.parser.createNodeMesh(e)),Promise.all(s).then(l=>{const c=l.pop(),u=c.isGroup?c.children:[c],h=l[0].count,v=[];for(const w of u){const y=new Ue,_=new F,m=new me,M=new F(1,1,1),R=new ss(w.geometry,w.material,h);for(let E=0;E<h;E++)a.TRANSLATION&&_.fromBufferAttribute(a.TRANSLATION,E),a.ROTATION&&m.fromBufferAttribute(a.ROTATION,E),a.SCALE&&M.fromBufferAttribute(a.SCALE,E),R.setMatrixAt(E,y.compose(_,m,M));for(const E in a)if(E==="_COLOR_0"){const P=a[E];R.instanceColor=new os(P.array,P.itemSize,P.normalized)}else E!=="TRANSLATION"&&E!=="ROTATION"&&E!=="SCALE"&&w.geometry.setAttribute(E,a[E]);Lt.prototype.copy.call(R,w),this.parser.assignFinalMaterial(R),v.push(R)}return c.isGroup?(c.clear(),c.add(...v),c):v[0]}))}}const yi="glTF",St=12,Er={JSON:1313821514,BIN:5130562};class Wo{constructor(e){this.name=ne.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,St),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==yi)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-St,i=new DataView(e,St);let s=0;for(;s<r;){const a=i.getUint32(s,!0);s+=4;const l=i.getUint32(s,!0);if(s+=4,l===Er.JSON){const c=new Uint8Array(e,St+s,a);this.content=n.decode(c)}else if(l===Er.BIN){const c=St+s;this.body=e.slice(c,c+a)}s+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class $o{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ne.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,a={},l={},c={};for(const u in s){const h=Un[u]||u.toLowerCase();a[h]=s[u]}for(const u in e.attributes){const h=Un[u]||u.toLowerCase();if(s[u]!==void 0){const v=n.accessors[e.attributes[u]],w=xt[v.componentType];c[h]=w.name,l[h]=v.normalized===!0}}return t.getDependency("bufferView",i).then(function(u){return new Promise(function(h,v){r.decodeDracoFile(u,function(w){for(const y in w.attributes){const _=w.attributes[y],m=l[y];m!==void 0&&(_.normalized=m)}h(w)},a,c,Ze,v)})})}}class Jo{constructor(){this.name=ne.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class ea{constructor(){this.name=ne.KHR_MESH_QUANTIZATION}}class vi extends ws{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r;for(let s=0;s!==r;s++)t[s]=n[i+s];return t}interpolate_(e,t,n,r){const i=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,u=r-t,h=(n-t)/u,v=h*h,w=v*h,y=e*c,_=y-c,m=-2*w+3*v,M=w-v,R=1-m,E=M-v+h;for(let P=0;P!==a;P++){const D=s[_+P+a],b=s[_+P+l]*u,A=s[y+P+a],f=s[y+P]*u;i[P]=R*D+E*b+m*A+M*f}return i}}const ta=new me;class na extends vi{interpolate_(e,t,n,r){const i=super.interpolate_(e,t,n,r);return ta.fromArray(i).normalize().toArray(i),i}}const Ce={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},xt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_r={9728:Wr,9729:Wn,9984:$r,9985:ei,9986:Jr,9987:$n},Tr={33071:ti,33648:ni,10497:nn},En={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Un={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},qe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ra={CUBICSPLINE:void 0,LINEAR:Qn,STEP:qr},_n={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function ia(o){return o.DefaultMaterial===void 0&&(o.DefaultMaterial=new qn({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:vs})),o.DefaultMaterial}function lt(o,e,t){for(const n in t.extensions)o[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Ve(o,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(o.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function sa(o,e,t){let n=!1,r=!1,i=!1;for(let c=0,u=e.length;c<u;c++){const h=e[c];if(h.POSITION!==void 0&&(n=!0),h.NORMAL!==void 0&&(r=!0),h.COLOR_0!==void 0&&(i=!0),n&&r&&i)break}if(!n&&!r&&!i)return Promise.resolve(o);const s=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const h=e[c];if(n){const v=h.POSITION!==void 0?t.getDependency("accessor",h.POSITION):o.attributes.position;s.push(v)}if(r){const v=h.NORMAL!==void 0?t.getDependency("accessor",h.NORMAL):o.attributes.normal;a.push(v)}if(i){const v=h.COLOR_0!==void 0?t.getDependency("accessor",h.COLOR_0):o.attributes.color;l.push(v)}}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],h=c[1],v=c[2];return n&&(o.morphAttributes.position=u),r&&(o.morphAttributes.normal=h),i&&(o.morphAttributes.color=v),o.morphTargetsRelative=!0,o})}function oa(o,e){if(o.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)o.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(o.morphTargetInfluences.length===t.length){o.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)o.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function aa(o){let e;const t=o.extensions&&o.extensions[ne.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+Tn(t.attributes):e=o.indices+":"+Tn(o.attributes)+":"+o.mode,o.targets!==void 0)for(let n=0,r=o.targets.length;n<r;n++)e+=":"+Tn(o.targets[n]);return e}function Tn(o){let e="";const t=Object.keys(o).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+o[t[n]]+";";return e}function Fn(o){switch(o){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function la(o){return o.search(/\.jpe?g($|\?)/i)>0||o.search(/^data\:image\/jpeg/)===0?"image/jpeg":o.search(/\.webp($|\?)/i)>0||o.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const ca=new Ue;class ua{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Oo,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=-1,i=!1,s=-1;if(typeof navigator<"u"){const a=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(a)===!0;const l=a.match(/Version\/(\d+)/);r=n&&l?parseInt(l[1],10):-1,i=a.indexOf("Firefox")>-1,s=i?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&r<17||i&&s<98?this.textureLoader=new as(this.options.manager):this.textureLoader=new ls(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new rn(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(s){const a={scene:s[0][r.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:r.asset,parser:n,userData:{}};return lt(i,a,r),Ve(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,i=t.length;r<i;r++){const s=t[r].joints;for(let a=0,l=s.length;a<l;a++)e[s[a]].isBone=!0}for(let r=0,i=e.length;r<i;r++){const s=e[r];s.mesh!==void 0&&(this._addNodeRef(this.meshCache,s.mesh),s.skin!==void 0&&(n[s.mesh].isSkinnedMesh=!0)),s.camera!==void 0&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),i=(s,a)=>{const l=this.associations.get(s);l!=null&&this.associations.set(a,l);for(const[c,u]of s.children.entries())i(u,a.children[c])};return i(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const i=e(t[r]);i&&n.push(i)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(i){return i.loadNode&&i.loadNode(t)});break;case"mesh":r=this._invokeOne(function(i){return i.loadMesh&&i.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(i){return i.loadBufferView&&i.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(i){return i.loadMaterial&&i.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(i){return i.loadTexture&&i.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(i){return i.loadAnimation&&i.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(i){return i!=this&&i.getDependency&&i.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(i,s){return n.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[ne.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(i,s){n.load(Ct.resolveURL(t.uri,r.path),i,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const r=t.byteLength||0,i=t.byteOffset||0;return n.slice(i,i+r)})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const s=En[r.type],a=xt[r.componentType],l=r.normalized===!0,c=new a(r.count*s);return Promise.resolve(new Xe(c,s,l))}const i=[];return r.bufferView!==void 0?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),r.sparse!==void 0&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then(function(s){const a=s[0],l=En[r.type],c=xt[r.componentType],u=c.BYTES_PER_ELEMENT,h=u*l,v=r.byteOffset||0,w=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,y=r.normalized===!0;let _,m;if(w&&w!==h){const M=Math.floor(v/w),R="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+M+":"+r.count;let E=t.cache.get(R);E||(_=new c(a,M*w,r.count*w/u),E=new Yr(_,w/u),t.cache.add(R,E)),m=new Dn(E,l,v%w/u,y)}else a===null?_=new c(r.count*l):_=new c(a,v,r.count*l),m=new Xe(_,l,y);if(r.sparse!==void 0){const M=En.SCALAR,R=xt[r.sparse.indices.componentType],E=r.sparse.indices.byteOffset||0,P=r.sparse.values.byteOffset||0,D=new R(s[1],E,r.sparse.count*M),b=new c(s[2],P,r.sparse.count*l);a!==null&&(m=new Xe(m.array.slice(),m.itemSize,m.normalized));for(let A=0,f=D.length;A<f;A++){const g=D[A];if(m.setX(g,b[A*l]),l>=2&&m.setY(g,b[A*l+1]),l>=3&&m.setZ(g,b[A*l+2]),l>=4&&m.setW(g,b[A*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,i=t.images[r];let s=this.textureLoader;if(i.uri){const a=n.manager.getHandler(i.uri);a!==null&&(s=a)}return this.loadTextureImage(e,r,s)}loadTextureImage(e,t,n){const r=this,i=this.json,s=i.textures[e],a=i.images[t],l=(a.uri||a.bufferView)+":"+s.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,n).then(function(u){u.flipY=!1,u.name=s.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);const h=(i.samplers||{})[s.sampler]||{};return u.magFilter=_r[h.magFilter]||Wn,u.minFilter=_r[h.minFilter]||$n,u.wrapS=Tr[h.wrapS]||nn,u.wrapT=Tr[h.wrapT]||nn,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const n=this,r=this.json,i=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(h=>h.clone());const s=r.images[e],a=self.URL||self.webkitURL;let l=s.uri||"",c=!1;if(s.bufferView!==void 0)l=n.getDependency("bufferView",s.bufferView).then(function(h){c=!0;const v=new Blob([h],{type:s.mimeType});return l=a.createObjectURL(v),l});else if(s.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(h){return new Promise(function(v,w){let y=v;t.isImageBitmapLoader===!0&&(y=function(_){const m=new tn(_);m.needsUpdate=!0,v(m)}),t.load(Ct.resolveURL(h,i.path),y,void 0,w)})}).then(function(h){return c===!0&&a.revokeObjectURL(l),Ve(h,s),h.userData.mimeType=s.mimeType||la(s.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=u,u}assignTexture(e,t,n,r){const i=this;return this.getDependency("texture",n.index).then(function(s){if(!s)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(s=s.clone(),s.channel=n.texCoord),i.extensions[ne.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[ne.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=i.associations.get(s);s=i.extensions[ne.KHR_TEXTURE_TRANSFORM].extendTexture(s,a),i.associations.set(s,l)}}return r!==void 0&&(s.colorSpace=r),e[t]=s,s})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=t.attributes.tangent===void 0,i=t.attributes.color!==void 0,s=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new cs,$t.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new Qr,$t.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(r||i||s){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),i&&(a+="vertex-colors:"),s&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),i&&(l.vertexColors=!0),s&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return qn}loadMaterial(e){const t=this,n=this.json,r=this.extensions,i=n.materials[e];let s;const a={},l=i.extensions||{},c=[];if(l[ne.KHR_MATERIALS_UNLIT]){const h=r[ne.KHR_MATERIALS_UNLIT];s=h.getMaterialType(),c.push(h.extendParams(a,i,t))}else{const h=i.pbrMetallicRoughness||{};if(a.color=new xe(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const v=h.baseColorFactor;a.color.setRGB(v[0],v[1],v[2],Ze),a.opacity=v[3]}h.baseColorTexture!==void 0&&c.push(t.assignTexture(a,"map",h.baseColorTexture,Dt)),a.metalness=h.metallicFactor!==void 0?h.metallicFactor:1,a.roughness=h.roughnessFactor!==void 0?h.roughnessFactor:1,h.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),s=this._invokeOne(function(v){return v.getMaterialType&&v.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(v){return v.extendMaterialParams&&v.extendMaterialParams(e,a)})))}i.doubleSided===!0&&(a.side=Mt);const u=i.alphaMode||_n.OPAQUE;if(u===_n.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===_n.MASK&&(a.alphaTest=i.alphaCutoff!==void 0?i.alphaCutoff:.5)),i.normalTexture!==void 0&&s!==rt&&(c.push(t.assignTexture(a,"normalMap",i.normalTexture)),a.normalScale=new ve(1,1),i.normalTexture.scale!==void 0)){const h=i.normalTexture.scale;a.normalScale.set(h,h)}if(i.occlusionTexture!==void 0&&s!==rt&&(c.push(t.assignTexture(a,"aoMap",i.occlusionTexture)),i.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=i.occlusionTexture.strength)),i.emissiveFactor!==void 0&&s!==rt){const h=i.emissiveFactor;a.emissive=new xe().setRGB(h[0],h[1],h[2],Ze)}return i.emissiveTexture!==void 0&&s!==rt&&c.push(t.assignTexture(a,"emissiveMap",i.emissiveTexture,Dt)),Promise.all(c).then(function(){const h=new s(a);return i.name&&(h.name=i.name),Ve(h,i),t.associations.set(h,{materials:e}),i.extensions&&lt(r,h,i),h})}createUniqueName(e){const t=Ot.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function i(a){return n[ne.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return Ar(l,a,t)})}const s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=aa(c),h=r[u];if(h)s.push(h.promise);else{let v;c.extensions&&c.extensions[ne.KHR_DRACO_MESH_COMPRESSION]?v=i(c):v=Ar(new bt,c,t),r[u]={primitive:c,promise:v},s.push(v)}}return Promise.all(s)}loadMesh(e){const t=this,n=this.json,r=this.extensions,i=n.meshes[e],s=i.primitives,a=[];for(let l=0,c=s.length;l<c;l++){const u=s[l].material===void 0?ia(this.cache):this.getDependency("material",s[l].material);a.push(u)}return a.push(t.loadGeometries(s)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],h=[];for(let w=0,y=u.length;w<y;w++){const _=u[w],m=s[w];let M;const R=c[w];if(m.mode===Ce.TRIANGLES||m.mode===Ce.TRIANGLE_STRIP||m.mode===Ce.TRIANGLE_FAN||m.mode===void 0)M=i.isSkinnedMesh===!0?new us(_,R):new K(_,R),M.isSkinnedMesh===!0&&M.normalizeSkinWeights(),m.mode===Ce.TRIANGLE_STRIP?M.geometry=Mr(M.geometry,ii):m.mode===Ce.TRIANGLE_FAN&&(M.geometry=Mr(M.geometry,Nn));else if(m.mode===Ce.LINES)M=new hs(_,R);else if(m.mode===Ce.LINE_STRIP)M=new ie(_,R);else if(m.mode===Ce.LINE_LOOP)M=new ds(_,R);else if(m.mode===Ce.POINTS)M=new ps(_,R);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(M.geometry.morphAttributes).length>0&&oa(M,i),M.name=t.createUniqueName(i.name||"mesh_"+e),Ve(M,i),m.extensions&&lt(r,M,m),t.assignFinalMaterial(M),h.push(M)}for(let w=0,y=h.length;w<y;w++)t.associations.set(h[w],{meshes:e,primitives:w});if(h.length===1)return i.extensions&&lt(r,h[0],i),h[0];const v=new yn;i.extensions&&lt(r,v,i),t.associations.set(v,{meshes:e});for(let w=0,y=h.length;w<y;w++)v.add(h[w]);return v})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Ye(dt.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new ut(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Ve(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,i=t.joints.length;r<i;r++)n.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){const i=r.pop(),s=r,a=[],l=[];for(let c=0,u=s.length;c<u;c++){const h=s[c];if(h){a.push(h);const v=new Ue;i!==null&&v.fromArray(i.array,c*16),l.push(v)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new fs(a,l)})}loadAnimation(e){const t=this.json,n=this,r=t.animations[e],i=r.name?r.name:"animation_"+e,s=[],a=[],l=[],c=[],u=[];for(let h=0,v=r.channels.length;h<v;h++){const w=r.channels[h],y=r.samplers[w.sampler],_=w.target,m=_.node,M=r.parameters!==void 0?r.parameters[y.input]:y.input,R=r.parameters!==void 0?r.parameters[y.output]:y.output;_.node!==void 0&&(s.push(this.getDependency("node",m)),a.push(this.getDependency("accessor",M)),l.push(this.getDependency("accessor",R)),c.push(y),u.push(_))}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(h){const v=h[0],w=h[1],y=h[2],_=h[3],m=h[4],M=[];for(let R=0,E=v.length;R<E;R++){const P=v[R],D=w[R],b=y[R],A=_[R],f=m[R];if(P===void 0)continue;P.updateMatrix&&P.updateMatrix();const g=n._createAnimationTracks(P,D,b,A,f);if(g)for(let d=0;d<g.length;d++)M.push(g[d])}return new ms(i,void 0,M)})}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(i){const s=n._getNodeRef(n.meshCache,r.mesh,i);return r.weights!==void 0&&s.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),s})}loadNode(e){const t=this.json,n=this,r=t.nodes[e],i=n._loadNodeShallow(e),s=[],a=r.children||[];for(let c=0,u=a.length;c<u;c++)s.push(n.getDependency("node",a[c]));const l=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([i,Promise.all(s),l]).then(function(c){const u=c[0],h=c[1],v=c[2];v!==null&&u.traverse(function(w){w.isSkinnedMesh&&w.bind(v,ca)});for(let w=0,y=h.length;w<y;w++)u.add(h[w]);return u})}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const i=t.nodes[e],s=i.name?r.createUniqueName(i.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),i.camera!==void 0&&a.push(r.getDependency("camera",i.camera).then(function(c){return r._getNodeRef(r.cameraCache,i.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(i.isBone===!0?u=new gs:c.length>1?u=new yn:c.length===1?u=c[0]:u=new Lt,u!==c[0])for(let h=0,v=c.length;h<v;h++)u.add(c[h]);if(i.name&&(u.userData.name=i.name,u.name=s),Ve(u,i),i.extensions&&lt(n,u,i),i.matrix!==void 0){const h=new Ue;h.fromArray(i.matrix),u.applyMatrix4(h)}else i.translation!==void 0&&u.position.fromArray(i.translation),i.rotation!==void 0&&u.quaternion.fromArray(i.rotation),i.scale!==void 0&&u.scale.fromArray(i.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,i=new yn;n.name&&(i.name=r.createUniqueName(n.name)),Ve(i,n),n.extensions&&lt(t,i,n);const s=n.nodes||[],a=[];for(let l=0,c=s.length;l<c;l++)a.push(r.getDependency("node",s[l]));return Promise.all(a).then(function(l){for(let u=0,h=l.length;u<h;u++)i.add(l[u]);const c=u=>{const h=new Map;for(const[v,w]of r.associations)(v instanceof $t||v instanceof tn)&&h.set(v,w);return u.traverse(v=>{const w=r.associations.get(v);w!=null&&h.set(v,w)}),h};return r.associations=c(i),i})}_createAnimationTracks(e,t,n,r,i){const s=[],a=e.name?e.name:e.uuid,l=[];qe[i.path]===qe.weights?e.traverse(function(v){v.morphTargetInfluences&&l.push(v.name?v.name:v.uuid)}):l.push(a);let c;switch(qe[i.path]){case qe.weights:c=hr;break;case qe.rotation:c=dr;break;case qe.position:case qe.scale:c=ur;break;default:switch(n.itemSize){case 1:c=hr;break;case 2:case 3:default:c=ur;break}break}const u=r.interpolation!==void 0?ra[r.interpolation]:Qn,h=this._getArrayFromAccessor(n);for(let v=0,w=l.length;v<w;v++){const y=new c(l[v]+"."+qe[i.path],t.array,h,u);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(y),s.push(y)}return s}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=Fn(t.constructor),r=new Float32Array(t.length);for(let i=0,s=t.length;i<s;i++)r[i]=t[i]*n;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(t){const n=this instanceof dr?na:vi;return new n(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function ha(o,e,t){const n=e.attributes,r=new Zn;if(n.POSITION!==void 0){const a=t.json.accessors[n.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new F(l[0],l[1],l[2]),new F(c[0],c[1],c[2])),a.normalized){const u=Fn(xt[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const i=e.targets;if(i!==void 0){const a=new F,l=new F;for(let c=0,u=i.length;c<u;c++){const h=i[c];if(h.POSITION!==void 0){const v=t.json.accessors[h.POSITION],w=v.min,y=v.max;if(w!==void 0&&y!==void 0){if(l.setX(Math.max(Math.abs(w[0]),Math.abs(y[0]))),l.setY(Math.max(Math.abs(w[1]),Math.abs(y[1]))),l.setZ(Math.max(Math.abs(w[2]),Math.abs(y[2]))),v.normalized){const _=Fn(xt[v.componentType]);l.multiplyScalar(_)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}o.boundingBox=r;const s=new Kr;r.getCenter(s.center),s.radius=r.min.distanceTo(r.max)/2,o.boundingSphere=s}function Ar(o,e,t){const n=e.attributes,r=[];function i(s,a){return t.getDependency("accessor",s).then(function(l){o.setAttribute(a,l)})}for(const s in n){const a=Un[s]||s.toLowerCase();a in o.attributes||r.push(i(n[s],a))}if(e.indices!==void 0&&!o.index){const s=t.getDependency("accessor",e.indices).then(function(a){o.setIndex(a)});r.push(s)}return cr.workingColorSpace!==Ze&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${cr.workingColorSpace}" not supported.`),Ve(o,e),ha(o,e,t),Promise.all(r).then(function(){return e.targets!==void 0?sa(o,e.targets,t):o})}let ht=null;function da(o,e){return t=>{o.draco&&(ht||(ht=new bo),ht.setDecoderPath(o.decoderPath||"https://www.gstatic.com/draco/versioned/decoders/1.4.3/"),t.setDRACOLoader&&t.setDRACOLoader(ht))}}async function Bl(o,e={draco:!1},t){const n=await Qi(Co,o,da(e));return ht==null||ht.dispose(),ht=null,n}const pa=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","args"],zl=st({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{default:()=>({ONE:tt.ROTATE,TWO:tt.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(o,{expose:e,emit:t}){const n=o,r=t,{makeDefault:i,autoRotate:s,autoRotateSpeed:a,enableDamping:l,dampingFactor:c,enablePan:u,keyPanSpeed:h,maxAzimuthAngle:v,minAzimuthAngle:w,maxPolarAngle:y,minPolarAngle:_,minDistance:m,maxDistance:M,minZoom:R,maxZoom:E,enableZoom:P,zoomSpeed:D,enableRotate:b,touches:A,rotateSpeed:f,target:g}=Nt(n),{camera:d,renderer:T,extend:I,controls:G,invalidate:V}=pt(),U=je(null);I({OrbitControls:mo}),Ke(U,Z=>{j(),Z&&i.value?G.value=Z:G.value=null});function j(){nt(U.value,"change",()=>{r("change",U.value),V()}),nt(U.value,"start",()=>r("start",U.value)),nt(U.value,"end",()=>r("end",U.value))}const{onBeforeRender:X}=Xr();return X(({invalidate:Z})=>{U.value&&(l.value||s.value)&&(U.value.update(),s.value&&Z())}),Xn(()=>{U.value&&U.value.dispose()}),e({instance:U}),(Z,q)=>(Z.camera||Q(d))&&(Z.domElement||Q(T))?(Ie(),Oe("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:U,target:Q(g),"auto-rotate":Q(s),"auto-rotate-speed":Q(a),"enable-damping":Q(l),"damping-factor":Q(c),"enable-pan":Q(u),"key-pan-speed":Q(h),keys:Z.keys,"max-azimuth-angle":Q(v),"min-azimuth-angle":Q(w),"max-polar-angle":Q(y),"min-polar-angle":Q(_),"min-distance":Q(m),"max-distance":Q(M),"min-zoom":Q(R),"max-zoom":Q(E),touches:Q(A),"enable-zoom":Q(P),"zoom-speed":Q(D),"enable-rotate":Q(b),"rotate-speed":Q(f),args:[Z.camera||Q(d),Z.domElement||Q(T).domElement]},null,8,pa)):Kn("",!0)}}),fa=["object","args","mode","enabled","axis","translation-snap","rotation-snap","scale-snap","space","size","show-x","show-y","show-z"],Hl=st({__name:"TransformControls",props:{object:{},camera:{},mode:{default:"translate"},enabled:{type:Boolean,default:!0},axis:{default:"XYZ"},translationSnap:{},rotationSnap:{},scaleSnap:{},space:{default:"world"},size:{default:1},showX:{type:Boolean,default:!0},showY:{type:Boolean,default:!0},showZ:{type:Boolean,default:!0}},emits:["dragging","change","mouseDown","mouseUp","objectChange"],setup(o,{expose:e,emit:t}){const n=o,r=t,{object:i,mode:s,enabled:a,axis:l,translationSnap:c,rotationSnap:u,scaleSnap:h,space:v,size:w,showX:y,showY:_,showZ:m}=Nt(n),M=kt(null),{controls:R,camera:E,renderer:P,extend:D,invalidate:b}=pt();Ke([i,s,a,l,c,u,h,v,w,y,_,m],()=>{b()}),D({TransformControls:lo});const A=()=>{b(),r("change")},f=G=>{R.value&&(R.value.enabled=!G.value),b(),r("dragging",G.value)},g=()=>{b(),r("mouseDown")},d=()=>{b(),r("mouseDown")},T=()=>{b(),r("objectChange")};function I(){nt(M.value,"change",A),nt(M.value,"dragging-changed",f),nt(M.value,"mouseDown",g),nt(M.value,"mouseUp",d),nt(M.value,"objectChange",T)}return Ke(M,G=>{G&&I()}),Xn(()=>{M.value&&M.value.dispose()}),e({instance:M}),(G,V)=>{var U;return(G.camera||Q(E))&&Q(P)?(Ie(),Oe("TresTransformControls",{ref_key:"controlsRef",ref:M,key:(U=G.camera||Q(E))==null?void 0:U.uuid,object:Q(i),args:[G.camera||Q(E),Q(P).domElement],mode:Q(s),enabled:Q(a),axis:Q(l),"translation-snap":Q(c),"rotation-snap":Q(u),"scale-snap":Q(h),space:Q(v),size:Q(w),"show-x":Q(y),"show-y":Q(_),"show-z":Q(m),visible:!0},null,8,fa)):Kn("",!0)}}});var An;/Mac/.test((An=globalThis==null?void 0:globalThis.navigator)===null||An===void 0?void 0:An.platform);function ct(o,e,t){return Math.max(e,Math.min(t,o))}function ma(o,e){return(o%e+e)%e}function Sn(o,e,t){return(1-t)*o+t*e}class tr{constructor(e=0,t=0){tr.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(ct(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,s=this.y-e.y;return this.x=i*n-s*r+e.x,this.y=i*r+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}const ga="",et="srgb",nr="srgb-linear",ya="display-p3",wi="display-p3-linear",Bn="linear",Sr="srgb",Ir="rec709",Pr="p3";class Ut{constructor(e,t,n,r,i,s,a,l,c){Ut.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,s,a,l,c)}set(e,t,n,r,i,s,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=i,u[5]=l,u[6]=n,u[7]=s,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,s=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],v=n[2],w=n[5],y=n[8],_=r[0],m=r[3],M=r[6],R=r[1],E=r[4],P=r[7],D=r[2],b=r[5],A=r[8];return i[0]=s*_+a*R+l*D,i[3]=s*m+a*E+l*b,i[6]=s*M+a*P+l*A,i[1]=c*_+u*R+h*D,i[4]=c*m+u*E+h*b,i[7]=c*M+u*P+h*A,i[2]=v*_+w*R+y*D,i[5]=v*m+w*E+y*b,i[8]=v*M+w*P+y*A,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*s*u-t*a*c-n*i*u+n*a*l+r*i*c-r*s*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*s-a*c,v=a*l-u*i,w=c*i-s*l,y=t*h+n*v+r*w;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/y;return e[0]=h*_,e[1]=(r*c-u*n)*_,e[2]=(a*n-r*s)*_,e[3]=v*_,e[4]=(u*t-r*l)*_,e[5]=(r*i-a*t)*_,e[6]=w*_,e[7]=(n*l-c*t)*_,e[8]=(s*t-n*i)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,s,a){const l=Math.cos(i),c=Math.sin(i);return this.set(n*l,n*c,-n*(l*s+c*a)+s+e,-r*c,r*l,-r*(-c*s+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(In.makeScale(e,t)),this}rotate(e){return this.premultiply(In.makeRotation(-e)),this}translate(e,t){return this.premultiply(In.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const In=new Ut,Rr=new Ut().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Cr=new Ut().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),It={[nr]:{transfer:Bn,primaries:Ir,luminanceCoefficients:[.2126,.7152,.0722],toReference:o=>o,fromReference:o=>o},[et]:{transfer:Sr,primaries:Ir,luminanceCoefficients:[.2126,.7152,.0722],toReference:o=>o.convertSRGBToLinear(),fromReference:o=>o.convertLinearToSRGB()},[wi]:{transfer:Bn,primaries:Pr,luminanceCoefficients:[.2289,.6917,.0793],toReference:o=>o.applyMatrix3(Cr),fromReference:o=>o.applyMatrix3(Rr)},[ya]:{transfer:Sr,primaries:Pr,luminanceCoefficients:[.2289,.6917,.0793],toReference:o=>o.convertSRGBToLinear().applyMatrix3(Cr),fromReference:o=>o.applyMatrix3(Rr).convertLinearToSRGB()}},va=new Set([nr,wi]),ke={enabled:!0,_workingColorSpace:nr,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(o){if(!va.has(o))throw new Error(`Unsupported working color space, "${o}".`);this._workingColorSpace=o},convert:function(o,e,t){if(this.enabled===!1||e===t||!e||!t)return o;const n=It[e].toReference,r=It[t].fromReference;return r(n(o))},fromWorkingColorSpace:function(o,e){return this.convert(o,this._workingColorSpace,e)},toWorkingColorSpace:function(o,e){return this.convert(o,e,this._workingColorSpace)},getPrimaries:function(o){return It[o].primaries},getTransfer:function(o){return o===ga?Bn:It[o].transfer},getLuminanceCoefficients:function(o,e=this._workingColorSpace){return o.fromArray(It[e].luminanceCoefficients)}};function Pn(o){return o<.04045?o*.0773993808:Math.pow(o*.9478672986+.0521327014,2.4)}function Rn(o){return o<.0031308?o*12.92:1.055*Math.pow(o,.41666)-.055}const bi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},We={h:0,s:0,l:0},Zt={h:0,s:0,l:0};function Cn(o,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?o+(e-o)*6*t:t<1/2?e:t<2/3?o+(e-o)*6*(2/3-t):o}class on{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=et){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ke.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=ke.workingColorSpace){return this.r=e,this.g=t,this.b=n,ke.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=ke.workingColorSpace){if(e=ma(e,1),t=ct(t,0,1),n=ct(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,s=2*n-i;this.r=Cn(s,i,e+1/3),this.g=Cn(s,i,e),this.b=Cn(s,i,e-1/3)}return ke.toWorkingColorSpace(this,r),this}setStyle(e,t=et){function n(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const s=r[1],a=r[2];switch(s){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=r[1],s=i.length;if(s===3)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(s===6)return this.setHex(parseInt(i,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=et){const n=bi[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Pn(e.r),this.g=Pn(e.g),this.b=Pn(e.b),this}copyLinearToSRGB(e){return this.r=Rn(e.r),this.g=Rn(e.g),this.b=Rn(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=et){return ke.fromWorkingColorSpace(Ee.copy(this),e),Math.round(ct(Ee.r*255,0,255))*65536+Math.round(ct(Ee.g*255,0,255))*256+Math.round(ct(Ee.b*255,0,255))}getHexString(e=et){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=ke.workingColorSpace){ke.fromWorkingColorSpace(Ee.copy(this),t);const n=Ee.r,r=Ee.g,i=Ee.b,s=Math.max(n,r,i),a=Math.min(n,r,i);let l,c;const u=(a+s)/2;if(a===s)l=0,c=0;else{const h=s-a;switch(c=u<=.5?h/(s+a):h/(2-s-a),s){case n:l=(r-i)/h+(r<i?6:0);break;case r:l=(i-n)/h+2;break;case i:l=(n-r)/h+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=ke.workingColorSpace){return ke.fromWorkingColorSpace(Ee.copy(this),t),e.r=Ee.r,e.g=Ee.g,e.b=Ee.b,e}getStyle(e=et){ke.fromWorkingColorSpace(Ee.copy(this),e);const t=Ee.r,n=Ee.g,r=Ee.b;return e!==et?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(We),this.setHSL(We.h+e,We.s+t,We.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(We),e.getHSL(Zt);const n=Sn(We.h,Zt.h,t),r=Sn(We.s,Zt.s,t),i=Sn(We.l,Zt.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ee=new on;on.NAMES=bi;class wa extends qn{constructor(e={}){super(),ye(this,"isMeshPhysicalMaterial"),ye(this,"clearcoatMap"),ye(this,"clearcoatRoughness"),ye(this,"clearcoatRoughnessMap"),ye(this,"clearcoatNormalScale"),ye(this,"clearcoatNormalMap"),ye(this,"ior"),ye(this,"transmissionMap"),ye(this,"thickness"),ye(this,"thicknessMap"),ye(this,"attenuationDistance"),ye(this,"attenuationColor"),ye(this,"specularIntensity"),ye(this,"specularIntensityMap"),ye(this,"specularColor"),ye(this,"specularColorMap"),ye(this,"_clearcoat"),ye(this,"_transmission"),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new tr(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get(){return ct(2.5*(this.ior-1)/(this.ior+1),0,1)},set(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.roughness=0,this.transmissionMap=null,this.thickness=.5,this.thicknessMap=null,this.attenuationDistance=Number.POSITIVE_INFINITY,this.attenuationColor=new on(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new on(1,1,1),this.specularColorMap=null,this._clearcoat=.5,this._transmission=1,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}const Vl=st({__name:"index",setup(o,{expose:e}){const t=kt(),{extend:n}=pt();return n({MeshGlassMaterial:wa}),e({instance:t}),(r,i)=>(Ie(),Oe("TresMeshGlassMaterial",{ref_key:"MeshGlassMaterialClass",ref:t},null,512))}});var ba=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function un(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function Qt(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xi={exports:{}};(function(o,e){(function(t){o.exports=t()})(function(){return function t(n,r,i){function s(c,u){if(!r[c]){if(!n[c]){var h=typeof Qt=="function"&&Qt;if(!u&&h)return h(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+c+"'")}u=r[c]={exports:{}},n[c][0].call(u.exports,function(v){var w=n[c][1][v];return s(w||v)},u,u.exports,t,n,r,i)}return r[c].exports}for(var a=typeof Qt=="function"&&Qt,l=0;l<i.length;l++)s(i[l]);return s}({1:[function(t,n,r){(function(i,s,a,l,c,u,h,v,w){var y=t("crypto");function _(b,A){A=R(b,A);var f;return(f=A.algorithm!=="passthrough"?y.createHash(A.algorithm):new D).write===void 0&&(f.write=f.update,f.end=f.update),P(A,f).dispatch(b),f.update||f.end(""),f.digest?f.digest(A.encoding==="buffer"?void 0:A.encoding):(b=f.read(),A.encoding!=="buffer"?b.toString(A.encoding):b)}(r=n.exports=_).sha1=function(b){return _(b)},r.keys=function(b){return _(b,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},r.MD5=function(b){return _(b,{algorithm:"md5",encoding:"hex"})},r.keysMD5=function(b){return _(b,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=y.getHashes?y.getHashes().slice():["sha1","md5"],M=(m.push("passthrough"),["buffer","hex","binary","base64"]);function R(b,A){var f={};if(f.algorithm=(A=A||{}).algorithm||"sha1",f.encoding=A.encoding||"hex",f.excludeValues=!!A.excludeValues,f.algorithm=f.algorithm.toLowerCase(),f.encoding=f.encoding.toLowerCase(),f.ignoreUnknown=A.ignoreUnknown===!0,f.respectType=A.respectType!==!1,f.respectFunctionNames=A.respectFunctionNames!==!1,f.respectFunctionProperties=A.respectFunctionProperties!==!1,f.unorderedArrays=A.unorderedArrays===!0,f.unorderedSets=A.unorderedSets!==!1,f.unorderedObjects=A.unorderedObjects!==!1,f.replacer=A.replacer||void 0,f.excludeKeys=A.excludeKeys||void 0,b===void 0)throw new Error("Object argument required.");for(var g=0;g<m.length;++g)m[g].toLowerCase()===f.algorithm.toLowerCase()&&(f.algorithm=m[g]);if(m.indexOf(f.algorithm)===-1)throw new Error('Algorithm "'+f.algorithm+'"  not supported. supported values: '+m.join(", "));if(M.indexOf(f.encoding)===-1&&f.algorithm!=="passthrough")throw new Error('Encoding "'+f.encoding+'"  not supported. supported values: '+M.join(", "));return f}function E(b){if(typeof b=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(b))!=null}function P(b,A,f){f=f||[];function g(d){return A.update?A.update(d,"utf8"):A.write(d,"utf8")}return{dispatch:function(d){return this["_"+((d=b.replacer?b.replacer(d):d)===null?"null":typeof d)](d)},_object:function(d){var T,I=Object.prototype.toString.call(d),G=/\[object (.*)\]/i.exec(I);if(G=(G=G?G[1]:"unknown:["+I+"]").toLowerCase(),0<=(I=f.indexOf(d)))return this.dispatch("[CIRCULAR:"+I+"]");if(f.push(d),a!==void 0&&a.isBuffer&&a.isBuffer(d))return g("buffer:"),g(d);if(G==="object"||G==="function"||G==="asyncfunction")return I=Object.keys(d),b.unorderedObjects&&(I=I.sort()),b.respectType===!1||E(d)||I.splice(0,0,"prototype","__proto__","constructor"),b.excludeKeys&&(I=I.filter(function(V){return!b.excludeKeys(V)})),g("object:"+I.length+":"),T=this,I.forEach(function(V){T.dispatch(V),g(":"),b.excludeValues||T.dispatch(d[V]),g(",")});if(!this["_"+G]){if(b.ignoreUnknown)return g("["+G+"]");throw new Error('Unknown object type "'+G+'"')}this["_"+G](d)},_array:function(d,V){V=V!==void 0?V:b.unorderedArrays!==!1;var I=this;if(g("array:"+d.length+":"),!V||d.length<=1)return d.forEach(function(U){return I.dispatch(U)});var G=[],V=d.map(function(U){var j=new D,X=f.slice();return P(b,j,X).dispatch(U),G=G.concat(X.slice(f.length)),j.read().toString()});return f=f.concat(G),V.sort(),this._array(V,!1)},_date:function(d){return g("date:"+d.toJSON())},_symbol:function(d){return g("symbol:"+d.toString())},_error:function(d){return g("error:"+d.toString())},_boolean:function(d){return g("bool:"+d.toString())},_string:function(d){g("string:"+d.length+":"),g(d.toString())},_function:function(d){g("fn:"),E(d)?this.dispatch("[native]"):this.dispatch(d.toString()),b.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(d.name)),b.respectFunctionProperties&&this._object(d)},_number:function(d){return g("number:"+d.toString())},_xml:function(d){return g("xml:"+d.toString())},_null:function(){return g("Null")},_undefined:function(){return g("Undefined")},_regexp:function(d){return g("regex:"+d.toString())},_uint8array:function(d){return g("uint8array:"),this.dispatch(Array.prototype.slice.call(d))},_uint8clampedarray:function(d){return g("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(d))},_int8array:function(d){return g("int8array:"),this.dispatch(Array.prototype.slice.call(d))},_uint16array:function(d){return g("uint16array:"),this.dispatch(Array.prototype.slice.call(d))},_int16array:function(d){return g("int16array:"),this.dispatch(Array.prototype.slice.call(d))},_uint32array:function(d){return g("uint32array:"),this.dispatch(Array.prototype.slice.call(d))},_int32array:function(d){return g("int32array:"),this.dispatch(Array.prototype.slice.call(d))},_float32array:function(d){return g("float32array:"),this.dispatch(Array.prototype.slice.call(d))},_float64array:function(d){return g("float64array:"),this.dispatch(Array.prototype.slice.call(d))},_arraybuffer:function(d){return g("arraybuffer:"),this.dispatch(new Uint8Array(d))},_url:function(d){return g("url:"+d.toString())},_map:function(d){return g("map:"),d=Array.from(d),this._array(d,b.unorderedSets!==!1)},_set:function(d){return g("set:"),d=Array.from(d),this._array(d,b.unorderedSets!==!1)},_file:function(d){return g("file:"),this.dispatch([d.name,d.size,d.type,d.lastModfied])},_blob:function(){if(b.ignoreUnknown)return g("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return g("domwindow")},_bigint:function(d){return g("bigint:"+d.toString())},_process:function(){return g("process")},_timer:function(){return g("timer")},_pipe:function(){return g("pipe")},_tcp:function(){return g("tcp")},_udp:function(){return g("udp")},_tty:function(){return g("tty")},_statwatcher:function(){return g("statwatcher")},_securecontext:function(){return g("securecontext")},_connection:function(){return g("connection")},_zlib:function(){return g("zlib")},_context:function(){return g("context")},_nodescript:function(){return g("nodescript")},_httpparser:function(){return g("httpparser")},_dataview:function(){return g("dataview")},_signal:function(){return g("signal")},_fsevent:function(){return g("fsevent")},_tlswrap:function(){return g("tlswrap")}}}function D(){return{buf:"",write:function(b){this.buf+=b},end:function(b){this.buf+=b},read:function(){return this.buf}}}r.writeToStream=function(b,A,f){return f===void 0&&(f=A,A={}),P(A=R(b,A),f).dispatch(b)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(t,n,r){(function(i,s,a,l,c,u,h,v,w){(function(y){var _=typeof Uint8Array<"u"?Uint8Array:Array,m=43,M=47,R=48,E=97,P=65,D=45,b=95;function A(f){return f=f.charCodeAt(0),f===m||f===D?62:f===M||f===b?63:f<R?-1:f<R+10?f-R+26+26:f<P+26?f-P:f<E+26?f-E+26:void 0}y.toByteArray=function(f){var g,d;if(0<f.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var T=f.length,T=f.charAt(T-2)==="="?2:f.charAt(T-1)==="="?1:0,I=new _(3*f.length/4-T),G=0<T?f.length-4:f.length,V=0;function U(j){I[V++]=j}for(g=0;g<G;g+=4,0)U((16711680&(d=A(f.charAt(g))<<18|A(f.charAt(g+1))<<12|A(f.charAt(g+2))<<6|A(f.charAt(g+3))))>>16),U((65280&d)>>8),U(255&d);return T==2?U(255&(d=A(f.charAt(g))<<2|A(f.charAt(g+1))>>4)):T==1&&(U((d=A(f.charAt(g))<<10|A(f.charAt(g+1))<<4|A(f.charAt(g+2))>>2)>>8&255),U(255&d)),I},y.fromByteArray=function(f){var g,d,T,I,G=f.length%3,V="";function U(j){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(j)}for(g=0,T=f.length-G;g<T;g+=3)d=(f[g]<<16)+(f[g+1]<<8)+f[g+2],V+=U((I=d)>>18&63)+U(I>>12&63)+U(I>>6&63)+U(63&I);switch(G){case 1:V=(V+=U((d=f[f.length-1])>>2))+U(d<<4&63)+"==";break;case 2:V=(V=(V+=U((d=(f[f.length-2]<<8)+f[f.length-1])>>10))+U(d>>4&63))+U(d<<2&63)+"="}return V}})(r===void 0?this.base64js={}:r)}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(t,n,r){(function(i,s,m,l,c,u,h,v,w){var y=t("base64-js"),_=t("ieee754");function m(p,x,S){if(!(this instanceof m))return new m(p,x,S);var N,k,z,W,oe=typeof p;if(x==="base64"&&oe=="string")for(p=(W=p).trim?W.trim():W.replace(/^\s+|\s+$/g,"");p.length%4!=0;)p+="=";if(oe=="number")N=Z(p);else if(oe=="string")N=m.byteLength(p,x);else{if(oe!="object")throw new Error("First argument needs to be a number, array or string.");N=Z(p.length)}if(m._useTypedArrays?k=m._augment(new Uint8Array(N)):((k=this).length=N,k._isBuffer=!0),m._useTypedArrays&&typeof p.byteLength=="number")k._set(p);else if(q(W=p)||m.isBuffer(W)||W&&typeof W=="object"&&typeof W.length=="number")for(z=0;z<N;z++)m.isBuffer(p)?k[z]=p.readUInt8(z):k[z]=p[z];else if(oe=="string")k.write(p,0,x);else if(oe=="number"&&!m._useTypedArrays&&!S)for(z=0;z<N;z++)k[z]=0;return k}function M(p,x,S,N){return m._charsWritten=O(function(k){for(var z=[],W=0;W<k.length;W++)z.push(255&k.charCodeAt(W));return z}(x),p,S,N)}function R(p,x,S,N){return m._charsWritten=O(function(k){for(var z,W,oe=[],ue=0;ue<k.length;ue++)W=k.charCodeAt(ue),z=W>>8,W=W%256,oe.push(W),oe.push(z);return oe}(x),p,S,N)}function E(p,x,S){var N="";S=Math.min(p.length,S);for(var k=x;k<S;k++)N+=String.fromCharCode(p[k]);return N}function P(p,x,S,z){z||(B(typeof S=="boolean","missing or invalid endian"),B(x!=null,"missing offset"),B(x+1<p.length,"Trying to read beyond buffer length"));var k,z=p.length;if(!(z<=x))return S?(k=p[x],x+1<z&&(k|=p[x+1]<<8)):(k=p[x]<<8,x+1<z&&(k|=p[x+1])),k}function D(p,x,S,z){z||(B(typeof S=="boolean","missing or invalid endian"),B(x!=null,"missing offset"),B(x+3<p.length,"Trying to read beyond buffer length"));var k,z=p.length;if(!(z<=x))return S?(x+2<z&&(k=p[x+2]<<16),x+1<z&&(k|=p[x+1]<<8),k|=p[x],x+3<z&&(k+=p[x+3]<<24>>>0)):(x+1<z&&(k=p[x+1]<<16),x+2<z&&(k|=p[x+2]<<8),x+3<z&&(k|=p[x+3]),k+=p[x]<<24>>>0),k}function b(p,x,S,N){if(N||(B(typeof S=="boolean","missing or invalid endian"),B(x!=null,"missing offset"),B(x+1<p.length,"Trying to read beyond buffer length")),!(p.length<=x))return N=P(p,x,S,!0),32768&N?-1*(65535-N+1):N}function A(p,x,S,N){if(N||(B(typeof S=="boolean","missing or invalid endian"),B(x!=null,"missing offset"),B(x+3<p.length,"Trying to read beyond buffer length")),!(p.length<=x))return N=D(p,x,S,!0),2147483648&N?-1*(4294967295-N+1):N}function f(p,x,S,N){return N||(B(typeof S=="boolean","missing or invalid endian"),B(x+3<p.length,"Trying to read beyond buffer length")),_.read(p,x,S,23,4)}function g(p,x,S,N){return N||(B(typeof S=="boolean","missing or invalid endian"),B(x+7<p.length,"Trying to read beyond buffer length")),_.read(p,x,S,52,8)}function d(p,x,S,N,k){if(k||(B(x!=null,"missing value"),B(typeof N=="boolean","missing or invalid endian"),B(S!=null,"missing offset"),B(S+1<p.length,"trying to write beyond buffer length"),le(x,65535)),k=p.length,!(k<=S))for(var z=0,W=Math.min(k-S,2);z<W;z++)p[S+z]=(x&255<<8*(N?z:1-z))>>>8*(N?z:1-z)}function T(p,x,S,N,k){if(k||(B(x!=null,"missing value"),B(typeof N=="boolean","missing or invalid endian"),B(S!=null,"missing offset"),B(S+3<p.length,"trying to write beyond buffer length"),le(x,4294967295)),k=p.length,!(k<=S))for(var z=0,W=Math.min(k-S,4);z<W;z++)p[S+z]=x>>>8*(N?z:3-z)&255}function I(p,x,S,N,k){k||(B(x!=null,"missing value"),B(typeof N=="boolean","missing or invalid endian"),B(S!=null,"missing offset"),B(S+1<p.length,"Trying to write beyond buffer length"),be(x,32767,-32768)),p.length<=S||d(p,0<=x?x:65535+x+1,S,N,k)}function G(p,x,S,N,k){k||(B(x!=null,"missing value"),B(typeof N=="boolean","missing or invalid endian"),B(S!=null,"missing offset"),B(S+3<p.length,"Trying to write beyond buffer length"),be(x,2147483647,-2147483648)),p.length<=S||T(p,0<=x?x:4294967295+x+1,S,N,k)}function V(p,x,S,N,k){k||(B(x!=null,"missing value"),B(typeof N=="boolean","missing or invalid endian"),B(S!=null,"missing offset"),B(S+3<p.length,"Trying to write beyond buffer length"),Re(x,34028234663852886e22,-34028234663852886e22)),p.length<=S||_.write(p,x,S,N,23,4)}function U(p,x,S,N,k){k||(B(x!=null,"missing value"),B(typeof N=="boolean","missing or invalid endian"),B(S!=null,"missing offset"),B(S+7<p.length,"Trying to write beyond buffer length"),Re(x,17976931348623157e292,-17976931348623157e292)),p.length<=S||_.write(p,x,S,N,52,8)}r.Buffer=m,r.SlowBuffer=m,r.INSPECT_MAX_BYTES=50,m.poolSize=8192,m._useTypedArrays=function(){try{var p=new ArrayBuffer(0),x=new Uint8Array(p);return x.foo=function(){return 42},x.foo()===42&&typeof x.subarray=="function"}catch{return!1}}(),m.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},m.isBuffer=function(p){return!(p==null||!p._isBuffer)},m.byteLength=function(p,x){var S;switch(p+="",x||"utf8"){case"hex":S=p.length/2;break;case"utf8":case"utf-8":S=te(p).length;break;case"ascii":case"binary":case"raw":S=p.length;break;case"base64":S=pe(p).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":S=2*p.length;break;default:throw new Error("Unknown encoding")}return S},m.concat=function(p,x){if(B(q(p),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),p.length===0)return new m(0);if(p.length===1)return p[0];if(typeof x!="number")for(k=x=0;k<p.length;k++)x+=p[k].length;for(var S=new m(x),N=0,k=0;k<p.length;k++){var z=p[k];z.copy(S,N),N+=z.length}return S},m.prototype.write=function(p,x,S,N){isFinite(x)?isFinite(S)||(N=S,S=void 0):(ue=N,N=x,x=S,S=ue),x=Number(x)||0;var k,z,W,oe,ue=this.length-x;switch((!S||ue<(S=Number(S)))&&(S=ue),N=String(N||"utf8").toLowerCase()){case"hex":k=function(Me,fe,ge,he){ge=Number(ge)||0;var ce=Me.length-ge;(!he||ce<(he=Number(he)))&&(he=ce),B((ce=fe.length)%2==0,"Invalid hex string"),ce/2<he&&(he=ce/2);for(var _e=0;_e<he;_e++){var ft=parseInt(fe.substr(2*_e,2),16);B(!isNaN(ft),"Invalid hex string"),Me[ge+_e]=ft}return m._charsWritten=2*_e,_e}(this,p,x,S);break;case"utf8":case"utf-8":z=this,W=x,oe=S,k=m._charsWritten=O(te(p),z,W,oe);break;case"ascii":case"binary":k=M(this,p,x,S);break;case"base64":z=this,W=x,oe=S,k=m._charsWritten=O(pe(p),z,W,oe);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":k=R(this,p,x,S);break;default:throw new Error("Unknown encoding")}return k},m.prototype.toString=function(p,x,S){var N,k,z,W,oe=this;if(p=String(p||"utf8").toLowerCase(),x=Number(x)||0,(S=S!==void 0?Number(S):oe.length)===x)return"";switch(p){case"hex":N=function(ue,Me,fe){var ge=ue.length;(!Me||Me<0)&&(Me=0),(!fe||fe<0||ge<fe)&&(fe=ge);for(var he="",ce=Me;ce<fe;ce++)he+=Y(ue[ce]);return he}(oe,x,S);break;case"utf8":case"utf-8":N=function(ue,Me,fe){var ge="",he="";fe=Math.min(ue.length,fe);for(var ce=Me;ce<fe;ce++)ue[ce]<=127?(ge+=we(he)+String.fromCharCode(ue[ce]),he=""):he+="%"+ue[ce].toString(16);return ge+we(he)}(oe,x,S);break;case"ascii":case"binary":N=E(oe,x,S);break;case"base64":k=oe,W=S,N=(z=x)===0&&W===k.length?y.fromByteArray(k):y.fromByteArray(k.slice(z,W));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":N=function(ue,Me,fe){for(var ge=ue.slice(Me,fe),he="",ce=0;ce<ge.length;ce+=2)he+=String.fromCharCode(ge[ce]+256*ge[ce+1]);return he}(oe,x,S);break;default:throw new Error("Unknown encoding")}return N},m.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},m.prototype.copy=function(p,x,S,N){if(x=x||0,(N=N||N===0?N:this.length)!==(S=S||0)&&p.length!==0&&this.length!==0){B(S<=N,"sourceEnd < sourceStart"),B(0<=x&&x<p.length,"targetStart out of bounds"),B(0<=S&&S<this.length,"sourceStart out of bounds"),B(0<=N&&N<=this.length,"sourceEnd out of bounds"),N>this.length&&(N=this.length);var k=(N=p.length-x<N-S?p.length-x+S:N)-S;if(k<100||!m._useTypedArrays)for(var z=0;z<k;z++)p[z+x]=this[z+S];else p._set(this.subarray(S,S+k),x)}},m.prototype.slice=function(p,x){var S=this.length;if(p=X(p,S,0),x=X(x,S,S),m._useTypedArrays)return m._augment(this.subarray(p,x));for(var N=x-p,k=new m(N,void 0,!0),z=0;z<N;z++)k[z]=this[z+p];return k},m.prototype.get=function(p){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(p)},m.prototype.set=function(p,x){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(p,x)},m.prototype.readUInt8=function(p,x){if(x||(B(p!=null,"missing offset"),B(p<this.length,"Trying to read beyond buffer length")),!(p>=this.length))return this[p]},m.prototype.readUInt16LE=function(p,x){return P(this,p,!0,x)},m.prototype.readUInt16BE=function(p,x){return P(this,p,!1,x)},m.prototype.readUInt32LE=function(p,x){return D(this,p,!0,x)},m.prototype.readUInt32BE=function(p,x){return D(this,p,!1,x)},m.prototype.readInt8=function(p,x){if(x||(B(p!=null,"missing offset"),B(p<this.length,"Trying to read beyond buffer length")),!(p>=this.length))return 128&this[p]?-1*(255-this[p]+1):this[p]},m.prototype.readInt16LE=function(p,x){return b(this,p,!0,x)},m.prototype.readInt16BE=function(p,x){return b(this,p,!1,x)},m.prototype.readInt32LE=function(p,x){return A(this,p,!0,x)},m.prototype.readInt32BE=function(p,x){return A(this,p,!1,x)},m.prototype.readFloatLE=function(p,x){return f(this,p,!0,x)},m.prototype.readFloatBE=function(p,x){return f(this,p,!1,x)},m.prototype.readDoubleLE=function(p,x){return g(this,p,!0,x)},m.prototype.readDoubleBE=function(p,x){return g(this,p,!1,x)},m.prototype.writeUInt8=function(p,x,S){S||(B(p!=null,"missing value"),B(x!=null,"missing offset"),B(x<this.length,"trying to write beyond buffer length"),le(p,255)),x>=this.length||(this[x]=p)},m.prototype.writeUInt16LE=function(p,x,S){d(this,p,x,!0,S)},m.prototype.writeUInt16BE=function(p,x,S){d(this,p,x,!1,S)},m.prototype.writeUInt32LE=function(p,x,S){T(this,p,x,!0,S)},m.prototype.writeUInt32BE=function(p,x,S){T(this,p,x,!1,S)},m.prototype.writeInt8=function(p,x,S){S||(B(p!=null,"missing value"),B(x!=null,"missing offset"),B(x<this.length,"Trying to write beyond buffer length"),be(p,127,-128)),x>=this.length||(0<=p?this.writeUInt8(p,x,S):this.writeUInt8(255+p+1,x,S))},m.prototype.writeInt16LE=function(p,x,S){I(this,p,x,!0,S)},m.prototype.writeInt16BE=function(p,x,S){I(this,p,x,!1,S)},m.prototype.writeInt32LE=function(p,x,S){G(this,p,x,!0,S)},m.prototype.writeInt32BE=function(p,x,S){G(this,p,x,!1,S)},m.prototype.writeFloatLE=function(p,x,S){V(this,p,x,!0,S)},m.prototype.writeFloatBE=function(p,x,S){V(this,p,x,!1,S)},m.prototype.writeDoubleLE=function(p,x,S){U(this,p,x,!0,S)},m.prototype.writeDoubleBE=function(p,x,S){U(this,p,x,!1,S)},m.prototype.fill=function(p,x,S){if(x=x||0,S=S||this.length,B(typeof(p=typeof(p=p||0)=="string"?p.charCodeAt(0):p)=="number"&&!isNaN(p),"value is not a number"),B(x<=S,"end < start"),S!==x&&this.length!==0){B(0<=x&&x<this.length,"start out of bounds"),B(0<=S&&S<=this.length,"end out of bounds");for(var N=x;N<S;N++)this[N]=p}},m.prototype.inspect=function(){for(var p=[],x=this.length,S=0;S<x;S++)if(p[S]=Y(this[S]),S===r.INSPECT_MAX_BYTES){p[S+1]="...";break}return"<Buffer "+p.join(" ")+">"},m.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(m._useTypedArrays)return new m(this).buffer;for(var p=new Uint8Array(this.length),x=0,S=p.length;x<S;x+=1)p[x]=this[x];return p.buffer};var j=m.prototype;function X(p,x,S){return typeof p!="number"?S:x<=(p=~~p)?x:0<=p||0<=(p+=x)?p:0}function Z(p){return(p=~~Math.ceil(+p))<0?0:p}function q(p){return(Array.isArray||function(x){return Object.prototype.toString.call(x)==="[object Array]"})(p)}function Y(p){return p<16?"0"+p.toString(16):p.toString(16)}function te(p){for(var x=[],S=0;S<p.length;S++){var N=p.charCodeAt(S);if(N<=127)x.push(p.charCodeAt(S));else for(var k=S,z=(55296<=N&&N<=57343&&S++,encodeURIComponent(p.slice(k,S+1)).substr(1).split("%")),W=0;W<z.length;W++)x.push(parseInt(z[W],16))}return x}function pe(p){return y.toByteArray(p)}function O(p,x,S,N){for(var k=0;k<N&&!(k+S>=x.length||k>=p.length);k++)x[k+S]=p[k];return k}function we(p){try{return decodeURIComponent(p)}catch{return""}}function le(p,x){B(typeof p=="number","cannot write a non-number as a number"),B(0<=p,"specified a negative value for writing an unsigned value"),B(p<=x,"value is larger than maximum value for type"),B(Math.floor(p)===p,"value has a fractional component")}function be(p,x,S){B(typeof p=="number","cannot write a non-number as a number"),B(p<=x,"value larger than maximum allowed value"),B(S<=p,"value smaller than minimum allowed value"),B(Math.floor(p)===p,"value has a fractional component")}function Re(p,x,S){B(typeof p=="number","cannot write a non-number as a number"),B(p<=x,"value larger than maximum allowed value"),B(S<=p,"value smaller than minimum allowed value")}function B(p,x){if(!p)throw new Error(x||"Failed assertion")}m._augment=function(p){return p._isBuffer=!0,p._get=p.get,p._set=p.set,p.get=j.get,p.set=j.set,p.write=j.write,p.toString=j.toString,p.toLocaleString=j.toString,p.toJSON=j.toJSON,p.copy=j.copy,p.slice=j.slice,p.readUInt8=j.readUInt8,p.readUInt16LE=j.readUInt16LE,p.readUInt16BE=j.readUInt16BE,p.readUInt32LE=j.readUInt32LE,p.readUInt32BE=j.readUInt32BE,p.readInt8=j.readInt8,p.readInt16LE=j.readInt16LE,p.readInt16BE=j.readInt16BE,p.readInt32LE=j.readInt32LE,p.readInt32BE=j.readInt32BE,p.readFloatLE=j.readFloatLE,p.readFloatBE=j.readFloatBE,p.readDoubleLE=j.readDoubleLE,p.readDoubleBE=j.readDoubleBE,p.writeUInt8=j.writeUInt8,p.writeUInt16LE=j.writeUInt16LE,p.writeUInt16BE=j.writeUInt16BE,p.writeUInt32LE=j.writeUInt32LE,p.writeUInt32BE=j.writeUInt32BE,p.writeInt8=j.writeInt8,p.writeInt16LE=j.writeInt16LE,p.writeInt16BE=j.writeInt16BE,p.writeInt32LE=j.writeInt32LE,p.writeInt32BE=j.writeInt32BE,p.writeFloatLE=j.writeFloatLE,p.writeFloatBE=j.writeFloatBE,p.writeDoubleLE=j.writeDoubleLE,p.writeDoubleBE=j.writeDoubleBE,p.fill=j.fill,p.inspect=j.inspect,p.toArrayBuffer=j.toArrayBuffer,p}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(t,n,r){(function(i,s,y,l,c,u,h,v,w){var y=t("buffer").Buffer,_=4,m=new y(_);m.fill(0),n.exports={hash:function(M,R,E,P){for(var D=R(function(d,T){d.length%_!=0&&(I=d.length+(_-d.length%_),d=y.concat([d,m],I));for(var I,G=[],V=T?d.readInt32BE:d.readInt32LE,U=0;U<d.length;U+=_)G.push(V.call(d,U));return G}(M=y.isBuffer(M)?M:new y(M),P),8*M.length),R=P,b=new y(E),A=R?b.writeInt32BE:b.writeInt32LE,f=0;f<D.length;f++)A.call(b,D[f],4*f,!0);return b}}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(t,n,r){(function(i,s,y,l,c,u,h,v,w){var y=t("buffer").Buffer,_=t("./sha"),m=t("./sha256"),M=t("./rng"),R={sha1:_,sha256:m,md5:t("./md5")},E=64,P=new y(E);function D(d,T){var I=R[d=d||"sha1"],G=[];return I||b("algorithm:",d,"is not yet supported"),{update:function(V){return y.isBuffer(V)||(V=new y(V)),G.push(V),V.length,this},digest:function(V){var U=y.concat(G),U=T?function(j,X,Z){y.isBuffer(X)||(X=new y(X)),y.isBuffer(Z)||(Z=new y(Z)),X.length>E?X=j(X):X.length<E&&(X=y.concat([X,P],E));for(var q=new y(E),Y=new y(E),te=0;te<E;te++)q[te]=54^X[te],Y[te]=92^X[te];return Z=j(y.concat([q,Z])),j(y.concat([Y,Z]))}(I,T,U):I(U);return G=null,V?U.toString(V):U}}}function b(){var d=[].slice.call(arguments).join(" ");throw new Error([d,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}P.fill(0),r.createHash=function(d){return D(d)},r.createHmac=D,r.randomBytes=function(d,T){if(!T||!T.call)return new y(M(d));try{T.call(this,void 0,new y(M(d)))}catch(I){T(I)}};var A,f=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],g=function(d){r[d]=function(){b("sorry,",d,"is not implemented yet")}};for(A in f)g(f[A])}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(t,n,r){(function(i,s,a,l,c,u,h,v,w){var y=t("./helpers");function _(b,A){b[A>>5]|=128<<A%32,b[14+(A+64>>>9<<4)]=A;for(var f=1732584193,g=-271733879,d=-1732584194,T=271733878,I=0;I<b.length;I+=16){var G=f,V=g,U=d,j=T,f=M(f,g,d,T,b[I+0],7,-680876936),T=M(T,f,g,d,b[I+1],12,-389564586),d=M(d,T,f,g,b[I+2],17,606105819),g=M(g,d,T,f,b[I+3],22,-1044525330);f=M(f,g,d,T,b[I+4],7,-176418897),T=M(T,f,g,d,b[I+5],12,1200080426),d=M(d,T,f,g,b[I+6],17,-1473231341),g=M(g,d,T,f,b[I+7],22,-45705983),f=M(f,g,d,T,b[I+8],7,1770035416),T=M(T,f,g,d,b[I+9],12,-1958414417),d=M(d,T,f,g,b[I+10],17,-42063),g=M(g,d,T,f,b[I+11],22,-1990404162),f=M(f,g,d,T,b[I+12],7,1804603682),T=M(T,f,g,d,b[I+13],12,-40341101),d=M(d,T,f,g,b[I+14],17,-1502002290),f=R(f,g=M(g,d,T,f,b[I+15],22,1236535329),d,T,b[I+1],5,-165796510),T=R(T,f,g,d,b[I+6],9,-1069501632),d=R(d,T,f,g,b[I+11],14,643717713),g=R(g,d,T,f,b[I+0],20,-373897302),f=R(f,g,d,T,b[I+5],5,-701558691),T=R(T,f,g,d,b[I+10],9,38016083),d=R(d,T,f,g,b[I+15],14,-660478335),g=R(g,d,T,f,b[I+4],20,-405537848),f=R(f,g,d,T,b[I+9],5,568446438),T=R(T,f,g,d,b[I+14],9,-1019803690),d=R(d,T,f,g,b[I+3],14,-187363961),g=R(g,d,T,f,b[I+8],20,1163531501),f=R(f,g,d,T,b[I+13],5,-1444681467),T=R(T,f,g,d,b[I+2],9,-51403784),d=R(d,T,f,g,b[I+7],14,1735328473),f=E(f,g=R(g,d,T,f,b[I+12],20,-1926607734),d,T,b[I+5],4,-378558),T=E(T,f,g,d,b[I+8],11,-2022574463),d=E(d,T,f,g,b[I+11],16,1839030562),g=E(g,d,T,f,b[I+14],23,-35309556),f=E(f,g,d,T,b[I+1],4,-1530992060),T=E(T,f,g,d,b[I+4],11,1272893353),d=E(d,T,f,g,b[I+7],16,-155497632),g=E(g,d,T,f,b[I+10],23,-1094730640),f=E(f,g,d,T,b[I+13],4,681279174),T=E(T,f,g,d,b[I+0],11,-358537222),d=E(d,T,f,g,b[I+3],16,-722521979),g=E(g,d,T,f,b[I+6],23,76029189),f=E(f,g,d,T,b[I+9],4,-640364487),T=E(T,f,g,d,b[I+12],11,-421815835),d=E(d,T,f,g,b[I+15],16,530742520),f=P(f,g=E(g,d,T,f,b[I+2],23,-995338651),d,T,b[I+0],6,-198630844),T=P(T,f,g,d,b[I+7],10,1126891415),d=P(d,T,f,g,b[I+14],15,-1416354905),g=P(g,d,T,f,b[I+5],21,-57434055),f=P(f,g,d,T,b[I+12],6,1700485571),T=P(T,f,g,d,b[I+3],10,-1894986606),d=P(d,T,f,g,b[I+10],15,-1051523),g=P(g,d,T,f,b[I+1],21,-2054922799),f=P(f,g,d,T,b[I+8],6,1873313359),T=P(T,f,g,d,b[I+15],10,-30611744),d=P(d,T,f,g,b[I+6],15,-1560198380),g=P(g,d,T,f,b[I+13],21,1309151649),f=P(f,g,d,T,b[I+4],6,-145523070),T=P(T,f,g,d,b[I+11],10,-1120210379),d=P(d,T,f,g,b[I+2],15,718787259),g=P(g,d,T,f,b[I+9],21,-343485551),f=D(f,G),g=D(g,V),d=D(d,U),T=D(T,j)}return Array(f,g,d,T)}function m(b,A,f,g,d,T){return D((A=D(D(A,b),D(g,T)))<<d|A>>>32-d,f)}function M(b,A,f,g,d,T,I){return m(A&f|~A&g,b,A,d,T,I)}function R(b,A,f,g,d,T,I){return m(A&g|f&~g,b,A,d,T,I)}function E(b,A,f,g,d,T,I){return m(A^f^g,b,A,d,T,I)}function P(b,A,f,g,d,T,I){return m(f^(A|~g),b,A,d,T,I)}function D(b,A){var f=(65535&b)+(65535&A);return(b>>16)+(A>>16)+(f>>16)<<16|65535&f}n.exports=function(b){return y.hash(b,_,16)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(t,n,r){(function(i,s,a,l,c,u,h,v,w){n.exports=function(y){for(var _,m=new Array(y),M=0;M<y;M++)!(3&M)&&(_=4294967296*Math.random()),m[M]=_>>>((3&M)<<3)&255;return m}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(t,n,r){(function(i,s,a,l,c,u,h,v,w){var y=t("./helpers");function _(R,E){R[E>>5]|=128<<24-E%32,R[15+(E+64>>9<<4)]=E;for(var P,D,b,A=Array(80),f=1732584193,g=-271733879,d=-1732584194,T=271733878,I=-1009589776,G=0;G<R.length;G+=16){for(var V=f,U=g,j=d,X=T,Z=I,q=0;q<80;q++){A[q]=q<16?R[G+q]:M(A[q-3]^A[q-8]^A[q-14]^A[q-16],1);var Y=m(m(M(f,5),(Y=g,D=d,b=T,(P=q)<20?Y&D|~Y&b:!(P<40)&&P<60?Y&D|Y&b|D&b:Y^D^b)),m(m(I,A[q]),(P=q)<20?1518500249:P<40?1859775393:P<60?-1894007588:-899497514)),I=T,T=d,d=M(g,30),g=f,f=Y}f=m(f,V),g=m(g,U),d=m(d,j),T=m(T,X),I=m(I,Z)}return Array(f,g,d,T,I)}function m(R,E){var P=(65535&R)+(65535&E);return(R>>16)+(E>>16)+(P>>16)<<16|65535&P}function M(R,E){return R<<E|R>>>32-E}n.exports=function(R){return y.hash(R,_,20,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(t,n,r){(function(i,s,a,l,c,u,h,v,w){function y(E,P){var D=(65535&E)+(65535&P);return(E>>16)+(P>>16)+(D>>16)<<16|65535&D}function _(E,P){var D,b=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),A=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),f=new Array(64);E[P>>5]|=128<<24-P%32,E[15+(P+64>>9<<4)]=P;for(var g,d,T=0;T<E.length;T+=16){for(var I=A[0],G=A[1],V=A[2],U=A[3],j=A[4],X=A[5],Z=A[6],q=A[7],Y=0;Y<64;Y++)f[Y]=Y<16?E[Y+T]:y(y(y((d=f[Y-2],M(d,17)^M(d,19)^R(d,10)),f[Y-7]),(d=f[Y-15],M(d,7)^M(d,18)^R(d,3))),f[Y-16]),D=y(y(y(y(q,M(d=j,6)^M(d,11)^M(d,25)),j&X^~j&Z),b[Y]),f[Y]),g=y(M(g=I,2)^M(g,13)^M(g,22),I&G^I&V^G&V),q=Z,Z=X,X=j,j=y(U,D),U=V,V=G,G=I,I=y(D,g);A[0]=y(I,A[0]),A[1]=y(G,A[1]),A[2]=y(V,A[2]),A[3]=y(U,A[3]),A[4]=y(j,A[4]),A[5]=y(X,A[5]),A[6]=y(Z,A[6]),A[7]=y(q,A[7])}return A}var m=t("./helpers"),M=function(E,P){return E>>>P|E<<32-P},R=function(E,P){return E>>>P};n.exports=function(E){return m.hash(E,_,32,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(t,n,r){(function(i,s,a,l,c,u,h,v,w){r.read=function(y,_,m,M,T){var E,P,D=8*T-M-1,b=(1<<D)-1,A=b>>1,f=-7,g=m?T-1:0,d=m?-1:1,T=y[_+g];for(g+=d,E=T&(1<<-f)-1,T>>=-f,f+=D;0<f;E=256*E+y[_+g],g+=d,f-=8);for(P=E&(1<<-f)-1,E>>=-f,f+=M;0<f;P=256*P+y[_+g],g+=d,f-=8);if(E===0)E=1-A;else{if(E===b)return P?NaN:1/0*(T?-1:1);P+=Math.pow(2,M),E-=A}return(T?-1:1)*P*Math.pow(2,E-M)},r.write=function(y,_,m,M,R,I){var P,D,b=8*I-R-1,A=(1<<b)-1,f=A>>1,g=R===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=M?0:I-1,T=M?1:-1,I=_<0||_===0&&1/_<0?1:0;for(_=Math.abs(_),isNaN(_)||_===1/0?(D=isNaN(_)?1:0,P=A):(P=Math.floor(Math.log(_)/Math.LN2),_*(M=Math.pow(2,-P))<1&&(P--,M*=2),2<=(_+=1<=P+f?g/M:g*Math.pow(2,1-f))*M&&(P++,M/=2),A<=P+f?(D=0,P=A):1<=P+f?(D=(_*M-1)*Math.pow(2,R),P+=f):(D=_*Math.pow(2,f-1)*Math.pow(2,R),P=0));8<=R;y[m+d]=255&D,d+=T,D/=256,R-=8);for(P=P<<R|D,b+=R;0<b;y[m+d]=255&P,d+=T,P/=256,b-=8);y[m+d-T]|=128*I}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(t,n,r){(function(i,s,a,l,c,u,h,v,w){var y,_,m;function M(){}(i=n.exports={}).nextTick=(_=typeof window<"u"&&window.setImmediate,m=typeof window<"u"&&window.postMessage&&window.addEventListener,_?function(R){return window.setImmediate(R)}:m?(y=[],window.addEventListener("message",function(R){var E=R.source;E!==window&&E!==null||R.data!=="process-tick"||(R.stopPropagation(),0<y.length&&y.shift()())},!0),function(R){y.push(R),window.postMessage("process-tick","*")}):function(R){setTimeout(R,0)}),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=M,i.addListener=M,i.once=M,i.off=M,i.removeListener=M,i.removeAllListeners=M,i.emit=M,i.binding=function(R){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(R){throw new Error("process.chdir is not supported")}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(xi);var xa=xi.exports;const Ma=un(xa);var Mi=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"],Ea=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"],Ei=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],_a=Mi,Ta=_a.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"]),zn=Ei;zn=zn.slice().filter(function(o){return!/^(gl\_|texture)/.test(o)});var Aa=zn.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]),Sa=ja,Ia=Mi,Or=Ea,Pa=Ei,Ra=Ta,Ca=Aa,Ne=999,Lr=9999,On=0,Ln=1,Dr=2,kr=3,Nr=4,qt=5,Oa=6,La=7,Da=8,jr=9,ka=10,Ur=11,Na=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function ja(o){var e=0,t=0,n=Ne,r,i,s=[],a=[],l=1,c=0,u=0,h=!1,v=!1,w="",y;o=o||{};var _=Pa,m=Ia;o.version==="300 es"&&(_=Ca,m=Ra);for(var M={},R={},e=0;e<_.length;e++)M[_[e]]=!0;for(var e=0;e<m.length;e++)R[m[e]]=!0;return function(X){return a=[],X!==null?P(X):D()};function E(X){X.length&&a.push({type:Na[n],data:X,position:u,line:l,column:c})}function P(X){e=0,X.toString&&(X=X.toString()),w+=X.replace(/\r\n/g,`
`),y=w.length;for(var Z;r=w[e],e<y;){switch(Z=e,n){case On:e=d();break;case Ln:e=g();break;case Dr:e=f();break;case kr:e=T();break;case Nr:e=V();break;case Ur:e=G();break;case qt:e=U();break;case Lr:e=j();break;case jr:e=A();break;case Ne:e=b();break}if(Z!==e)switch(w[Z]){case`
`:c=0,++l;break;default:++c;break}}return t+=e,w=w.slice(e),a}function D(X){return s.length&&E(s.join("")),n=ka,E("(eof)"),a}function b(){return s=s.length?[]:s,i==="/"&&r==="*"?(u=t+e-1,n=On,i=r,e+1):i==="/"&&r==="/"?(u=t+e-1,n=Ln,i=r,e+1):r==="#"?(n=Dr,u=t+e,e):/\s/.test(r)?(n=jr,u=t+e,e):(h=/\d/.test(r),v=/[^\w_]/.test(r),u=t+e,n=h?Nr:v?kr:Lr,e)}function A(){return/[^\s]/g.test(r)?(E(s.join("")),n=Ne,e):(s.push(r),i=r,e+1)}function f(){return(r==="\r"||r===`
`)&&i!=="\\"?(E(s.join("")),n=Ne,e):(s.push(r),i=r,e+1)}function g(){return f()}function d(){return r==="/"&&i==="*"?(s.push(r),E(s.join("")),n=Ne,e+1):(s.push(r),i=r,e+1)}function T(){if(i==="."&&/\d/.test(r))return n=qt,e;if(i==="/"&&r==="*")return n=On,e;if(i==="/"&&r==="/")return n=Ln,e;if(r==="."&&s.length){for(;I(s););return n=qt,e}if(r===";"||r===")"||r==="("){if(s.length)for(;I(s););return E(r),n=Ne,e+1}var X=s.length===2&&r!=="=";if(/[\w_\d\s]/.test(r)||X){for(;I(s););return n=Ne,e}return s.push(r),i=r,e+1}function I(X){var Z=0,q,Y;do{if(q=Or.indexOf(X.slice(0,X.length+Z).join("")),Y=Or[q],q===-1){if(Z--+X.length>0)continue;Y=X.slice(0,1).join("")}return E(Y),u+=Y.length,s=s.slice(Y.length),s.length}while(!0)}function G(){return/[^a-fA-F0-9]/.test(r)?(E(s.join("")),n=Ne,e):(s.push(r),i=r,e+1)}function V(){return r==="."||/[eE]/.test(r)?(s.push(r),n=qt,i=r,e+1):r==="x"&&s.length===1&&s[0]==="0"?(n=Ur,s.push(r),i=r,e+1):/[^\d]/.test(r)?(E(s.join("")),n=Ne,e):(s.push(r),i=r,e+1)}function U(){return r==="f"&&(s.push(r),i=r,e+=1),/[eE]/.test(r)||(r==="-"||r==="+")&&/[eE]/.test(i)?(s.push(r),i=r,e+1):/[^\d]/.test(r)?(E(s.join("")),n=Ne,e):(s.push(r),i=r,e+1)}function j(){if(/[^\d\w_]/.test(r)){var X=s.join("");return R[X]?n=Da:M[X]?n=La:n=Oa,E(s.join("")),n=Ne,e}return s.push(r),i=r,e+1}}var Ua=Sa,Fa=Ba;function Ba(o,e){var t=Ua(e),n=[];return n=n.concat(t(o)),n=n.concat(t(null)),n}const za=un(Fa);var Ha=Va;function Va(o){for(var e=[],t=0;t<o.length;t++)o[t].type!=="eof"&&e.push(o[t].data);return e.join("")}const Fr=un(Ha);var Ga=Ya;function Ya(o){var e=null,t=null,n=0,r=0,i=0,s=0,a=0,l=[],c,u,h;for(c=0,u;c<o.length;c++)if(h=o[c],h.data==="{"){if(n&&n++||(u=w(c,$e(")"),$e()),u<0)||(s=u,u=w(u,$e("("),$e(")")),u<0)||(a=u,u=w(u,Pt),u<0)||o[u].type!=="ident"||(t=o[u].data,u=w(u,Pt),u<0))continue;n=1,r=c,e=o[u].data,i=u;var v=w(u,Pt);switch(o[v]&&o[v].data){case"lowp":case"highp":case"mediump":i=v}}else if(n&&h.data==="}"){if(--n)continue;l.push({name:t,type:e,body:[r+1,c],args:[a,s+1],outer:[i,c+1]})}for(c=0;c<o.length;c++)if(h=o[c],h.data===";"){if(u=w(c,$e(")"),$e()),u<0||(s=u,u=w(u,$e("("),$e(")")),u<0)||(a=u,u=w(u,Pt),u<0)||o[u].type!=="ident"||(t=o[u].data,u=w(u,Pt),u<0)||o[u].type==="operator"||o[u].data==="return")continue;e=o[u].data,l.push({name:t,type:e,body:!1,args:[a,s+1],outer:[u,c+1]})}return l.sort(function(y,_){return y.outer[0]-_.outer[0]});function w(y,_,m){for(var M=y-1;M>=0;M--){if(_(o[M]))return M;if(m&&m(o[M]))return-1}return-1}}function $e(o){return function(e){return e.type==="operator"&&(!o||e.data===o)}}function Pt(o){return o.type!=="whitespace"}const Xa=un(Ga);function Ka(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function _i(o){var e=Ka(o,"string");return typeof e=="symbol"?e:String(e)}function ae(o,e,t){return e=_i(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Br(o,e){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(o);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(o,r).enumerable})),t.push.apply(t,n)}return t}function vt(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Br(Object(t),!0).forEach(function(n){ae(o,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):Br(Object(t)).forEach(function(n){Object.defineProperty(o,n,Object.getOwnPropertyDescriptor(t,n))})}return o}function Za(o,e){if(o==null)return{};var t={},n=Object.keys(o),r,i;for(i=0;i<n.length;i++)r=n[i],!(e.indexOf(r)>=0)&&(t[r]=o[r]);return t}function Qa(o,e){if(o==null)return{};var t=Za(o,e),n,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);for(r=0;r<i.length;r++)n=i[r],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(o,n)&&(t[n]=o[n])}return t}function qa(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")}function Wa(o,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(o,_i(n.key),n)}}function $a(o,e,t){return e&&Wa(o.prototype,e),Object.defineProperty(o,"prototype",{writable:!1}),o}function Ti(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function Hn(o,e){return Hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Hn(o,e)}function Ja(o,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&Hn(o,e)}function an(o){return an=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},an(o)}function el(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tl(o,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ti(o)}function nl(o){var e=el();return function(){var t=an(o),n;if(e){var r=an(this).constructor;n=Reflect.construct(t,arguments,r)}else n=t.apply(this,arguments);return tl(this,n)}}var ee={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},Te,wt,rl=(Te={},ae(Te,"".concat(ee.normal),{"#include <beginnormal_vertex>":`
    vec3 objectNormal = `.concat(ee.normal,`;
    #ifdef USE_TANGENT
	    vec3 objectTangent = vec3( tangent.xyz );
    #endif
    `)}),ae(Te,"".concat(ee.position),{"#include <begin_vertex>":`
    vec3 transformed = `.concat(ee.position,`;
  `)}),ae(Te,"".concat(ee.positionRaw),{"#include <begin_vertex>":`
    vec4 csm_internal_positionUnprojected = `.concat(ee.positionRaw,`;
    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;
    #ifdef USE_INSTANCING
      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;
    #endif
    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;
    vec3 transformed = csm_internal_positionUnprojected.xyz;
  `)}),ae(Te,"".concat(ee.pointSize),{"gl_PointSize = size;":`
    gl_PointSize = `.concat(ee.pointSize,`;
    `)}),ae(Te,"".concat(ee.diffuseColor),{"#include <color_fragment>":`
    #include <color_fragment>
    diffuseColor = `.concat(ee.diffuseColor,`;
  `)}),ae(Te,"".concat(ee.fragColor),{"#include <dithering_fragment>":`
    #include <dithering_fragment>
    gl_FragColor  = `.concat(ee.fragColor,`;
  `)}),ae(Te,"".concat(ee.emissive),{"vec3 totalEmissiveRadiance = emissive;":`
    vec3 totalEmissiveRadiance = `.concat(ee.emissive,`;
    `)}),ae(Te,"".concat(ee.roughness),{"#include <roughnessmap_fragment>":`
    #include <roughnessmap_fragment>
    roughnessFactor = `.concat(ee.roughness,`;
    `)}),ae(Te,"".concat(ee.metalness),{"#include <metalnessmap_fragment>":`
    #include <metalnessmap_fragment>
    metalnessFactor = `.concat(ee.metalness,`;
    `)}),ae(Te,"".concat(ee.ao),{"#include <aomap_fragment>":`
    #include <aomap_fragment>
    reflectedLight.indirectDiffuse *= 1. - `.concat(ee.ao,`;
    `)}),ae(Te,"".concat(ee.bump),{"#include <normal_fragment_maps>":`
    #include <normal_fragment_maps>

    vec3 csm_internal_orthogonal = `.concat(ee.bump," - (dot(").concat(ee.bump,`, normal) * normal);
    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;
    normal = normalize(normal - csm_internal_projectedbump);
    `)}),ae(Te,"".concat(ee.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":`
      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * `.concat(ee.depthAlpha,` );
    `),"gl_FragColor = packDepthToRGBA( fragCoordZ );":`
      gl_FragColor = packDepthToRGBA( fragCoordZ );
      gl_FragColor.a *= `.concat(ee.depthAlpha,`;
    `)}),Te),il=(wt={},ae(wt,"".concat(ee.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = projectionMatrix * modelViewMatrix * vec4( `.concat(ee.position,`, 1.0 );
  `)}),ae(wt,"".concat(ee.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = `.concat(ee.position,`;
  `)}),ae(wt,"".concat(ee.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(ee.diffuseColor,`;
  `)}),ae(wt,"".concat(ee.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(ee.fragColor,`;
  `)}),wt),sl=`

#ifdef IS_VERTEX
    // csm_Position & csm_PositionRaw
    #ifdef IS_UNKNOWN
        vec3 csm_Position = vec3(0.0);
        vec4 csm_PositionRaw = vec4(0.0);
        vec3 csm_Normal = vec3(0.0);
    #else
        vec3 csm_Position = position;
        vec4 csm_PositionRaw = projectionMatrix * modelViewMatrix * vec4(position, 1.);
        vec3 csm_Normal = normal;
    #endif

    // csm_PointSize
    #ifdef IS_POINTSMATERIAL
        float csm_PointSize = size;
    #endif
#else
    // csm_DiffuseColor & csm_FragColor
    #if defined IS_UNKNOWN || defined IS_SHADERMATERIAL || defined IS_MESHDEPTHMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_SHADOWMATERIAL
        vec4 csm_DiffuseColor = vec4(1.0, 0.0, 1.0, 1.0);
        vec4 csm_FragColor = vec4(1.0, 0.0, 1.0, 1.0);
    #else
        #ifdef USE_MAP
            vec4 _csm_sampledDiffuseColor = texture2D(map, vMapUv);

            #ifdef DECODE_VIDEO_TEXTURE
            // inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)
            _csm_sampledDiffuseColor = vec4(mix(pow(_csm_sampledDiffuseColor.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), _csm_sampledDiffuseColor.rgb * 0.0773993808, vec3(lessThanEqual(_csm_sampledDiffuseColor.rgb, vec3(0.04045)))), _csm_sampledDiffuseColor.w);
            #endif

            vec4 csm_DiffuseColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;
            vec4 csm_FragColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;
        #else
            vec4 csm_DiffuseColor = vec4(diffuse, opacity);
            vec4 csm_FragColor = vec4(diffuse, opacity);
        #endif
    #endif

    // csm_Emissive, csm_Roughness, csm_Metalness
    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL
        vec3 csm_Emissive = emissive;
        float csm_Roughness = roughness;
        float csm_Metalness = metalness;
    #endif

    // csm_AO
    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHBASICMATERIAL || defined IS_MESHLAMBERTMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHTOONMATERIAL
        float csm_AO = 0.0;
    #endif

    // csm_Bump
    #if defined IS_MESHLAMBERTMATERIAL || defined IS_MESHMATCAPMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHSTANDARDMATERIAL || defined IS_MESHTOONMATERIAL || defined IS_SHADOWMATERIAL 
        vec3 csm_Bump = vec3(0.0);
    #endif

    float csm_DepthAlpha = 1.0;
#endif
`,ol=`
    varying mat4 csm_internal_vModelViewMatrix;
`,al=`
    csm_internal_vModelViewMatrix = modelViewMatrix;
`,ll=`
    varying mat4 csm_internal_vModelViewMatrix;
`,cl=`
    
`,Ae,ul=(Ae={},ae(Ae,"".concat(ee.position),"*"),ae(Ae,"".concat(ee.positionRaw),"*"),ae(Ae,"".concat(ee.normal),"*"),ae(Ae,"".concat(ee.pointSize),["PointsMaterial"]),ae(Ae,"".concat(ee.diffuseColor),"*"),ae(Ae,"".concat(ee.fragColor),"*"),ae(Ae,"".concat(ee.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),ae(Ae,"".concat(ee.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),ae(Ae,"".concat(ee.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),ae(Ae,"".concat(ee.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),ae(Ae,"".concat(ee.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),ae(Ae,"".concat(ee.depthAlpha),"*"),Ae),hl=["baseMaterial","fragmentShader","vertexShader","uniforms","patchMap","cacheKey","silent"],dl=function(o,e,t){return o.split(e).join(t)},pl=function(o){return o.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},fl=function(o,e){return new RegExp("\\b".concat(pl(e),"\\b")).test(o)};function ml(o){try{new o}catch(e){if(e.message.indexOf("is not a constructor")>=0)return!1}return!0}function gl(o,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Object.assign(o,e);var n=Object.getPrototypeOf(e);Object.entries(Object.getOwnPropertyDescriptors(n)).filter(function(r){var i=typeof r[1].get=="function",s=typeof r[1].set=="function",a=typeof r[1].value=="function",l=r[0]==="constructor";return(i||s||a)&&!l}).forEach(function(r){if(typeof o[r[0]]=="function"){t||console.warn("Function ".concat(r[0]," already exists on CSM, renaming to base_").concat(r[0]));var i="base_".concat(r[0]);o[i]=r[1].value.bind(o);return}Object.defineProperty(o,r[0],r[1])})}function yl(o){var e=o.toString().trim(),t=e.substring(e.indexOf("{")+1,e.lastIndexOf("}"));return t.trim().length===0}function zr(o){return o.replace(/\s/g,"")}function vl(o,e,t){var n=o.lastIndexOf(e);return n===-1?o:o.substring(0,n)+t+o.substring(n+e.length)}var wl=function(o){Ja(t,o);var e=nl(t);function t(n){var r,i=n.baseMaterial,s=n.fragmentShader,a=n.vertexShader,l=n.uniforms,c=n.patchMap,u=n.cacheKey,h=n.silent,v=Qa(n,hl);qa(this,t);var w;if(ml(i)?w=new i(v):(w=i,Object.assign(w,v)),w.type==="RawShaderMaterial")throw new Error("CustomShaderMaterial does not support RawShaderMaterial");r=e.call(this),gl(Ti(r),w,h),r.__csm={patchMap:c||{},fragmentShader:s||"",vertexShader:a||"",cacheKey:u,baseMaterial:i,instanceID:dt.generateUUID(),type:w.type,isAlreadyExtended:!yl(w.onBeforeCompile),cacheHash:"",silent:h},r.uniforms=vt(vt({},r.uniforms||{}),l||{});{var y=r.__csm,_=y.fragmentShader,m=y.vertexShader,M=r.uniforms;r.__csm.cacheHash=r.getCacheHash(),r.generateMaterial(_,m,M)}return r}return $a(t,[{key:"update",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.uniforms=n.uniforms||this.uniforms,Object.assign(this.__csm,n);var r=this.__csm,i=r.fragmentShader,s=r.vertexShader,a=this.uniforms,l=this.getCacheHash();this.__csm.cacheHash=l,this.generateMaterial(i,s,a)}},{key:"clone",value:function(){var n={baseMaterial:this.__csm.baseMaterial,fragmentShader:this.__csm.fragmentShader,vertexShader:this.__csm.vertexShader,uniforms:this.uniforms,silent:this.__csm.silent,patchMap:this.__csm.patchMap,cacheKey:this.__csm.cacheKey},r=new this.constructor(n);return Object.assign(this,r),r}},{key:"getCacheHash",value:function(){var n=this.__csm,r=n.fragmentShader,i=n.vertexShader,s=this.uniforms,a=Object.values(s).reduce(function(c,u){var h=u.value;return c+JSON.stringify(h)},""),l=zr(r)+zr(i)+a;return l.trim().length>0?Ma(l):this.customProgramCacheKey()}},{key:"generateMaterial",value:function(n,r,i){var s=this,a=this.parseShader(n),l=this.parseShader(r);this.uniforms=i||{},this.customProgramCacheKey=function(){return s.__csm.cacheHash};var c=function(h){try{if(a){var v=s.patchShader(a,h.fragmentShader,!0);h.fragmentShader=s.getMaterialDefine()+v}if(l){var w=s.patchShader(l,h.vertexShader);h.vertexShader=`#define IS_VERTEX;
`+w,h.vertexShader=s.getMaterialDefine()+h.vertexShader}h.uniforms=vt(vt({},h.uniforms),s.uniforms),s.uniforms=h.uniforms}catch(y){console.error(y)}};if(this.__csm.isAlreadyExtended){var u=this.onBeforeCompile;this.onBeforeCompile=function(h,v){u(h,v),c(h)}}else this.onBeforeCompile=c;this.needsUpdate=!0}},{key:"patchShader",value:function(n,r,i){var s=this,a=r,l=vt(vt({},this.getPatchMapForMaterial()),this.__csm.patchMap);Object.keys(l).forEach(function(h){Object.keys(l[h]).forEach(function(v){var w=ul[h],y=s.__csm.type;if(h==="*"||fl(n.main,h))if(!w||Array.isArray(w)&&w.includes(y)||w==="*")a=dl(a,v,l[h][v]);else throw new Error("CSM: ".concat(h," is not available in ").concat(y,". Shader cannot compile."))})}),a=a.replace("void main() {",`
        #ifndef CSM_IS_HEAD_DEFAULTS_DEFINED
          `.concat(i?ll:ol,`
          #define CSM_IS_HEAD_DEFAULTS_DEFINED 1
        #endif

        `).concat(n.header,`
        
        void main() {
          #ifndef CSM_IS_DEFAULTS_DEFINED
            `).concat(sl,`
            #define CSM_IS_DEFAULTS_DEFINED 1
          #endif
          
          #ifndef CSM_IS_MAIN_DEFAULTS_DEFINED
            `).concat(i?cl:al,`
            #define CSM_IS_MAIN_DEFAULTS_DEFINED 1
          #endif

          // CSM_START
      `));var c=this.__csm.isAlreadyExtended,u=a.includes("// CSM_END");return c&&u?a=vl(a,"// CSM_END",`
          // CSM_END
          `.concat(n.main,`
          // CSM_END
        `)):a=a.replace("// CSM_START",`
        // CSM_START
        `.concat(n.main,`
        // CSM_END
          `)),a=n.defines+a,a}},{key:"parseShader",value:function(n){if(n){var r=n.replace(/\/\*\*(.*?)\*\/|\/\/(.*?)\n/gm,""),i=za(r),s=Xa(i),a=s.map(function(u){return u.name}).indexOf("main"),l=Fr(i.slice(0,a>=0?s[a].outer[0]:void 0)),c=a>=0?this.getShaderFromIndex(i,s[a].body):"";return{defines:"",header:l,main:c}}}},{key:"getMaterialDefine",value:function(){var n=this.__csm.type;return n?"#define IS_".concat(n.toUpperCase(),`;
`):`#define IS_UNKNOWN;
`}},{key:"getPatchMapForMaterial",value:function(){switch(this.__csm.type){case"ShaderMaterial":return il;default:return rl}}},{key:"getShaderFromIndex",value:function(n,r){return Fr(n.slice(r[0],r[1]))}}]),t}($t);const bl=["args"],Gl=st({__name:"index",props:{baseMaterial:{},vertexShader:{},fragmentShader:{},silent:{type:Boolean},uniforms:{}},setup(o,{expose:e}){const t=o,n=kt(null),{extend:r,invalidate:i}=pt();return r({CustomShaderMaterial:wl}),Ke(t,()=>i()),e({instance:n}),(s,a)=>(Ie(),Oe("TresCustomShaderMaterial",{ref_key:"customShaderMaterialClass",ref:n,args:[t]},null,8,bl))}}),xl=["args"],Ml=["color"],Yl=st({__name:"Box",props:{args:{default:()=>[1,1,1]},color:{default:"#ffffff"}},setup(o,{expose:e}){const t=o,{invalidate:n}=pt(),{args:r,color:i}=Nt(t);Ke(r,()=>n());const s=kt();return e({instance:s}),(a,l)=>(Ie(),Oe("TresMesh",Oi({ref_key:"boxRef",ref:s},a.$attrs),[en("TresBoxGeometry",{args:Q(r)},null,8,xl),Gr(a.$slots,"default",{},()=>[en("TresMeshBasicMaterial",{color:Q(i)},null,8,Ml)])],16))}});new Zn;new F;Wt.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new ve(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Li.line={uniforms:Gn.merge([Wt.common,Wt.fog,Wt.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};new it;new F;new F;new it;new it;new it;new F;new Ue;new Di;new F;new Zn;new Kr;new it;const El={key:0,args:[0,1,64]},_l={key:1,args:[.5,1,64]},Tl={key:2},Al=["tone-mapped","map","side","color"];new xe(16777215);var Sl={exports:{}};(function(o,e){(function(t,n){o.exports=n()})(ba,function(){var t=function(){function n(w){return s.appendChild(w.dom),w}function r(w){for(var y=0;y<s.children.length;y++)s.children[y].style.display=y===w?"block":"none";i=w}var i=0,s=document.createElement("div");s.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",s.addEventListener("click",function(w){w.preventDefault(),r(++i%s.children.length)},!1);var a=(performance||Date).now(),l=a,c=0,u=n(new t.Panel("FPS","#0ff","#002")),h=n(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var v=n(new t.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:s,addPanel:n,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){c++;var w=(performance||Date).now();if(h.update(w-a,200),w>l+1e3&&(u.update(1e3*c/(w-l),100),l=w,c=0,v)){var y=performance.memory;v.update(y.usedJSHeapSize/1048576,y.jsHeapSizeLimit/1048576)}return w},update:function(){a=this.end()},domElement:s,setMode:r}};return t.Panel=function(n,r,i){var s=1/0,a=0,l=Math.round,c=l(window.devicePixelRatio||1),u=80*c,h=48*c,v=3*c,w=2*c,y=3*c,_=15*c,m=74*c,M=30*c,R=document.createElement("canvas");R.width=u,R.height=h,R.style.cssText="width:80px;height:48px";var E=R.getContext("2d");return E.font="bold "+9*c+"px Helvetica,Arial,sans-serif",E.textBaseline="top",E.fillStyle=i,E.fillRect(0,0,u,h),E.fillStyle=r,E.fillText(n,v,w),E.fillRect(y,_,m,M),E.fillStyle=i,E.globalAlpha=.9,E.fillRect(y,_,m,M),{dom:R,update:function(P,D){s=Math.min(s,P),a=Math.max(a,P),E.fillStyle=i,E.globalAlpha=1,E.fillRect(0,0,u,_),E.fillStyle=r,E.fillText(l(P)+" "+n+" ("+l(s)+"-"+l(a)+")",v,w),E.drawImage(R,y+c,_,m-c,M,y,_,m-c,M),E.fillRect(y+m-c,_,c,M),E.fillStyle=i,E.globalAlpha=.9,E.fillRect(y+m-c,_,c,l((1-P/D)*M))}}},t})})(Sl);var Il=`#include <common>

void main() {
  vec2 center = vec2(0., 1.);
  float rotation = 0.0;

  
  
  float size = 0.03;

  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

  bool isPerspective = isPerspectiveMatrix( projectionMatrix );
  if ( isPerspective ) scale *= - mvPosition.z;

  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
  mvPosition.xy += rotatedPosition;

  gl_Position = projectionMatrix * mvPosition;
}`,Pl=`void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
}`;const Ft=new F(0,0,0),rr=new F(0,0,0),Rl=new F(0,0,0);function Hr(o,e,t){const n=Ft.setFromMatrixPosition(o.matrixWorld);n.project(e);const r=t.width/2,i=t.height/2;return[(Number.isNaN(n.x)?0:n.x)*r+r,-(n.y*i)+i]}function Cl(o,e){const t=Ft.setFromMatrixPosition(o.matrixWorld),n=rr.setFromMatrixPosition(e.matrixWorld),r=t.sub(n),i=e.getWorldDirection(Rl);return r.angleTo(i)>Math.PI/2}function Ol(o,e,t,n){const r=Ft.setFromMatrixPosition(o.matrixWorld),i=r.clone();i.project(e),t.setFromCamera(new ve(i.x,i.y),e);const s=t.intersectObjects(n,!0);if(s.length>0){const a=s[0].distance;return r.distanceTo(t.ray.origin)<a}return!0}function Ll(o,e){if(e instanceof ut)return e.zoom;if(e instanceof Ye){const t=Ft.setFromMatrixPosition(o.matrixWorld),n=rr.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,i=t.distanceTo(n);return 1/(2*Math.tan(r/2)*i)}else return 1}function Dl(o,e,t){if(e instanceof Ye||e instanceof ut){const n=Ft.setFromMatrixPosition(o.matrixWorld),r=rr.setFromMatrixPosition(e.matrixWorld),i=n.distanceTo(r),s=(t[1]-t[0])/(e.far-e.near),a=t[1]-s*e.far;return Math.round(s*i+a)}}const Vn=o=>Math.abs(o)<1e-10?0:o;function Ai(o,e,t=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=Vn(e[r]*o.elements[r])+(r!==15?",":")");return t+n}const kl=(o=>e=>Ai(e,o))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Nl=(o=>(e,t)=>Ai(e,o(t),"translate(-50%,-50%)"))(o=>[1/o,1/o,1/o,1,-1/o,-1/o,-1/o,-1,1/o,1/o,1/o,1,1,1,1,1]),jl=["geometry","material"],Xl=st({__name:"HTML",props:{geometry:{default:new Ge},material:{},as:{default:"div"},transform:{type:Boolean,default:!1},portal:{},wrapperClass:{},eps:{default:1e-4},distanceFactor:{},fullscreen:{type:Boolean},center:{type:Boolean},pointerEvents:{default:"auto"},sprite:{type:Boolean,default:!1},zIndexRange:{default:()=>[16777271,0]},occlude:{type:[Object,null,Array,Boolean,String]}},emits:["onOcclude"],setup(o,{expose:e,emit:t}){const n=o,r=t,i=Ni(),s=ji(),a=je(),l=je(),{geometry:c,material:u,as:h,transform:v,portal:w,wrapperClass:y,eps:_,distanceFactor:m,fullscreen:M,center:R,pointerEvents:E,sprite:P,occlude:D,zIndexRange:b}=Nt(n),{renderer:A,scene:f,camera:g,raycaster:d,sizes:T}=pt(),I=mt(()=>document.createElement(h.value)),G=je([0,0]),V=je(0),U=je(),j=mt(()=>v.value?{position:"absolute",top:0,left:0,width:`${T.width.value}px`,height:`${T.height.value}px`,transformStyle:"preserve-3d",pointerEvents:"none",zIndex:2,willChange:"transform"}:{position:"absolute",transform:R.value?"translate3d(-50%,-50%,0)":"none",...M.value&&{top:-T.height.value/2,left:-T.width.value/2,width:`${T.width.value}px`,height:`${T.height.value}px`},zIndex:2,...Object.assign({},s.style),willChange:"transform"}),X=mt(()=>({position:"absolute",pointerEvents:E.value})),Z=je(null),q=je(!1),Y=mt(()=>(D==null?void 0:D.value)&&(D==null?void 0:D.value)!=="blending"||Array.isArray(D==null?void 0:D.value)&&(D==null?void 0:D.value.length)&&Yi(D.value[0]));Ke(()=>D,({value:le})=>{le==="blending"?(I.value.style.zIndex=`${Math.floor(b.value[0]/2)}`,I.value.style.position="absolute",I.value.style.pointerEvents="none"):(I.value.style.zIndex=null,I.value.style.position=null,I.value.style.pointerEvents=null)}),Ke(()=>{var le;return[a.value,A.value,T.width.value,T.height.value,(le=i.default)==null?void 0:le.call(i)]},([le,be])=>{var Re,B,p,x,S,N;if(le&&be){const k=(w==null?void 0:w.value)||be.domElement;if((Re=f.value)==null||Re.updateMatrixWorld(),v.value)I.value.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const z=Hr(le,g.value,{width:T.width.value,height:T.height.value});I.value.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${z[0]}px,${z[1]}px,0);transform-origin:0 0;`}k&&!I.value.parentNode&&((B=k.parentNode)==null||B.appendChild(I.value)),v.value?U.value=Vt("div",{id:"outer",style:j.value},[Vt("div",{id:"inner",style:X.value},[Vt("div",{key:(p=l.value)==null?void 0:p.uuid,id:f==null?void 0:f.value.uuid,class:s.class,style:s.style},(x=i.default)==null?void 0:x.call(i))])]):U.value=Vt("div",{key:(S=l.value)==null?void 0:S.uuid,id:f==null?void 0:f.value.uuid,style:j.value},(N=i.default)==null?void 0:N.call(i)),Ui(U.value,I.value)}}),Zr(()=>{y!=null&&y.value&&(I.value.className=y.value)});const te=je(!0),{onBeforeRender:pe}=Xr();pe(({invalidate:le})=>{var be,Re,B,p,x,S,N;if(le(),a.value&&g.value&&A.value){(be=g.value)==null||be.updateMatrixWorld(),a.value.updateWorldMatrix(!0,!1);const k=v.value?G.value:Hr(a.value,g.value,{width:T.width.value||0,height:T.height.value||0});if(v.value||Math.abs(V.value-g.value.zoom)>_.value||Math.abs(G.value[0]-k[0])>_.value||Math.abs(G.value[1]-k[1])>_.value){const z=Cl(a.value,g.value);let W=!1;Y.value&&(Array.isArray(D==null?void 0:D.value)?W=D==null?void 0:D.value:(D==null?void 0:D.value)!=="blending"&&(W=[f.value]));const oe=te.value;if(W){const fe=Ol(a.value,g.value,d.value,W);te.value=fe&&!z}else te.value=!z;oe!==te.value&&(r("onOcclude",!te.value),I.value.style.display=te.value?"block":"none");const ue=Math.floor(b.value[0]/2),Me=D!=null&&D.value?Y.value?[b.value[0],ue]:[ue-1,0]:b.value;if(I.value.style.zIndex=`${Dl(a.value,g.value,Me)}`,I.value.style.willChange="transform",v.value){const[fe,ge]=[T.width.value/2,T.height.value/2],he=g.value.projectionMatrix.elements[5]*ge,{isOrthographicCamera:ce,top:_e,left:ft,bottom:hn,right:Bt}=g.value,Et=kl(g.value.matrixWorldInverse),dn=ce?`scale(${he})translate(${Vn(-(Bt+ft)/2)}px,${Vn((_e+hn)/2)}px)`:`translateZ(${he}px)`;let Be=a.value.matrixWorld;if(P.value&&(Be=g.value.matrixWorldInverse.clone().transpose().copyPosition(Be).scale(a.value.scale),Be.elements[3]=Be.elements[7]=Be.elements[11]=0,Be.elements[15]=1),I.value.style.width=`${T.width.value}px`,I.value.style.height=`${T.height.value}px`,I.value.style.perspective=ce?"":`${he}px`,(Re=U.value)!=null&&Re.el&&(B=U.value)!=null&&B.children&&Array.isArray(U.value.children)){U.value.el.style.willChange="transform",U.value.el.style.transform=`${dn}${Et}translate(${fe}px,${ge}px)`;const ot=U.value.children[0];ot&&ot.el&&(ot.el.style.willChange="transform",ot.el.style.transform=Nl(Be,1/(((m==null?void 0:m.value)||10)/400)))}}else{const fe=(m==null?void 0:m.value)===void 0?1:Ll(a.value,g.value)*(m==null?void 0:m.value);I.value.style.transform=`translate3d(${k[0]}px,${k[1]}px,0) scale(${fe})`}}G.value=k,V.value=g.value.zoom}if(!Y.value&&l.value&&!q.value)if(v.value){if((p=U.value)!=null&&p.el&&(x=U.value)!=null&&x.children){const k=((S=U.value)==null?void 0:S.children)[0];if(k!=null&&k.clientWidth&&k!=null&&k.clientHeight){const{isOrthographicCamera:z}=g.value;if(z||c)s.scale&&(Array.isArray(s.scale)?s.scale instanceof F?l.value.scale.copy(s.scale.clone().divideScalar(1)):l.value.scale.set(1/s.scale[0],1/s.scale[1],1/s.scale[2]):l.value.scale.setScalar(1/s.scale));else{const W=((m==null?void 0:m.value)||10)/400,oe=k.clientWidth*W,ue=k.clientHeight*W;l.value.scale.set(oe,ue,1)}q.value=!0}}}else{const k=I.value.children[0];if(k!=null&&k.clientWidth&&k!=null&&k.clientHeight){const z=k.clientWidth*1,W=k.clientHeight*1;l.value.scale.set(z,W,1),q.value=!0}Z.value.lookAt((N=g.value)==null?void 0:N.position)}});const O=mt(()=>({vertexShader:v.value?void 0:Il,fragmentShader:Pl})),we=mt(()=>{const le=O.value;return u.value||new ln({vertexShader:le.vertexShader,fragmentShader:le.fragmentShader,side:Mt})});return Xn(()=>{we.value&&we.value.dispose(),I.value.remove()}),e({instance:a}),(le,be)=>(Ie(),Oe("TresGroup",{ref_key:"groupRef",ref:a},[Q(D)&&!Y.value?(Ie(),Oe("TresMesh",{key:0,ref_key:"meshRef",ref:l,geometry:Q(c),material:we.value},null,8,jl)):Kn("",!0)],512))}});export{Xl as D,Gl as J,Fl as O,Vl as Q,Hl as W,zl as Y,Yl as n,Bl as q};
